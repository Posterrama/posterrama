<!doctype html>
<!-- posterrama.app | Author: Posterrama Team | License: GPL-3.0-or-later -->
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Posterrama - Self-Hosted Digital Movie Poster App & Cinema Display</title>
        <meta
            name="description"
            content="Transform your movie collection into stunning digital posters, elegant screensavers, and immersive cinema displays. Self-hosted, open-source, and perfect for home theaters and media rooms."
        />
        <meta
            name="keywords"
            content="movie poster app, digital movie posters, cinema display, screensaver, self-hosted media, home theater, plex companion, media collection, movie library, tv show posters, digital signage, media server, personal cinema, movie collection display, film poster screensaver, home cinema automation, media room display, raspberry pi media, kodi alternative, emby companion, jellyfin integration, movie artwork display, poster slideshow, cinema mode app, home theater software, media center display, digital photo frame movies, auto movie posters"
        />
        <meta name="author" content="Posterrama Team" />
        <meta name="robots" content="index, follow" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

        <!-- PWA Meta Tags -->
        <meta name="theme-color" content="#1a1a1a" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="Posterrama" />
        <meta name="mobile-web-app-capable" content="yes" />
        
        <!-- App Manifest -->
        <link rel="manifest" href="/manifest.json" />
        
        <!-- Favicons and Icons -->
        <link rel="icon" type="image/svg+xml" href="/icons/posterrama-icon.svg?v=2" />
        <link rel="icon" type="image/x-icon" href="/favicon.ico?v=2" />
        <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png?v=2" />
        <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png?v=2" />
        <link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png" />
        <link rel="apple-touch-icon" sizes="128x128" href="/icons/icon-128x128.png" />
        <link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png" />
        <link rel="apple-touch-icon" sizes="152x152" href="/icons/icon-152x152.png" />
        <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png" />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://posterrama.app/" />
        <meta property="og:title" content="Posterrama - Self-Hosted Digital Movie Poster App" />
        <meta
            property="og:description"
            content="Transform your movie collection into stunning digital posters, elegant screensavers, and immersive cinema displays. Self-hosted and open-source."
        />
        <meta property="og:site_name" content="Posterrama" />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:url" content="https://posterrama.app/" />
        <meta
            property="twitter:title"
            content="Posterrama - Self-Hosted Digital Movie Poster App"
        />
        <meta
            property="twitter:description"
            content="Transform your movie collection into stunning digital posters, elegant screensavers, and immersive cinema displays."
        />

        <!-- Canonical URL -->
        <link rel="canonical" href="https://posterrama.app/" />

        <!-- Preconnects for performance -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&family=Kalam:wght@400;700&display=swap"
            rel="stylesheet"
        />

        <!-- Font Awesome for icons -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
            integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />

        <!-- Client-side Logger for controlled debugging -->
        <script src="/client-logger.js"></script>
        
        <!-- Persistent Debug Logger (survives reloads) -->
        <script src="/debug-logger.js"></script>

        <!-- Styles -->
    <link rel="stylesheet" href="style.css?v=20250828a" />
        <link rel="stylesheet" href="/wallart/wallart.css?v={{ASSET_VERSION}}" />

        
        <!-- Structured Data / JSON-LD -->
        <script type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "SoftwareApplication",
                "name": "Posterrama",
                "description": "Self-hosted digital movie poster app that transforms your screens into personal cinemas and elegant screensavers",
                "url": "https://posterrama.app",
                "downloadUrl": "https://github.com/Posterrama/posterrama",
                "operatingSystem": "Linux, Windows, macOS",
                "applicationCategory": "MultimediaApplication",
                "offers": {
                    "@type": "Offer",
                    "price": "0",
                    "priceCurrency": "USD"
                },
                "creator": {
                    "@type": "Organization",
                    "name": "Posterrama Team",
                    "url": "https://github.com/Posterrama"
                },
                "license": "https://www.gnu.org/licenses/gpl-3.0.html",
                "softwareVersion": "1.3.0",
                "requirements": "Docker, Node.js, Media Server (Plex)",
                "featureList": [
                    "Digital Movie Poster Display",
                    "Cinema Mode for Portrait Screens",
                    "Elegant Screensavers",
                    "Self-Hosted Media Management",
                    "Plex Integration",
                    "Multiple Display Support",
                    "Responsive Design"
                ]
            }
        </script>
    </head>
    <body data-mode="wallart" class="wallart-mode">
        <div id="loader">
            <div class="poster-loader"></div>
        </div>
        <div id="error-message" class="is-hidden"></div>

        <!-- Promo Box for the /site page -->
        <main id="promo-box" class="is-hidden" style="display: none">
            <header class="promo-logo">
                <svg
                    role="img"
                    aria-label="Posterrama Digital Movie Poster App Logo"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                >
                    <path d="M6 2H16L14 22H4L6 2Z" />
                    <path d="M10 2H20L18 22H8L10 2Z" style="mix-blend-mode: screen; opacity: 0.6" />
                </svg>
            </header>
            <h1>Bring your media library to life.</h1>
            <p>
                This is <span class="promo-brand-name">Posterrama</span>, a stunning, self-hosted
                digital movie<span class="movie-extensions">+ music & games</span> poster app that
                transforms your screens into personal cinemas and elegant screensavers.
            </p>

            <!-- Hidden SEO content -->
            <div class="seo-content" style="position: absolute; left: -9999px; top: -9999px">
                <h2>Features</h2>
                <ul>
                    <li>Digital movie poster displays for home theaters</li>
                    <li>Cinema mode for portrait orientation screens</li>
                    <li>Beautiful screensavers from your media collection</li>
                    <li>Self-hosted media management</li>
                    <li>Plex media server integration</li>
                    <li>Multi-screen support for digital signage</li>
                    <li>Responsive design for all devices</li>
                    <li>Open source and free to use</li>
                </ul>

                <h2>Perfect for</h2>
                <ul>
                    <li>Home theater enthusiasts</li>
                    <li>Media room displays</li>
                    <li>Digital signage projects</li>
                    <li>Plex server companions</li>
                    <li>Movie collection showcases</li>
                    <li>Personal cinema setups</li>
                </ul>
            </div>

            <section class="promo-cta">
                <a
                    href="https://github.com/Posterrama/posterrama"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="button-promo"
                    aria-label="Download Posterrama from GitHub"
                >
                    <i class="fab fa-github"></i>
                    Get it on GitHub
                </a>
            </section>
        </main>

        <div id="layer-a" class="screensaver-layer"></div>
        <div id="layer-b" class="screensaver-layer"></div>

        <div id="clock-widget-container">
            <div id="time-widget">
                <span id="time-hours">00</span>
                <span id="time-separator">:</span>
                <span id="time-minutes">00</span>
            </div>
        </div>

        <div id="clearlogo-container">
            <img id="clearlogo" src="" alt="ClearLogo" />
        </div>

        <div id="info-container">
            <div id="poster-wrapper">
                <a id="poster-link" href="#" target="_blank" rel="noopener noreferrer">
                    <div id="poster-a" class="poster-layer"></div>
                    <div id="poster-b" class="poster-layer"></div>
                    <!-- Keep original poster for backward compatibility -->
                    <div id="poster"></div>
                </a>
            </div>
            <div id="text-wrapper">
                <h1 id="title"></h1>
                <p id="tagline"></p>
                <div id="meta-info">
                    <span id="year"></span>
                    <span id="rating"></span>
                </div>
            </div>
        </div>

        <div id="controls-container">
            <button id="prev-button" aria-label="Previous">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" />
                </svg>
            </button>
            <button id="pause-button" aria-label="Pause/Resume">
                <svg
                    class="icon-pause"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                >
                    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" />
                </svg>
                <svg
                    class="icon-play"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                >
                    <path d="M8 5v14l11-7z" />
                </svg>
            </button>
            <button id="next-button" aria-label="Next">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M8.59 16.59L10 18l6-6-6-6-1.41 1.41L13.17 12z" />
                </svg>
            </button>
        </div>

        <div id="branding-container">
            <a
                href="https://posterrama.app"
                target="_blank"
                rel="noopener noreferrer"
                title="posterrama.app"
            >
                <svg
                    role="img"
                    aria-label="posterrama.app Logo"
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                >
                    <path d="M6 2H16L14 22H4L6 2Z" />
                    <path d="M10 2H20L18 22H8L10 2Z" style="mix-blend-mode: screen; opacity: 0.6" />
                </svg>
            </a>
        </div>

    <!-- Mode-based redirect: automatically redirect to mode-specific page -->
    <script>
        (async function() {
            window.debugLog && window.debugLog('REDIRECT_SCRIPT_START', { pathname: window.location.pathname });
            
            // Skip redirect if already on a mode-specific page or in preview mode
            // Skip mode checks if running in preview mode (iframe or ?preview=1)
            const params = new URLSearchParams(window.location.search);
            const isPreview = params.get('preview') === '1' || window.self !== window.top || window.IS_PREVIEW;
            
            // Also skip if server hints a specific mode (MODE_HINT)
            if (isPreview || window.MODE_HINT || window.location.pathname.includes('/cinema') || 
                window.location.pathname.includes('/wallart') || 
                window.location.pathname.includes('/screensaver')) {
                window.debugLog && window.debugLog('REDIRECT_SKIP', { reason: 'already on mode page', isPreview, modeHint: window.MODE_HINT });
                window.__wallartModeVerified = true; // Mark as verified to prevent auto-exit poll from reloading
                return;
            }

            try {
                window.debugLog && window.debugLog('REDIRECT_FETCH_CONFIG', {});
                
                // Fetch config to determine which mode is active
                const response = await fetch('/get-config', { cache: 'no-cache' });
                if (!response.ok) {
                    window.debugLog && window.debugLog('REDIRECT_CONFIG_FAIL', { status: response.status });
                    window.__wallartModeVerified = true; // Allow page to continue even if config fails
                    return;
                }

                const config = await response.json();
                window.debugLog && window.debugLog('REDIRECT_CONFIG_LOADED', { 
                    cinemaMode: config.cinemaMode, 
                    wallartEnabled: config.wallartMode?.enabled 
                });

                // Redirect to cinema if cinema mode is enabled
                if (config.cinemaMode === true) {
                    window.debugLog && window.debugLog('REDIRECT_TO_CINEMA', {});
                    console.log('[Posterrama] Cinema mode detected, redirecting to /cinema');
                    if (window.PosterramaCore && window.PosterramaCore.buildUrlForMode) {
                        window.location.replace(window.PosterramaCore.buildUrlForMode('cinema'));
                    } else {
                        var base = (function(p){ p=(p||'/').replace(/\/+/, '/'); p=p.replace(/\/+/g,'/'); if(p.length>1&&p.endsWith('/')) p=p.slice(0,-1); p=p.replace(/[^/]+$/,'/'); return p; })(window.location.pathname);
                        var abs = new URL(base + 'cinema', window.location.origin).toString();
                        window.location.replace(abs);
                    }
                    return;
                }

                // If wallart is enabled, we are already on /wallart; keep initializing.
                if (config.wallartMode && config.wallartMode.enabled === true) {
                    window.debugLog && window.debugLog('REDIRECT_WALLART_VERIFIED', {});
                    console.log('[Posterrama] Wallart mode detected, continue on /wallart');
                    document.body.classList.add('wallart-mode');
                    window.__wallartModeVerified = true; // Mark as verified
                    return;
                }

                // No wallart: auto-exit polling will navigate to cinema/screensaver if needed
                window.debugLog && window.debugLog('REDIRECT_NO_MODE', {});
                window.__wallartModeVerified = true;
            } catch (err) {
                // Failed to check config, continue loading index.html
                window.debugLog && window.debugLog('REDIRECT_ERROR', { error: err.message });
                console.warn('[Posterrama] Failed to check mode config, loading index.html', err);
                window.__wallartModeVerified = true; // Allow page to continue
            }
        })();
    </script>

    <script src="lazy-loading.js?v=20250825a"></script>
    <script src="device-mgmt.js?v=20250901a"></script>
    <script src="/core.js?v={{ASSET_VERSION}}"></script>
    <script src="/wallart/wallart-display.js?v={{ASSET_VERSION}}"></script>
    <script>
        (function () {
            // Minimal, page-local bootstrap to populate media and start wallart without legacy script.js
            async function ensureConfig() {
                window.debugLog && window.debugLog('WALLART_ENSURE_CONFIG_START', {});
                try {
                    if (window.appConfig && window.wallartConfig) {
                        window.debugLog && window.debugLog('WALLART_CONFIG_ALREADY_EXISTS', {});
                        return true;
                    }
                    const useCore = !!(window.PosterramaCore && window.PosterramaCore.fetchConfig);
                    window.debugLog && window.debugLog('WALLART_FETCH_CONFIG', { useCore });
                    const cfg = useCore
                        ? await window.PosterramaCore.fetchConfig()
                        : await (await fetch('/get-config', { cache: 'no-cache', headers: { 'Cache-Control': 'no-cache' } })).json();
                    window.debugLog && window.debugLog('WALLART_CONFIG_FETCHED', { hasConfig: !!cfg });
                    try {
                        if (!Object.getOwnPropertyDescriptor(window, 'appConfig')) {
                            Object.defineProperty(window, 'appConfig', { value: cfg, writable: true });
                        } else {
                            window.appConfig = cfg;
                        }
                        const wcfg = (cfg && cfg.wallartMode) || {};
                        if (!Object.getOwnPropertyDescriptor(window, 'wallartConfig')) {
                            Object.defineProperty(window, 'wallartConfig', { value: wcfg, writable: true });
                        } else {
                            window.wallartConfig = wcfg;
                        }
                    } catch (e) {
                        window.debugLog && window.debugLog('WALLART_CONFIG_DEFINE_ERROR', { error: e.message });
                        window.appConfig = cfg;
                        window.wallartConfig = (cfg && cfg.wallartMode) || {};
                    }
                    window.debugLog && window.debugLog('WALLART_ENSURE_CONFIG_SUCCESS', {});
                    return true;
                } catch (e) {
                    window.debugLog && window.debugLog('WALLART_ENSURE_CONFIG_FAIL', { error: e.message });
                    return false;
                }
            }
            async function ensureMediaQueue() {
                window.debugLog && window.debugLog('WALLART_ENSURE_MEDIA_START', {});
                try {
                    if (Array.isArray(window.mediaQueue) && window.mediaQueue.length > 0) {
                        window.debugLog && window.debugLog('WALLART_MEDIA_ALREADY_EXISTS', { count: window.mediaQueue.length });
                        return true;
                    }
                    const count = Math.max(60, Math.min(400, Math.floor((window.innerWidth * window.innerHeight) / 8000)));
                    const type = (window.appConfig && window.appConfig.type) || 'movies';
                    const url = `/get-media?count=${count}&type=${encodeURIComponent(type)}`;
                    window.debugLog && window.debugLog('WALLART_FETCH_MEDIA', { url });
                    const res = await fetch(url, { cache: 'no-cache', headers: { 'Cache-Control': 'no-cache' } });
                    if (!res.ok) {
                        window.debugLog && window.debugLog('WALLART_MEDIA_FETCH_FAIL', { status: res.status });
                        return false;
                    }
                    const data = await res.json();
                    const items = Array.isArray(data) ? data : Array.isArray(data?.results) ? data.results : [];
                    if (!items.length) {
                        window.debugLog && window.debugLog('WALLART_MEDIA_EMPTY', {});
                        return false;
                    }
                    try {
                        if (!Object.getOwnPropertyDescriptor(window, 'mediaQueue')) {
                            Object.defineProperty(window, 'mediaQueue', { value: items, writable: true });
                        } else {
                            window.mediaQueue = items;
                        }
                    } catch (e) {
                        window.debugLog && window.debugLog('WALLART_MEDIA_DEFINE_ERROR', { error: e.message });
                        window.mediaQueue = items;
                    }
                    window.debugLog && window.debugLog('WALLART_ENSURE_MEDIA_SUCCESS', { count: items.length });
                    return true;
                } catch (e) {
                    window.debugLog && window.debugLog('WALLART_ENSURE_MEDIA_FAIL', { error: e.message });
                    return false;
                }
            }
            async function startWallartOnceReady() {
                window.debugLog && window.debugLog('WALLART_START_ONCE_READY', {});
                try {
                    await ensureConfig();
                    try { window.logger && window.logger.debug && window.logger.debug('[WALLART] bootstrap: config loaded', { hasWallartConfig: !!window.wallartConfig }); } catch(_) {}
                    // Initialize device management to enable heartbeats and live WS logs
                    window.debugLog && window.debugLog('WALLART_INIT_DEVICE_MGMT', {});
                    try {
                        if (window.PosterramaDevice && typeof window.PosterramaDevice.init === 'function') {
                            window.PosterramaDevice.init(window.appConfig || {});
                        }
                    } catch (e) { 
                        window.debugLog && window.debugLog('WALLART_DEVICE_MGMT_ERROR', { error: e.message });
                    }
                    await ensureMediaQueue();
                    try { window.logger && window.logger.debug && window.logger.debug('[WALLART] bootstrap: media ready', { count: (Array.isArray(window.mediaQueue) && window.mediaQueue.length) || 0 }); } catch(_) {}
                    window.debugLog && window.debugLog('WALLART_START_MODULE', { hasModule: !!(window.PosterramaWallart && typeof window.PosterramaWallart.start === 'function') });
                    if (window.PosterramaWallart && typeof window.PosterramaWallart.start === 'function') {
                        window.PosterramaWallart.start(window.wallartConfig || {});
                        try { window.logger && window.logger.debug && window.logger.debug('[WALLART] module start invoked'); } catch(_) {}
                        try { const loader = document.getElementById('loader'); if (loader) { loader.style.opacity='0'; loader.style.display='none'; } } catch(_) {}
                    }
                    window.debugLog && window.debugLog('WALLART_BOOTSTRAP_COMPLETE', {});
                } catch (e) {
                    window.debugLog && window.debugLog('WALLART_START_ERROR', { error: e.message, stack: e.stack });
                }
            }
            // Kick on DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', startWallartOnceReady);
            } else {
                startWallartOnceReady();
            }
        })();
    </script>
    <script>
        // If server indicated a mode, apply it immediately to avoid race conditions
        document.addEventListener('DOMContentLoaded', () => {
            window.debugLog && window.debugLog('DOM_READY', { verified: window.__wallartModeVerified });
            
            if (window.MODE_HINT === 'wallart') {
                document.body.classList.add('wallart-mode');
            } else if (window.MODE_HINT === 'screensaver') {
                document.body.classList.remove('wallart-mode');
            }
            // Wait for inline redirect script to verify wallart mode before starting auto-exit poll
            // This prevents reload loops on initial page load
            const startPoll = () => {
                window.debugLog && window.debugLog('AUTO_EXIT_POLL_START', {});
                try { 
                    window.PosterramaCore && window.PosterramaCore.startAutoExitPoll({ currentMode: 'wallart', intervalMs: 15000 }); 
                } catch (e) {
                    window.debugLog && window.debugLog('AUTO_EXIT_POLL_ERROR', { error: e.message });
                }
            };
            if (window.__wallartModeVerified) {
                // Already verified, safe to start poll after a delay
                window.debugLog && window.debugLog('POLL_DELAY_VERIFIED', { delayMs: 3000 });
                setTimeout(startPoll, 3000);
            } else {
                // Wait for verification flag
                window.debugLog && window.debugLog('POLL_WAIT_VERIFY', {});
                const checkInterval = setInterval(() => {
                    if (window.__wallartModeVerified) {
                        window.debugLog && window.debugLog('POLL_VERIFIED_VIA_INTERVAL', {});
                        clearInterval(checkInterval);
                        setTimeout(startPoll, 3000);
                    }
                }, 100);
                // Failsafe: start anyway after 5 seconds
                setTimeout(() => {
                    clearInterval(checkInterval);
                    if (!window.__wallartModeVerified) {
                        window.debugLog && window.debugLog('POLL_FAILSAFE_TRIGGER', {});
                        window.__wallartModeVerified = true;
                        startPoll();
                    }
                }, 5000);
            }
        });
    </script>
    <script>
        // Optional: show unobtrusive hint in console for enabling debug logs
        try {
            if (!(window.logger && window.logger.isDebug && window.logger.isDebug())) {
                console.warn('[Posterrama] To enable debug logs, add ?debug=true to the URL or run window.enableDebug()');
            }
        } catch(e) {}
    </script>
        
        <!-- PWA Service Worker Registration -->
        <script>
            if ('serviceWorker' in navigator) {
                window.addEventListener('load', () => {
                    navigator.serviceWorker
                        .register('/sw.js')
                        .catch(() => {
                            /* silent */
                        });
                });
            }
        </script>
    </body>
</html>
