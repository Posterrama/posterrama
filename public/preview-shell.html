<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Posterrama â€“ Live Preview Shell</title>
    <meta name="robots" content="noindex,nofollow" />
    <style>
      :root {
        --pv-bg: #1a1d29;
        --pv-surface: #232937;
        --pv-surface-2: #2a3142;
        --pv-border: #3a4553;
        --pv-text: #ffffff;
        --pv-text-secondary: #b8bcc8;
        --pv-primary: #00d4aa;
      }
      html, body { height: 100%; }
      body { margin: 0; background: #0f1117; color: var(--pv-text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

      .pv-container { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; }
      .pv-shell {
        position: relative;
        width: 100vw;
        height: 100vh;
        background: #000;
        overflow: hidden;
        transition: width .2s ease, height .2s ease, border-radius .2s ease, box-shadow .2s ease, transform .2s ease;
      }
      .pv-shell.pip {
        width: min(960px, 88vw);
        height: calc(min(960px, 88vw) * 9 / 16);
        border: 1px solid var(--pv-border);
        border-radius: 12px;
        background: linear-gradient(135deg, var(--pv-surface), var(--pv-surface-2));
        box-shadow: 0 20px 40px rgba(0,0,0,.6);
      }
      .pv-toolbar {
        position: absolute;
        top: 8px; left: 8px; right: 8px; height: 40px;
        display: flex; align-items: center; gap: 8px;
        background: rgba(26, 29, 41, 0.6);
        border: 1px solid var(--pv-border);
        border-radius: 10px;
        padding: 6px 8px;
        color: var(--pv-text);
        backdrop-filter: blur(6px);
        -webkit-user-select: none; user-select: none;
        cursor: move; /* drag handle when pip/collapsed */
        z-index: 10;
      }
      .pv-title { font-size: 14px; color: var(--pv-text-secondary); margin-right: 6px; }
      .pv-spacer { flex: 1; }
      .pv-btn {
        appearance: none; border: 1px solid var(--pv-border); background: var(--pv-surface);
        color: var(--pv-text); border-radius: 8px; padding: 6px 10px; font-size: 13px; cursor: pointer;
      }
      .pv-btn:hover { background: var(--pv-surface-2); }
      .pv-btn.active { border-color: var(--pv-primary); box-shadow: 0 0 0 2px rgba(0,212,170,0.2) inset; }
      .pv-zoom { display: inline-flex; border: 1px solid var(--pv-border); border-radius: 8px; overflow: hidden; }
      .pv-zoom .pv-btn { border: 0; border-right: 1px solid var(--pv-border); border-radius: 0; }
      .pv-zoom .pv-btn:last-child { border-right: 0; }

      .pv-frame { position: absolute; inset: 0; overflow: hidden; }
      .pv-viewport { width: 100%; height: 100%; transform-origin: top left; }
      .pv-iframe { width: 100%; height: 100%; border: 0; display: block; }

      .pv-shell.collapsed { height: 52px; min-width: 260px; }
      .pv-shell.collapsed .pv-frame { display: none; }
      .pv-shell.collapsed .pv-toolbar { cursor: grab; }

      @media (max-width: 640px) {
        .pv-toolbar { top: 6px; left: 6px; right: 6px; height: 38px; }
        .pv-btn { padding: 6px 8px; font-size: 12px; }
      }
    </style>
  </head>
  <body>
    <div class="pv-container">
      <div id="pv-shell" class="pv-shell">
        <div class="pv-toolbar" id="pv-toolbar">
          <span class="pv-title">Live Preview</span>
          <button class="pv-btn" id="pv-pip">PiP Mode</button>
          <div class="pv-zoom" role="group" aria-label="Zoom controls">
            <button class="pv-btn" data-zoom="1">1x</button>
            <button class="pv-btn" data-zoom="2">2x</button>
          </div>
          <div class="pv-spacer"></div>
          <button class="pv-btn" id="pv-collapse">Collapse</button>
        </div>
        <div class="pv-frame">
          <div id="pv-viewport" class="pv-viewport">
            <iframe id="pv-iframe" class="pv-iframe" src="/preview.html" title="Preview"></iframe>
          </div>
        </div>
      </div>
    </div>

    <script>
      (function(){
        const shell = document.getElementById('pv-shell');
        const toolbar = document.getElementById('pv-toolbar');
        const btnPiP = document.getElementById('pv-pip');
        const btnCollapse = document.getElementById('pv-collapse');
        const zoomBtns = document.querySelectorAll('[data-zoom]');
        const viewport = document.getElementById('pv-viewport');

        // Zoom
        let zoom = 1;
        function applyZoom(){ viewport.style.transform = `scale(${zoom})`; }
        zoomBtns.forEach(b => b.addEventListener('click', () => {
          zoom = Number(b.getAttribute('data-zoom')) || 1;
          zoomBtns.forEach(x => x.classList.toggle('active', x === b));
          applyZoom();
        }));
        zoomBtns.forEach(x => x.classList.toggle('active', x.getAttribute('data-zoom') === '1'));
        applyZoom();

        // PiP toggle
        let pip = false;
        btnPiP.addEventListener('click', () => {
          pip = !pip;
          shell.classList.toggle('pip', pip);
          btnPiP.classList.toggle('active', pip);
        });

        // Collapse/expand
        let collapsed = false;
        btnCollapse.addEventListener('click', () => {
          collapsed = !collapsed;
          shell.classList.toggle('collapsed', collapsed);
          btnCollapse.textContent = collapsed ? 'Expand' : 'Collapse';
        });

        // Dragging (PiP or collapsed)
        let dragging = false, dx = 0, dy = 0;
        function onDown(e){
          if (!(pip || collapsed)) return;
          dragging = true;
          const r = shell.getBoundingClientRect();
          dx = (e.clientX||0) - r.left; dy = (e.clientY||0) - r.top;
          document.addEventListener('mousemove', onMove);
          document.addEventListener('mouseup', onUp);
        }
        function onMove(e){
          if (!dragging) return;
          const vw = window.innerWidth, vh = window.innerHeight;
          const r = shell.getBoundingClientRect();
          const w = r.width, h = r.height;
          let x = (e.clientX||0) - dx; let y = (e.clientY||0) - dy;
          x = Math.max(8, Math.min(vw - w - 8, x));
          y = Math.max(8, Math.min(vh - h - 8, y));
          shell.style.position = 'fixed';
          shell.style.left = x + 'px'; shell.style.top = y + 'px';
          shell.style.right = 'auto'; shell.style.bottom = 'auto';
        }
        function onUp(){ dragging = false; document.removeEventListener('mousemove', onMove); document.removeEventListener('mouseup', onUp); }
        toolbar.addEventListener('mousedown', onDown);
      })();
    </script>
  </body>
</html>
