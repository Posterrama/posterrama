<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
        <title>Posterrama Cinema</title>

        <!-- Fonts -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Playfair+Display:wght@400;500;600;700&family=Montserrat:wght@400;500;600;700&family=Cormorant+Garamond:wght@400;600;700&family=Space+Grotesk:wght@400;500;600;700&family=Oswald:wght@400;500;600;700&family=Cinzel:wght@400;500;600;700&family=Lilita+One&display=swap"
            rel="stylesheet"
        />
        
        <!-- Tabler Icons (webfont) -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons-webfont@latest/tabler-icons.min.css" />
        
        <!-- Material Symbols -->
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" />
        
        <!-- Preconnect to media server for faster poster loading -->
        <link rel="dns-prefetch" href="/image" />
        <link rel="preconnect" href="/image" crossorigin />

        <!-- Cinema styles (ONLY) -->
        <link rel="stylesheet" href="cinema/cinema-display.css?v={{ASSET_VERSION}}" />

        <!-- Client-side Logger -->
        <script src="/client-logger.js"></script>
        
        <!-- Global Error Handler -->
        <script type="module" src="/error-handler.js"></script>
    </head>
    <body data-mode="cinema">
        <!-- Mode-based redirect: automatically redirect to mode-specific page -->
                <script type="module">
            import { checkModeRedirect, loadPromoOverlayIfEnabled, startPeriodicModeCheck } from './mode-redirect.js';
            
            await checkModeRedirect('cinema', '__cinemaModeVerified');
            window.MODE_HINT = 'cinema';
            startPeriodicModeCheck('cinema');
            await loadPromoOverlayIfEnabled();
        </script>
        <!-- Error message -->
        <div id="error-message" class="is-hidden"></div>

        <!-- Cinema poster and metadata container -->
        <div id="info-container">
            <div id="poster-wrapper">
                <div id="poster"></div>
            </div>
        </div>

        <!-- No on-screen controls in cinema mode -->

        <!-- Scripts -->
    <script defer src="device-mgmt.js?v=20250901a"></script>
    <script defer src="/core.js?v={{ASSET_VERSION}}"></script>
        <script defer src="cinema/cinema-display.js?v={{ASSET_VERSION}}"></script>
        <script defer src="/cinema/cinema-bootstrap.js?v={{ASSET_VERSION}}"></script>
        
        <!-- Mode initialization -->
        <script type="module">
            import { initDevice, startAutoExitPoll } from './display-mode-init.js';
            import { loadPromoOverlayIfEnabled } from './mode-redirect.js';
            
            // Initialize device management (non-blocking)
            initDevice();
            
            // Start auto-exit polling
            startAutoExitPoll('cinema', 15000);
            
            // Load promo overlay if enabled
            await loadPromoOverlayIfEnabled();
        </script>
    </body>
</html>
