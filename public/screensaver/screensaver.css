/* Screensaver CSS */
/* Keeps screensaver-only behaviors isolated from shared style.css */

/*
  Transition system
  - JS drives the CSS variables below.
  - This allows “whole scene” transitions (background + foreground + widgets)
	while preserving per-element scale transforms.
*/

body[data-mode='screensaver'] {
    --ss-scene-x: 0px;
    --ss-scene-opacity: 1;
    --ss-scene-ms: 900ms;
    --ss-scene-ease: cubic-bezier(0.16, 1, 0.3, 1);

    /* Classic Ken Burns (background only) driven by JS */
    --ss-kb-from-x: 0vw;
    --ss-kb-from-y: 0vh;
    --ss-kb-to-x: 0vw;
    --ss-kb-to-y: 0vh;
    --ss-kb-from-scale: 1.06;
    --ss-kb-to-scale: 1.14;

    /* Poster effects (poster-only) */
    --ss-poster-ms: 10000ms;
}

/* Poster effects helpers */
body[data-mode='screensaver'] #poster {
    transform-origin: 50% 60%;
    transform-style: preserve-3d;
    will-change: transform, filter, box-shadow, opacity;
}

@keyframes ss-poster-analogzoom {
    from {
        transform: scale(1.02);
    }
    to {
        transform: scale(1.06);
    }
}

@keyframes ss-poster-tilt {
    0% {
        transform: translate3d(0, 0, 0) rotateX(1.2deg) rotateY(-1.6deg) scale(1.01);
        box-shadow: -10px 18px 34px rgba(0, 0, 0, 0.58);
    }
    50% {
        transform: translate3d(0, 0, 0) rotateX(-1deg) rotateY(1.3deg) scale(1.015);
        box-shadow: -6px 22px 38px rgba(0, 0, 0, 0.62);
    }
    100% {
        transform: translate3d(0, 0, 0) rotateX(1.2deg) rotateY(-1.6deg) scale(1.01);
        box-shadow: -10px 18px 34px rgba(0, 0, 0, 0.58);
    }
}

@keyframes ss-poster-focuspull {
    from {
        opacity: 0.75;
        filter: blur(12px) brightness(0.96) saturate(1.05);
        transform: scale(1.03);
    }
    to {
        opacity: 1;
        filter: blur(0px) brightness(1) saturate(1);
        transform: scale(1);
    }
}

@keyframes ss-poster-sweep {
    0% {
        transform: translateX(-140%);
        opacity: 0;
    }
    18% {
        opacity: 0.55;
    }
    82% {
        opacity: 0.35;
    }
    100% {
        transform: translateX(140%);
        opacity: 0;
    }
}

body[data-mode='screensaver'] #poster.ss-poster-analogzoom {
    animation: ss-poster-analogzoom var(--ss-poster-ms) cubic-bezier(0.2, 0.9, 0.2, 1) forwards;
}

body[data-mode='screensaver'] #poster.ss-poster-tilt {
    animation: ss-poster-tilt var(--ss-poster-ms) ease-in-out infinite;
}

body[data-mode='screensaver'] #poster.ss-poster-focus {
    animation: ss-poster-focuspull 850ms ease-out both;
}

/* Light sweep overlay */
body[data-mode='screensaver'] #poster::after {
    content: '';
    position: absolute;
    top: -20%;
    bottom: -20%;
    left: -40%;
    right: -40%;
    background: linear-gradient(
        120deg,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 0.18) 45%,
        rgba(255, 255, 255, 0.25) 50%,
        rgba(255, 255, 255, 0.18) 55%,
        rgba(255, 255, 255, 0) 100%
    );
    transform: translateX(-140%);
    opacity: 0;
    pointer-events: none;
    border-radius: inherit;
}

body[data-mode='screensaver'] #poster.ss-poster-sweep::after {
    animation: ss-poster-sweep 1400ms ease-in-out both;
}

@media (prefers-reduced-motion: reduce) {
    body[data-mode='screensaver'] #poster.ss-poster-analogzoom,
    body[data-mode='screensaver'] #poster.ss-poster-tilt,
    body[data-mode='screensaver'] #poster.ss-poster-focus,
    body[data-mode='screensaver'] #poster.ss-poster-sweep::after {
        animation: none !important;
    }
}

@keyframes ss-kenburns {
    from {
        transform: translate3d(var(--ss-kb-from-x), var(--ss-kb-from-y), 0)
            scale(var(--ss-kb-from-scale));
    }
    to {
        transform: translate3d(var(--ss-kb-to-x), var(--ss-kb-to-y), 0) scale(var(--ss-kb-to-scale));
    }
}

/* Foreground scene elements */
body[data-mode='screensaver'] #info-container,
body[data-mode='screensaver'] #controls-container {
    transition:
        opacity var(--ss-scene-ms) var(--ss-scene-ease),
        transform var(--ss-scene-ms) var(--ss-scene-ease);
    will-change: transform, opacity;
}

/* Preserve the “slide-up on first show” feel while enabling X transitions */
body[data-mode='screensaver'] #info-container {
    opacity: var(--ss-scene-opacity);
    transform: translate3d(var(--ss-scene-x), 20px, 0);
}
body[data-mode='screensaver'] #info-container.visible {
    opacity: var(--ss-scene-opacity);
    transform: translate3d(var(--ss-scene-x), 0, 0);
}

/* Widgets have their own scale transforms in style.css — preserve those */
body[data-mode='screensaver'] #clock-widget-container {
    transition:
        opacity var(--ss-scene-ms) var(--ss-scene-ease),
        transform var(--ss-scene-ms) var(--ss-scene-ease);
    will-change: transform, opacity;
    opacity: var(--ss-scene-opacity);
    transform: translate3d(var(--ss-scene-x), 0, 0) scale(var(--clock-scale));
}

body[data-mode='screensaver'] #clearlogo-container {
    transition:
        opacity var(--ss-scene-ms) var(--ss-scene-ease),
        transform var(--ss-scene-ms) var(--ss-scene-ease);
    will-change: transform, opacity;
    opacity: var(--ss-scene-opacity);
    transform: translate3d(var(--ss-scene-x), 0, 0) scale(var(--clearlogo-scale));
}

body[data-mode='screensaver'] #controls-container {
    opacity: var(--ss-scene-opacity);
    transform: translate3d(var(--ss-scene-x), 0, 0);
}

/* Background layers: JS sets opacity/transform/animation directly, but keep them performant */
body[data-mode='screensaver'] .screensaver-layer {
    will-change: transform, opacity;
    backface-visibility: hidden;
    transform: translate3d(0, 0, 0);
}
