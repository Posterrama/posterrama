<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Admin Posterrama - Configure your media screensaver settings, manage Plex integration, and customize display options.">
    <meta name="author" content="Admin Posterrama">
    <meta name="robots" content="noindex, nofollow">
    <meta name="theme-color" content="#0a0a0a">
    <meta name="color-scheme" content="dark">
    <title>Admin Posterrama</title>
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="Admin Posterrama">
    <meta property="og:description" content="Configure your media screensaver settings, manage Plex integration, and customize display options.">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Admin Posterrama">
    
    <!-- Twitter Card meta tags -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Admin Posterrama">
    <meta name="twitter:description" content="Configure your media screensaver settings and Plex integration.">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="/admin.html">
    
    <!-- DNS prefetch for external resources -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    
    <!-- Optimized font loading with font-display swap -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    
    <!-- Local CSS with versioning -->
    <link rel="stylesheet" href="/admin.css?v=20250819a&cb=1755384925&mobilefinal=1">
    
    <!-- Font Awesome with SRI for security -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Client-side Logger for controlled debugging -->
    <script src="/client-logger.js"></script>
    <script src="/lazy-loading.js?v=20250825a"></script>
    
    <!-- Preload critical JavaScript -->
    <link rel="preload" href="/admin.js?v=20250823a&cb=1755384925&mobilefinal=1" as="script">
    
    <!-- IMMEDIATE desktop sidebar fix - disable toggle functionality on desktop -->
    <script>
        (function() {
            function isMobile() {
                return window.innerWidth <= 768;
            }
            
            function removeDesktopToggles() {
                if (isMobile()) {
                    // On mobile: Hide entire sidebar
                    const sidebar = document.getElementById('sidebar');
                    if (sidebar) {
                        sidebar.style.display = 'none';
                    }
                    
                    // Hide sidebar overlay
                    const overlay = document.getElementById('sidebar-overlay');
                    if (overlay) {
                        overlay.style.display = 'none';
                    }
                    
                    // Adjust main content to full width
                    const mainContent = document.querySelector('.admin-main');
                    if (mainContent) {
                        mainContent.style.marginLeft = '0';
                        mainContent.style.width = '100%';
                    }
                    
                    // Adjust header to full width
                    const header = document.querySelector('.admin-header');
                    if (header) {
                        header.style.left = '0';
                        header.style.width = '100%';
                    }
                } else {
                    // On desktop: Disable toggle functionality
                    const sidebar = document.getElementById('sidebar');
                    if (sidebar && !sidebar.classList.contains('sidebar-always-open')) {
                        sidebar.classList.add('sidebar-always-open');
                    }
                    
                    // Disable any toggle buttons
                    const toggleButtons = document.querySelectorAll('.sidebar-toggle');
                    toggleButtons.forEach(button => {
                        button.disabled = true;
                        button.style.display = 'none';
                    });
                }
            }
            
            // Execute immediately
            removeDesktopToggles();
            
            // Execute on DOM ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', removeDesktopToggles);
            } else {
                removeDesktopToggles();
            }
            
            // Execute on window resize
            window.addEventListener('resize', removeDesktopToggles);
        })();
    </script>
</head>
<body>
    
    <div class="admin-layout">
        <!-- Header -->
        <header class="admin-header" role="banner">
            <!-- Mobile menu button - only visible on mobile -->
            <button type="button" id="mobile-nav-toggle" class="mobile-nav-btn mobile-only">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                    <path d="M6 2H16L14 22H4L6 2Z"/>
                    <path d="M10 2H20L18 22H8L10 2Z" style="mix-blend-mode: screen; opacity: 0.6;"/>
                </svg>
            </button>
            
            <h1 class="logo-text"><span class="gradient-text">Posterrama</span></h1>
            <nav role="navigation" class="header-nav">
                <!-- Restart Now button - only shown when restart is needed -->
                <button type="button" id="restart-now-btn" class="btn btn-warning" style="display: none;">
                    <i class="fas fa-sync-alt"></i>
                    Restart Now
                </button>
                <button type="button" id="toggle-help-panel" class="btn btn-secondary">
                    <i class="fas fa-question-circle"></i>
                    Help
                </button>
                <a href="/" target="_blank" class="btn btn-secondary" id="view-posterrama-btn">
                    <i class="fas fa-external-link-alt"></i>
                    View <span class="gradient-text">posterrama</span>
                </a>
                <a href="/api-docs" target="_blank" class="btn btn-secondary" id="api-docs-btn">
                    <i class="fas fa-book"></i>
                    API Docs
                </a>
                
                <a href="/admin/logout" class="btn btn-danger" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </a>
            </nav>
        </header>

        <!-- Sidebar Navigation -->
        <nav class="sidebar sidebar-always-open" id="sidebar" role="navigation">
            <!-- Desktop sidebar header - Fixed open -->
            <div class="sidebar-header desktop-only">
                <div class="sidebar-logo">
                    <span class="logo-text"><span class="admin-text">Admin</span></span>
                </div>
            </div>
            
            <div class="sidebar-nav" role="tablist">
                <button class="nav-item active" data-section="display" title="Display Settings" role="tab" id="display-tab">
                    <i class="fas fa-tv nav-icon"></i>
                    <span class="nav-text">Display</span>
                </button>
                
                                <button class="nav-item" data-section="media" title="Content Sources" role="tab" id="media-tab">
                    <i class="fas fa-database nav-icon"></i>
                    <span class="nav-text">Sources</span>
                </button>
                
                <button class="nav-item" data-section="authentication" title="Authentication & Security" role="tab" id="authentication-tab">
                    <i class="fas fa-shield-alt nav-icon"></i>
                    <span class="nav-text">Security</span>
                </button>
                
                
                
                <button class="nav-item" data-section="management" title="Management & Tools" role="tab" id="management-tab">
                    <i class="fas fa-tools nav-icon"></i>
                    <span class="nav-text">Management</span>
                </button>
            </div>
        </nav>

        <!-- Sidebar overlay for mobile -->
        <div class="sidebar-overlay" id="sidebar-overlay"></div>

        <!-- Main Content Area -->
        <div class="main-content">
            <div id="admin-background-a" class="admin-background-layer"></div>
            <div id="admin-background-b" class="admin-background-layer"></div>
            <div class="admin-background-overlay"></div>

            <main class="admin-main" role="main" id="main-content" tabindex="-1">
                <div id="notification-area" class="notification-container" role="region"></div>

                <form id="config-form" role="form" novalidate>
                    <!-- Display Settings Section -->
                    <section class="section-content active" id="display-section" role="tabpanel">
                        <div class="section-main-content">
                            <div class="section-title">
                                <i class="fas fa-tv"></i>
                                Display Settings
                            </div>
                            
                            <!-- Unified Display Settings Container -->
                            <div class="form-section unified-section">
                                
                                <!-- Wallart Mode Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-images"></i>
                                    Wallart Mode
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="wallartModeEnabled" name="wallartMode.enabled">
                                        <label for="wallartModeEnabled">Enable Wallart Mode</label>
                                    </div>
                                    <div class="wallart-settings-group hidden" id="wallartSettingsGroup">
                                        <div class="form-group">
                                            <label for="wallartLayoutVariant">Layout variant</label>
                                            <select id="wallartLayoutVariant" name="wallartMode.layoutVariant">
                                                <option value="classic" selected>Classic Grid</option>
                                                <option value="heroGrid">Hero + Grid</option>
                                                
                                            </select>
                                        </div>
                                        <div class="form-group" id="layoutSettings-heroGrid" style="display:none">
                                            <label>Hero settings</label>
                                            <div class="form-grid-2">
                                                <div>
                                                    <label for="heroSide">Hero side</label>
                                                    <select id="heroSide" name="wallartMode.layoutSettings.heroGrid.heroSide">
                                                        <option value="left" selected>Left</option>
                                                        <option value="right">Right</option>
                                                    </select>
                                                </div>
                                                <div>
                                                    <label for="heroRotationMinutes">Hero rotation (minutes)</label>
                                                    <input type="number" id="heroRotationMinutes" name="wallartMode.layoutSettings.heroGrid.heroRotationMinutes" min="1" max="60" value="10">
                                                </div>
                                            </div>
                                            
                                        </div>
                                        <div class="form-group">
                                            <label for="wallartDensity">Poster Density</label>
                                            <select id="wallartDensity" name="wallartMode.density">
                                                <option value="low">Few - 60% of screen-optimal (larger posters)</option>
                                                <option value="medium" selected>Medium - 100% screen-optimal (balanced)</option>
                                                <option value="high">Many - 150% of screen-optimal (smaller posters)</option>
                                                <option value="ludicrous">Ludicrous - 200% of screen-optimal (tiny posters)</option>
                                            </select>
                                        </div>
                                        
                                        <!-- Wallart-specific controls that should only show when enabled -->
                                        <div class="wallart-controls-group" id="wallartControlsGroup">
                                            <div class="form-group">
                                                <label for="wallartRefreshRate">Poster Refresh Rate</label>
                                                <div class="slider-wrapper modern-slider">
                                                    <input type="range" id="wallartRefreshRate" name="wallartMode.refreshRate" min="1" max="10" value="5" step="1">
                                                    <div class="slider-percentage" data-target="wallartRefreshRate">Medium refresh rate</div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="wallartRandomness">Timing Randomness</label>
                                                <div class="slider-wrapper modern-slider">
                                                    <input type="range" id="wallartRandomness" name="wallartMode.randomness" min="0" max="10" value="3" step="1">
                                                    <div class="slider-percentage" data-target="wallartRandomness">Low randomness</div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="wallartAnimationType">Animation Type</label>
                                                <select id="wallartAnimationType" name="wallartMode.animationType">
                                                    <option value="random">Random - Uses all animation types</option>
                                                    <option value="fade" selected>Fade - Smooth opacity transition</option>
                                                    <option value="slideLeft">Slide Left - Poster slides from right</option>
                                                    <option value="slideUp">Slide Up - Poster slides from bottom</option>
                                                    <option value="zoom">Zoom - Scale in effect</option>
                                                    <option value="flip">Flip - 3D flip effect</option>
                                                    <option value="staggered">Staggered Reveal - Rows/columns staggered in</option>
                                                    <option value="ripple">Ripple - Wave reveal from center</option>
                                                    <option value="scanline">Scanline Sweep - Horizontal sweep with soft blur-in</option>
                                                    <option value="parallax">Parallax Drift - Subtle 3D offset depth</option>
                                                    <option value="neonPulse">Neon Pulse - Soft outer glow on change</option>
                                                    <option value="chromaticShift">Chromatic Shift - RGB split that converges</option>
                                                    <option value="mosaicShatter">Mosaic Shatter - Tiles assemble into the new poster</option>
                                                </select>
                                            </div>
                                            <div class="form-group checkbox-group">
                                                <input type="checkbox" id="wallartAmbientGradient" name="wallartMode.ambientGradient">
                                                <label for="wallartAmbientGradient">Ambient gradient background</label>
                                            </div>
                                        </div>
                                        
                                        <div class="form-group checkbox-group">
                                            <!-- Spotlight option removed -->
                                        </div>
                                        <div class="form-group checkbox-group">
                                            <!-- Auto-refresh removed: always enabled -->
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Cinema Mode Subsection -->
                                <div class="subsection-header" id="cinemaModeHeader">
                                    <i class="fas fa-film"></i>
                                    Cinema Mode
                                </div>
                                <div class="subsection-content" id="cinemaModeContent">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="cinemaMode" name="cinemaMode">
                                        <label for="cinemaMode">Enable Cinema Mode</label>
                                    </div>
                                    <div class="form-group cinema-orientation-group hidden" id="cinemaOrientationGroup">
                                        <label for="cinemaOrientation">Cinema Display Orientation</label>
                                        <select id="cinemaOrientation" name="cinemaOrientation">
                                            <option value="auto">Auto (use device sensor)</option>
                                            <option value="portrait">Portrait</option>
                                            <option value="portrait-flipped">Portrait Flipped (180Â°)</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- Visual Elements Subsection -->
                                <div class="subsection-header" id="visualElementsHeader">
                                    <i class="fas fa-eye"></i>
                                    Visual Elements
                                </div>
                                <div class="subsection-content" id="visualElementsContent">
                                    <div class="form-grid-2">
                                        <div class="form-group checkbox-group">
                                            <input type="checkbox" id="showClearLogo" name="showClearLogo">
                                            <label for="showClearLogo">Show ClearLogo</label>
                                        </div>
                                        <div class="form-group checkbox-group">
                                            <input type="checkbox" id="showRottenTomatoes" name="showRottenTomatoes">
                                            <label for="showRottenTomatoes">Show Rotten Tomatoes Badge</label>
                                        </div>
                                        <div class="form-group checkbox-group">
                                            <input type="checkbox" id="showPoster" name="showPoster">
                                            <label for="showPoster">Show Poster</label>
                                        </div>
                                        <div class="form-group checkbox-group">
                                            <input type="checkbox" id="showMetadata" name="showMetadata">
                                            <label for="showMetadata">Show Metadata</label>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="rottenTomatoesMinimumScore">Minimum Rotten Tomatoes Score (0-10)</label>
                                        <input type="number" id="rottenTomatoesMinimumScore" name="rottenTomatoesMinimumScore" min="0" max="10" step="0.1">
                                    </div>
                                    
                                    <!-- Clock Widget Options -->
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="clockWidget" name="clockWidget">
                                        <label for="clockWidget">Show Clock (screensaver mode only)</label>
                                    </div>
                                    <div class="form-group clock-timezone-group hidden" id="clockTimezoneGroup">
                                        <label for="clockTimezone">Clock Timezone</label>
                                        <select id="clockTimezone" name="clockTimezone">
                                            <option value="auto">Auto (System Timezone)</option>
                                            <optgroup label="Common Timezones">
                                                <option value="Europe/Amsterdam">Europe/Amsterdam (CET/CEST)</option>
                                                <option value="Europe/London">Europe/London (GMT/BST)</option>
                                                <option value="Europe/Berlin">Europe/Berlin (CET/CEST)</option>
                                                <option value="Europe/Paris">Europe/Paris (CET/CEST)</option>
                                                <option value="America/New_York">America/New_York (EST/EDT)</option>
                                                <option value="America/Chicago">America/Chicago (CST/CDT)</option>
                                                <option value="America/Denver">America/Denver (MST/MDT)</option>
                                                <option value="America/Los_Angeles">America/Los_Angeles (PST/PDT)</option>
                                                <option value="Asia/Tokyo">Asia/Tokyo (JST)</option>
                                                <option value="Asia/Shanghai">Asia/Shanghai (CST)</option>
                                                <option value="Australia/Sydney">Australia/Sydney (AEST/AEDT)</option>
                                            </optgroup>
                                            <optgroup label="Additional Timezones">
                                                <option value="UTC">UTC (Coordinated Universal Time)</option>
                                                <option value="Africa/Cairo">Africa/Cairo (EET)</option>
                                                <option value="Africa/Johannesburg">Africa/Johannesburg (SAST)</option>
                                                <option value="America/Argentina/Buenos_Aires">America/Argentina/Buenos_Aires (ART)</option>
                                                <option value="America/Mexico_City">America/Mexico_City (CST/CDT)</option>
                                                <option value="America/Sao_Paulo">America/Sao_Paulo (BRT/BRST)</option>
                                                <option value="America/Toronto">America/Toronto (EST/EDT)</option>
                                                <option value="America/Vancouver">America/Vancouver (PST/PDT)</option>
                                                <option value="Asia/Bangkok">Asia/Bangkok (ICT)</option>
                                                <option value="Asia/Dubai">Asia/Dubai (GST)</option>
                                                <option value="Asia/Hong_Kong">Asia/Hong_Kong (HKT)</option>
                                                <option value="Asia/Jakarta">Asia/Jakarta (WIB)</option>
                                                <option value="Asia/Kolkata">Asia/Kolkata (IST)</option>
                                                <option value="Asia/Seoul">Asia/Seoul (KST)</option>
                                                <option value="Asia/Singapore">Asia/Singapore (SGT)</option>
                                                <option value="Asia/Taipei">Asia/Taipei (CST)</option>
                                                <option value="Australia/Brisbane">Australia/Brisbane (AEST)</option>
                                                <option value="Australia/Melbourne">Australia/Melbourne (AEST/AEDT)</option>
                                                <option value="Australia/Perth">Australia/Perth (AWST)</option>
                                                <option value="Europe/Athens">Europe/Athens (EET/EEST)</option>
                                                <option value="Europe/Istanbul">Europe/Istanbul (TRT)</option>
                                                <option value="Europe/Moscow">Europe/Moscow (MSK)</option>
                                                <option value="Europe/Rome">Europe/Rome (CET/CEST)</option>
                                                <option value="Europe/Stockholm">Europe/Stockholm (CET/CEST)</option>
                                                <option value="Europe/Zurich">Europe/Zurich (CET/CEST)</option>
                                                <option value="Pacific/Auckland">Pacific/Auckland (NZST/NZDT)</option>
                                                <option value="Pacific/Honolulu">Pacific/Honolulu (HST)</option>
                                            </optgroup>
                                        </select>
                                    </div>
                                    <div class="form-group clock-format-group hidden" id="clockFormatGroup">
                                        <label for="clockFormat">Clock Format</label>
                                        <select id="clockFormat" name="clockFormat">
                                            <option value="24h">24-hour format (23:45)</option>
                                            <option value="12h">12-hour format (11:45 PM)</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- UI Element Scaling Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-expand-arrows-alt"></i>
                                    UI Element Scaling
                                </div>
                                <div class="subsection-content">
                                    <!-- Compact Scaling Grid -->
                                    <div class="scaling-grid">
                                <div class="scaling-item">
                                    <label for="uiScaling.content">Content</label>
                                    <div class="slider-wrapper modern-slider">
                                        <input type="range" id="uiScaling.content" name="uiScaling.content" min="50" max="200" value="100" step="5">
                                        <div class="slider-percentage" data-target="uiScaling.content">100%</div>
                                    </div>
                                </div>
                                <div class="scaling-item">
                                    <label for="uiScaling.clearlogo">Clearlogo</label>
                                    <div class="slider-wrapper modern-slider">
                                        <input type="range" id="uiScaling.clearlogo" name="uiScaling.clearlogo" min="50" max="200" value="100" step="5">
                                        <div class="slider-percentage" data-target="uiScaling.clearlogo">100%</div>
                                    </div>
                                </div>
                                <div class="scaling-item">
                                    <label for="uiScaling.clock">Clock</label>
                                    <div class="slider-wrapper modern-slider">
                                        <input type="range" id="uiScaling.clock" name="uiScaling.clock" min="50" max="200" value="100" step="5">
                                        <div class="slider-percentage" data-target="uiScaling.clock">100%</div>
                                    </div>
                                </div>
                                <div class="scaling-item">
                                    <label for="uiScaling.global">Global</label>
                                    <div class="slider-wrapper modern-slider">
                                        <input type="range" id="uiScaling.global" name="uiScaling.global" min="50" max="200" value="100" step="5">
                                        <div class="slider-percentage" data-target="uiScaling.global">100%</div>
                                    </div>
                                </div>
                                
                                <!-- Quick Template Buttons -->
                                <div class="scaling-presets">
                                    <div class="preset-buttons">
                                        <button type="button" class="preset-button" data-preset="4k-tv">
                                            <i class="fas fa-tv"></i> 4K TV
                                        </button>
                                        <button type="button" class="preset-button" data-preset="full-hd">
                                            <i class="fas fa-desktop"></i> Full HD
                                        </button>
                                        <button type="button" class="preset-button" data-preset="ultrawide">
                                            <i class="fas fa-expand-arrows-alt"></i> Ultrawide
                                        </button>
                                        <button type="button" id="reset-ui-scaling" class="reset-button">
                                            <i class="fas fa-undo"></i> Reset
                                        </button>
                                    </div>
                                </div>
                                </div>
                                
                                <!-- Effects & Transitions Subsection -->
                                <div class="subsection-header" id="effectsHeader">
                                    <i class="fas fa-magic"></i>
                                    Effects & Transitions
                                </div>
                                <div class="subsection-content" id="effectsContent">
                                <div class="form-group">
                                    <label for="transitionEffect">Transition Effect</label>
                                    <select id="transitionEffect" name="transitionEffect">
                                        <option value="kenburns">Ken Burns</option>
                                        <option value="fade">Fade In/Out</option>
                                        <option value="slide">Slide Transition</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="effectPauseTime">Effect Pause Time (seconds)</label>
                                    <input type="number" id="effectPauseTime" name="effectPauseTime" min="0" max="10" step="0.5" value="2">
                                </div>
                                </div>
                                
                                <!-- Playback Timing Subsection (moved from General) -->
                                <div class="subsection-header">
                                    <i class="fas fa-cogs"></i>
                                    Playback Timing
                                </div>
                                <div class="subsection-content">
                                <div class="form-group">
                                    <label for="transitionIntervalSeconds" title="How many seconds each poster is visible.">Transition Interval (seconds)</label>
                                    <div class="number-input-wrapper">
                                        <input type="number" id="transitionIntervalSeconds" name="transitionIntervalSeconds" min="1" max="300" step="1" required>
                                        <div class="number-controls" role="group">
                                            <button type="button" class="number-btn" id="increment-transitionIntervalSeconds">
                                                <i class="fas fa-chevron-up"></i>
                                            </button>
                                            <button type="button" class="number-btn" id="decrement-transitionIntervalSeconds">
                                                <i class="fas fa-chevron-down"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div id="transitionIntervalSeconds-help" class="form-help">Time in seconds between poster transitions (1-300). <strong>Note:</strong> Does not apply to Wallart Mode - use Wallart Mode refresh settings instead.</div>
                                </div>
                            </div>
                        </div> <!-- End of form-section unified-section -->
                        </div> <!-- End of section-main-content -->
                    </section>
                    

                    <!-- Sources Section -->
                    <section class="section-content" id="media-section" role="tabpanel">
                        <div class="section-main-content">
                            <div class="section-title">
                                <i class="fas fa-database"></i>
                                Content Sources
                            </div>
                            
                            <!-- Quick Navigation Links -->
            <div class="quick-nav-links">
                <div class="quick-nav-item">
                    <a href="#" class="quick-nav-link" onclick="scrollToSubsection('plex-subsection'); return false;" title="Plex Configuration">
                        <i class="fas fa-server"></i>
                    </a>
                    <span class="quick-nav-label">Plex</span>
                </div>
                <div class="quick-nav-item">
                    <a href="#" class="quick-nav-link" onclick="scrollToSubsection('jellyfin-subsection'); return false;" title="Jellyfin Configuration">
                        <i class="fas fa-cube"></i>
                    </a>
                    <span class="quick-nav-label">Jellyfin</span>
                </div>
                <div class="quick-nav-item">
                    <a href="#" class="quick-nav-link" onclick="scrollToSubsection('tmdb-subsection'); return false;" title="TMDB Configuration">
                        <i class="fas fa-film"></i>
                    </a>
                    <span class="quick-nav-label">TMDB</span>
                </div>
                <div class="quick-nav-item">
                    <a href="#" class="quick-nav-link" onclick="scrollToSubsection('tvdb-subsection'); return false;" title="TVDB Configuration">
                        <i class="fas fa-tv"></i>
                    </a>
                    <span class="quick-nav-label">TVDB</span>
                </div>
            </div>                            <!-- Unified Sources Container -->
                            <div class="form-section unified-section">
                                
                                <!-- Plex Media Server Subsection -->
                                <div class="subsection-header" id="plex-subsection">
                                    <i class="fas fa-server"></i>
                                    Plex Media Server
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="mediaServers[0].enabled" name="mediaServers[0].enabled">
                                        <label for="mediaServers[0].enabled">Enable Plex Server as Content Source</label>
                                    </div>
                                    
                                    <!-- Plex Configuration Container (hidden when disabled) -->
                                    <div id="plex-config-container" class="source-config-container">
                                        <div class="form-group">
                                            <label for="mediaServers[0].hostname">Plex Hostname/IP</label>
                                            <input type="text" id="mediaServers[0].hostname" name="mediaServers[0].hostname" placeholder="192.168.1.10 or plex.local" pattern="^[a-zA-Z0-9\.\-]+$">
                                        </div>
                                        <div class="form-group">
                                            <label for="mediaServers[0].port">Plex Port</label>
                                            <input type="number" id="mediaServers[0].port" name="mediaServers[0].port" min="1" max="65535" placeholder="32400">
                                        </div>
                                        <div class="form-group">
                                            <label for="mediaServers[0].token">Plex Token</label>
                                            <input type="password" id="mediaServers[0].token" name="mediaServers[0].token">
                                        </div>
                                        
                                        <!-- Library Configuration Subsection -->
                                        <div class="subsection-header">
                                            <i class="fas fa-folder-open"></i>
                                            Library Configuration
                                        </div>
                                        <div class="subsection-content">
                                            <div class="form-group">
                                                <label>Movie Library Names</label>
                                                <div id="movie-libraries-container" class="library-container">
                                                    <small>Test the connection to fetch the libraries.</small>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label>Show Library Names</label>
                                                <div id="show-libraries-container" class="library-container">
                                                    <small>Test the connection to fetch the libraries.</small>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Content Filtering Subsection -->
                                        <div class="subsection-header" id="content-filtering-subsection">
                                            <i class="fas fa-filter"></i>
                                            Content Filtering
                                        </div>
                                        <div class="subsection-content">
                                            <div class="form-group">
                                                <label for="mediaServers[0].ratingFilter">Rating Filter</label>
                                                <div class="rating-filter-container">
                                                    <div id="mediaServers[0].ratingFilter" class="dynamic-rating-filter multi-select-checkboxes" data-source="plex">
                                                        <div class="loading-indicator">Loading ratings...</div>
                                                    </div>
                                                    <input type="hidden" name="mediaServers[0].ratingFilter" id="mediaServers[0].ratingFilter-hidden" value="">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="mediaServers[0].genreFilter">Genre Filter</label>
                                                <div class="genre-filter-container">
                                                    <div id="mediaServers[0].genreFilter" class="dynamic-genre-filter multi-select-checkboxes" data-source="plex">
                                                        <div class="loading-indicator">Loading genres...</div>
                                                    </div>
                                                    <input type="hidden" name="mediaServers[0].genreFilter" id="mediaServers[0].genreFilter-hidden" value="">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label for="mediaServers[0].qualityFilter">Quality Filter</label>
                                                <div id="mediaServers[0].qualityFilter" class="dynamic-quality-filter multi-select-checkboxes" data-source="plex">
                                                    <div class="loading-indicator">Loading qualities...</div>
                                                </div>
                                                <input type="hidden" name="mediaServers[0].qualityFilter" id="mediaServers[0].qualityFilter-hidden" value="">
                                            </div>
                                            <div class="form-group checkbox-group">
                                                <input type="checkbox" id="mediaServers[0].recentlyAddedOnly" name="mediaServers[0].recentlyAddedOnly">
                                                <label for="mediaServers[0].recentlyAddedOnly">Show Only Recently Added Content</label>
                                            </div>
                                            <div class="form-group recently-added-days-group hidden" id="recentlyAddedDaysContainer">
                                                <label for="mediaServers[0].recentlyAddedDays">Recently Added (days)</label>
                                                <input type="number" id="mediaServers[0].recentlyAddedDays" name="mediaServers[0].recentlyAddedDays" min="1" max="365" placeholder="30" value="30">
                                            </div>
                                        </div>
                                        
                                        <!-- Connection Testing Subsection -->
                                        <div class="subsection-header">
                                            <i class="fas fa-plug"></i>
                                            Connection Testing
                                        </div>
                                        <div class="subsection-content">
                                            <div class="form-group">
                                                <button type="button" id="test-plex-button" class="btn btn-primary">
                                                    <i class="fas fa-plug icon"></i>
                                                    <span>Test Plex Connection</span>
                                                </button>
                                                <small id="plex-connection-status"></small>
                                            </div>
                                        </div>
                                    </div> <!-- End Plex Configuration Container -->
                                </div>
                                
                                <!-- Jellyfin Media Server Subsection -->
                                <div class="subsection-header" id="jellyfin-subsection">
                                    <i class="fas fa-cube"></i>
                                    Jellyfin Media Server
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="mediaServers[1].enabled" name="mediaServers[1].enabled">
                                        <label for="mediaServers[1].enabled">Enable Jellyfin Server as Content Source</label>
                                    </div>
                                    <div class="form-group">
                                        <label for="mediaServers[1].hostname">Jellyfin Hostname/IP</label>
                                        <input type="text" id="mediaServers[1].hostname" name="mediaServers[1].hostname" placeholder="192.168.1.101 or jellyfin.local" pattern="^[a-zA-Z0-9\.\-]+$">
                                    </div>
                                    <div class="form-group">
                                        <label for="mediaServers[1].port">Jellyfin Port</label>
                                        <input type="number" id="mediaServers[1].port" name="mediaServers[1].port" min="1" max="65535" placeholder="8096">
                                    </div>
                                    <div class="form-group">
                                        <label for="mediaServers[1].apiKey">Jellyfin API Key</label>
                                        <input type="password" id="mediaServers[1].apiKey" name="mediaServers[1].apiKey">
                                    </div>
                                </div>
                                
                                <!-- Jellyfin Library Configuration Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-folder-open"></i>
                                    Jellyfin Library Configuration
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group">
                                        <label>Movie Library Names</label>
                                        <div id="jellyfin-movie-libraries-container" class="library-container">
                                            <small>Test the connection to fetch the libraries.</small>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>Show Library Names</label>
                                        <div id="jellyfin-show-libraries-container" class="library-container">
                                            <small>Test the connection to fetch the libraries.</small>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Jellyfin Content Filtering Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-filter"></i>
                                    Jellyfin Content Filtering
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group">
                                        <label for="mediaServers[1].ratingFilter">Rating Filter</label>
                                        <div class="rating-filter-container">
                                            <div id="mediaServers[1].ratingFilter" class="dynamic-rating-filter multi-select-checkboxes" data-source="jellyfin">
                                                <div class="loading-indicator">Loading ratings...</div>
                                            </div>
                                            <input type="hidden" name="mediaServers[1].ratingFilter" id="mediaServers[1].ratingFilter-hidden" value="">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="mediaServers[1].genreFilter">Genre Filter</label>
                                        <div class="genre-filter-container">
                                            <div id="mediaServers[1].genreFilter" class="dynamic-genre-filter multi-select-checkboxes" data-source="jellyfin">
                                                <div class="loading-indicator">Loading genres...</div>
                                            </div>
                                            <input type="hidden" name="mediaServers[1].genreFilter" id="mediaServers[1].genreFilter-hidden" value="">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="mediaServers[1].qualityFilter">Quality Filter</label>
                                        <div id="mediaServers[1].qualityFilter" class="dynamic-quality-filter multi-select-checkboxes" data-source="jellyfin">
                                            <div class="loading-indicator">Loading qualities...</div>
                                        </div>
                                        <input type="hidden" name="mediaServers[1].qualityFilter" id="mediaServers[1].qualityFilter-hidden" value="">
                                    </div>
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="mediaServers[1].recentlyAddedOnly" name="mediaServers[1].recentlyAddedOnly">
                                        <label for="mediaServers[1].recentlyAddedOnly">Show Only Recently Added Content</label>
                                    </div>
                                    <div class="form-group recently-added-days-group hidden" id="jellyfinRecentlyAddedDaysContainer">
                                        <label for="mediaServers[1].recentlyAddedDays">Recently Added (days)</label>
                                        <input type="number" id="mediaServers[1].recentlyAddedDays" name="mediaServers[1].recentlyAddedDays" min="1" max="365" placeholder="30" value="30">
                                    </div>
                                </div>
                                
                                <!-- Jellyfin Connection Testing Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-plug"></i>
                                    Jellyfin Connection Testing
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group">
                                        <button type="button" id="test-jellyfin-button" class="btn btn-primary">
                                            <i class="fas fa-plug icon"></i>
                                            <span>Test Jellyfin Connection</span>
                                        </button>
                                        <small id="jellyfin-connection-status"></small>
                                    </div>
                                </div>
                                
                                <!-- TMDB External Source Subsection -->
                                <div class="subsection-header" id="tmdb-subsection">
                                    <i class="fas fa-film"></i>
                                    TMDB External Source
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="tmdbSource.enabled" name="tmdbSource.enabled">
                                        <label for="tmdbSource.enabled">Enable TMDB as Content Source</label>
                                    </div>
                                    <div class="form-group">
                                        <label for="tmdbSource.apiKey">TMDB API Key</label>
                                        <input type="password" id="tmdbSource.apiKey" name="tmdbSource.apiKey" placeholder="Your TMDB API v3 key">
                                        <small>Get a free API key from <a href="https://www.themoviedb.org/settings/api" target="_blank" rel="noopener">TMDB API Settings</a></small>
                                    </div>
                                    <div class="form-group">
                                        <label for="tmdbSource.category">Content Category</label>
                                        <select id="tmdbSource.category" name="tmdbSource.category">
                                            <optgroup label="ð¬ Movies">
                                                <option value="popular">ð¥ Popular Movies</option>
                                                <option value="top_rated">â­ Top Rated Movies</option>
                                                <option value="now_playing">ð­ Now Playing</option>
                                                <option value="upcoming">ð Upcoming Movies</option>
                                                <option value="latest">ð Latest Movies</option>
                                            </optgroup>
                                            <optgroup label="ðº TV Shows">
                                                <option value="tv_popular">ð¥ Popular TV Shows</option>
                                                <option value="tv_top_rated">â­ Top Rated TV Shows</option>
                                                <option value="tv_on_the_air">ð¡ Currently Airing</option>
                                                <option value="tv_airing_today">ðº Airing Today</option>
                                                <option value="tv_latest">ð Latest TV Shows</option>
                                            </optgroup>
                                            <optgroup label="ð¯ Trending">
                                                <option value="trending_all_day">ð Trending Today (All)</option>
                                                <option value="trending_movie_day">ð¬ Trending Movies (Day)</option>
                                                <option value="trending_tv_day">ðº Trending TV (Day)</option>
                                                <option value="trending_all_week">ð Trending Week (All)</option>
                                                <option value="trending_movie_week">ð¬ Trending Movies (Week)</option>
                                                <option value="trending_tv_week">ðº Trending TV (Week)</option>
                                            </optgroup>
                                            <optgroup label="ð Collections">
                                                <option value="discover_movie">ð Discover Movies</option>
                                                <option value="discover_tv">ð Discover TV Shows</option>
                                            </optgroup>
                                        </select>
                                        <small class="help-text">ð¯ Choose the type of content to fetch from TMDB. Trending shows what's hot right now!</small>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="tmdbSource.minRating">Minimum Rating (0-10)</label>
                                        <input type="number" id="tmdbSource.minRating" name="tmdbSource.minRating" min="0" max="10" step="0.1" placeholder="6.0">
                                    </div>
                                    <div class="form-group">
                                        <label for="tmdbSource.yearFilter">From Year</label>
                                        <input type="number" id="tmdbSource.yearFilter" name="tmdbSource.yearFilter" min="1900" max="2030" placeholder="2000">
                                    </div>
                                    <div class="form-group">
                                        <label for="tmdbSource.genreFilter">Genre Filter</label>
                                        <div class="genre-filter-container">
                                            <select id="tmdbSource.genreFilter" name="tmdbSource.genreFilter" multiple class="genre-filter-select">
                                                <option value="">Loading genres...</option>
                                            </select>
                                            <button type="button" class="btn-clear-genres" id="clearTmdbGenresBtn" title="Clear all selected genres">
                                                <i class="fas fa-times"></i> Clear Selection
                                            </button>
                                        </div>
                                        <small class="genre-filter-help">ð¡ Tip: Hold Ctrl (Windows) or Cmd (Mac) while clicking to select multiple genres. Click "Clear Selection" to show all content.</small>
                                    </div>
                                    <div class="form-group">
                                        <button type="button" id="test-tmdb-button" class="btn btn-primary">
                                            <i class="fas fa-plug icon"></i>
                                            <span>Test TMDB Connection</span>
                                        </button>
                                        <small id="tmdb-connection-status"></small>
                                    </div>
                                </div>
                                
                                <!-- Streaming Releases Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-stream"></i>
                                    Streaming Releases (Needs TMDB Enabled)
                                </div>
                                <div class="subsection-content">
                                    <p class="external-source-description">Add latest releases from popular streaming platforms using TMDB's streaming provider data.</p>
                                    
                                    <div class="form-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="streamingSources.enabled" name="streamingSources.enabled">
                                            Enable Streaming Releases
                                        </label>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="streamingSources.region">Region</label>
                                        <select id="streamingSources.region" name="streamingSources.region">
                                            <option value="US">ðºð¸ United States</option>
                                            <option value="NL">ð³ð± Netherlands</option>
                                            <option value="GB">ð¬ð§ United Kingdom</option>
                                            <option value="DE">ð©ðª Germany</option>
                                            <option value="FR">ð«ð· France</option>
                                            <option value="CA">ð¨ð¦ Canada</option>
                                            <option value="AU">ð¦ðº Australia</option>
                                            <option value="ES">ðªð¸ Spain</option>
                                            <option value="IT">ð®ð¹ Italy</option>
                                            <option value="BR">ð§ð· Brazil</option>
                                            <option value="MX">ð²ð½ Mexico</option>
                                            <option value="AR">ð¦ð· Argentina</option>
                                            <option value="JP">ð¯ðµ Japan</option>
                                            <option value="KR">ð°ð· South Korea</option>
                                            <option value="IN">ð®ð³ India</option>
                                            <option value="CN">ð¨ð³ China</option>
                                            <option value="RU">ð·ðº Russia</option>
                                            <option value="BE">ð§ðª Belgium</option>
                                            <option value="AT">ð¦ð¹ Austria</option>
                                            <option value="CH">ð¨ð­ Switzerland</option>
                                            <option value="SE">ð¸ðª Sweden</option>
                                            <option value="NO">ð³ð´ Norway</option>
                                            <option value="DK">ð©ð° Denmark</option>
                                            <option value="FI">ð«ð® Finland</option>
                                            <option value="PL">ðµð± Poland</option>
                                            <option value="CZ">ð¨ð¿ Czech Republic</option>
                                            <option value="HU">ð­ðº Hungary</option>
                                            <option value="PT">ðµð¹ Portugal</option>
                                            <option value="GR">ð¬ð· Greece</option>
                                            <option value="TR">ð¹ð· Turkey</option>
                                            <option value="IL">ð®ð± Israel</option>
                                            <option value="ZA">ð¿ð¦ South Africa</option>
                                            <option value="EG">ðªð¬ Egypt</option>
                                            <option value="SA">ð¸ð¦ Saudi Arabia</option>
                                            <option value="AE">ð¦ðª United Arab Emirates</option>
                                            <option value="TH">ð¹ð­ Thailand</option>
                                            <option value="SG">ð¸ð¬ Singapore</option>
                                            <option value="MY">ð²ð¾ Malaysia</option>
                                            <option value="ID">ð®ð© Indonesia</option>
                                            <option value="PH">ðµð­ Philippines</option>
                                            <option value="VN">ð»ð³ Vietnam</option>
                                            <option value="TW">ð¹ð¼ Taiwan</option>
                                            <option value="HK">ð­ð° Hong Kong</option>
                                            <option value="NZ">ð³ð¿ New Zealand</option>
                                            <option value="CL">ð¨ð± Chile</option>
                                            <option value="CO">ð¨ð´ Colombia</option>
                                            <option value="PE">ðµðª Peru</option>
                                            <option value="VE">ð»ðª Venezuela</option>
                                            <option value="UY">ðºð¾ Uruguay</option>
                                            <option value="EC">ðªð¨ Ecuador</option>
                                            <option value="BO">ð§ð´ Bolivia</option>
                                            <option value="PY">ðµð¾ Paraguay</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label>Streaming Providers</label>
                                        <div class="streaming-providers-grid">
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.netflix" name="streamingSources.netflix" value="8">
                                                <i class="fas fa-film"></i>
                                                <span>Netflix</span>
                                            </label>
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.disney" name="streamingSources.disney" value="337">
                                                <i class="fas fa-magic"></i>
                                                <span>Disney+</span>
                                            </label>
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.prime" name="streamingSources.prime" value="119">
                                                <i class="fab fa-amazon"></i>
                                                <span>Prime Video</span>
                                            </label>
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.hbo" name="streamingSources.hbo" value="1899">
                                                <i class="fas fa-play-circle"></i>
                                                <span>Max (HBO)</span>
                                            </label>
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.hulu" name="streamingSources.hulu" value="15">
                                                <i class="fas fa-tv"></i>
                                                <span>Hulu</span>
                                            </label>
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.apple" name="streamingSources.apple" value="350">
                                                <i class="fab fa-apple"></i>
                                                <span>Apple TV+</span>
                                            </label>
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.paramount" name="streamingSources.paramount" value="531">
                                                <i class="fas fa-mountain"></i>
                                                <span>Paramount+</span>
                                            </label>
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.crunchyroll" name="streamingSources.crunchyroll" value="283">
                                                <i class="fas fa-dragon"></i>
                                                <span>Crunchyroll</span>
                                            </label>
                                            <label class="checkbox-label streaming-provider">
                                                <input type="checkbox" id="streamingSources.newReleases" name="streamingSources.newReleases" value="new">
                                                <i class="fas fa-star"></i>
                                                <span>New Releases (All)</span>
                                            </label>
                                        </div>
                                    </div>
                                    
                                    
                                    
                                    <div class="form-group">
                                        <label for="streamingSources.minRating">Minimum Rating (0-10)</label>
                                        <input type="number" id="streamingSources.minRating" name="streamingSources.minRating" min="0" max="10" step="0.1" placeholder="6.0">
                                    </div>
                                    
                                    <div class="form-group">
                                        <button type="button" id="test-streaming-button" class="btn btn-primary">
                                            <i class="fas fa-stream icon"></i>
                                            <span>Test Streaming Connection</span>
                                        </button>
                                        <small id="streaming-connection-status"></small>
                                    </div>
                                </div>
                                
                                <!-- TVDB External Source Subsection -->
                                <div class="subsection-header" id="tvdb-subsection">
                                    <i class="fas fa-tv"></i>
                                    TVDB External Source
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="tvdbSource.enabled" name="tvdbSource.enabled">
                                        <label for="tvdbSource.enabled">Enable TVDB as Content Source</label>
                                    </div>
                                    <div class="form-group">
                                        <label for="tvdbSource.category">Content Category</label>
                                        <select id="tvdbSource.category" name="tvdbSource.category">
                                            <optgroup label="ð By Rating & Popularity">
                                                <option value="top_rated">â­ Top Rated</option>
                                                <option value="popular">ð¥ Most Popular</option>
                                            </optgroup>
                                            <optgroup label="ð By Date">
                                                <option value="recently_updated">ð Recently Updated</option>
                                                <option value="newest">ðº Newest Releases</option>
                                                <option value="oldest">ð¼ Classic Content</option>
                                            </optgroup>
                                            <optgroup label="ð By Activity">
                                                <option value="trending">ð Trending Now</option>
                                                <option value="recently_added">â Recently Added to TVDB</option>
                                            </optgroup>
                                            <optgroup label="ð¤ Alphabetical">
                                                <option value="alphabetical">ð¤ A-Z Order</option>
                                            </optgroup>
                                        </select>
                                        <small class="help-text">ð¯ Choose how to sort and discover content from TVDB's extensive database!</small>
                                    </div>
                                    
                                    <div class="form-group number-input-group">
                                        <div class="form-group">
                                            <label for="tvdbSource.minRating">Minimum Rating</label>
                                            <input type="number" id="tvdbSource.minRating" name="tvdbSource.minRating" min="0" max="10" step="0.1" value="0">
                                        </div>
                                        <div class="form-group">
                                            <label for="tvdbSource.yearFilter">Year Filter</label>
                                            <input type="number" id="tvdbSource.yearFilter" name="tvdbSource.yearFilter" min="1900" max="2030" placeholder="e.g. 2023">
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="tvdbSource.genreFilter">Genre Filter</label>
                                        <div class="genre-filter-container">
                                            <select id="tvdbSource.genreFilter" name="tvdbSource.genreFilter" multiple class="genre-filter-select">
                                                <option value="">Loading genres...</option>
                                            </select>
                                            <button type="button" class="btn-clear-genres" id="clearTvdbGenresBtn" title="Clear all selected genres">
                                                <i class="fas fa-times"></i> Clear Selection
                                            </button>
                                        </div>
                                        <small class="genre-filter-help">ð¡ Tip: Hold Ctrl (Windows) or Cmd (Mac) while clicking to select multiple genres. Click "Clear Selection" to show all content.</small>
                                    </div>
                                    
                                    <!-- TVDB Connection Test -->
                                    <div class="form-group">
                                        <button type="button" id="test-tvdb-connection" class="btn btn-primary">
                                            <i class="fas fa-plug icon"></i>
                                            <span>Test TVDB Connection</span>
                                        </button>
                                        <small id="tvdb-connection-status"></small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Authentication Section -->
                    <section class="section-content" id="authentication-section" role="tabpanel">
                        <div class="section-main-content">
                            <div class="section-title">
                                <i class="fas fa-shield-alt"></i>
                                Authentication & Security
                            </div>
                            
                            <!-- Unified Authentication & Security Container -->
                            <div class="form-section unified-section">
                                
                                <!-- Password Management Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-key"></i>
                                    Password Management
                                </div>
                                <div class="subsection-content">
                                    <div id="password-form">
                                        <div class="form-group">
                                            <label for="currentPassword">Current Password</label>
                                            <input type="password" id="currentPassword" name="currentPassword" autocomplete="current-password">
                                        </div>
                                        <div class="form-group">
                                            <label for="newPassword">New Password</label>
                                            <input type="password" id="newPassword" name="newPassword" autocomplete="new-password" minlength="8">
                                        </div>
                                        <div class="form-group">
                                            <label for="confirmPassword">Confirm New Password</label>
                                            <input type="password" id="confirmPassword" name="confirmPassword" autocomplete="new-password">
                                        </div>
                                        <div class="form-actions">
                                            <button type="button" id="change-password-button" class="btn btn-primary">
                                                <i class="fas fa-lock icon"></i>
                                                <span>Change Password</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Two-Factor Authentication Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-mobile-alt"></i>
                                    Two-Factor Authentication
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="enable2FA" name="enable2FA">
                                        <label for="enable2FA">Setup Two-Factor Authentication</label>
                                    </div>
                                    <div id="2fa-status-text" class="status-text disabled"></div>
                                </div>
                                
                                <!-- API Access Management Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-code"></i>
                                    API Access Management
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group">
                                        <p>Manage a permanent API key for use with external applications or scripts (like Swagger).</p>
                                    </div>
                                    <div class="form-group" id="api-key-status">
                                        <p>Status: <span id="api-key-status-text" class="status-text">Loading...</span></p>
                                    </div>
                                    <div id="api-key-display-container" class="is-hidden form-group">
                                        <label>Current API Key:</label>
                                        <div class="api-key-display-container">
                                            <input id="api-key-input" type="password" readonly>
                                            <button id="toggle-api-key-visibility-button" type="button" class="btn btn-icon" title="Show/hide key">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button id="copy-api-key-button" type="button" class="btn btn-icon" title="Copy to clipboard">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="form-actions">
                                        <button id="generate-api-key-button" type="button" class="btn btn-primary">
                                            <i class="fas fa-key"></i>
                                            Generate New Key
                                        </button>
                                        <button id="revoke-api-key-button" type="button" class="btn btn-danger" disabled>
                                            <i class="fas fa-trash-alt"></i>
                                            Revoke Key
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    

                    <!-- Management Section -->
                    <section class="section-content" id="management-section" role="tabpanel">
                        <div class="section-main-content">
                            <div class="section-title">
                                <i class="fas fa-tools"></i>
                                Management & Tools
                            </div>
                            
                            <!-- Unified Management & Tools Container -->
                            <div class="form-section unified-section">
                                
                                <!-- Cache Management Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-database"></i>
                                    Cache Management
                                </div>
                                <div class="subsection-content">                                    
                                    <!-- Cache Size Display -->
                                    <div class="cache-stats-container" style="margin-bottom: 1rem;">
                                        <div class="stat-item">
                                            <div class="stat-label">
                                                <i class="fas fa-hdd"></i>
                                                Cache Storage
                                            </div>
                                            <div class="stat-value" id="cache-disk-usage">
                                                <span class="loading">Loading...</span>
                                            </div>
                                        </div>
                                        <div class="stat-item">
                                            <div class="stat-label">
                                                <i class="fas fa-memory"></i>
                                                Memory Cache
                                            </div>
                                            <div class="stat-value" id="cache-item-count">
                                                <span class="loading">Loading...</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Cache Actions - 2x2 Grid Layout -->
                                    <div class="form-actions" style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                                        <button type="button" id="refresh-cache-stats" class="btn btn-secondary">
                                            <i class="fas fa-sync-alt icon"></i>
                                            <span>Refresh Stats</span>
                                        </button>
                                        <button type="button" id="cleanup-cache-button" class="btn btn-secondary">
                                            <i class="fas fa-compress-alt icon"></i>
                                            <span>Run Cleanup</span>
                                        </button>
                                        <button type="button" id="clear-cache-button" class="btn btn-primary">
                                            <i class="fas fa-broom icon"></i>
                                            <span>Clear Cache</span>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Media Management Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-sync-alt"></i>
                                    Media Management
                                </div>
                                <div class="subsection-content">
                                    <div class="form-actions">
                                        <button type="button" id="refresh-media-button" class="btn btn-primary" disabled>
                                            <i class="fas fa-sync-alt icon"></i>
                                            <span>Refresh Media</span>
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Application Controls Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-power-off"></i>
                                    Application Controls
                                </div>
                                <div class="subsection-content">
                                    <div class="form-actions form-actions-grid">
                                        <button type="button" id="restart-app-button" class="btn btn-danger">
                                            <i class="fas fa-power-off icon"></i>
                                            <span>Restart Application</span>
                                        </button>
                                        <button type="button" id="status-check-button" class="btn btn-primary">
                                            <i class="fas fa-heartbeat icon"></i>
                                            <span>Status Check</span>
                                        </button>
                                        <button type="button" id="performance-monitor-button" class="btn btn-info">
                                            <i class="fas fa-chart-line icon"></i>
                                            <span>Performance Monitor</span>
                                        </button>
                                    </div>
                                    
                                    <!-- Status Display Areas -->
                                    <div id="status-display" class="status-display" style="display: none;">
                                        <div class="status-header">
                                            <h4><i class="fas fa-heartbeat"></i> System Status</h4>
                                        </div>
                                        <div id="status-content" class="status-content">
                                            <div class="loading">Checking system status...</div>
                                        </div>
                                    </div>
                                    
                                    
                                    <div id="performance-display" class="status-display" style="display: none;">
                                        <div class="status-header">
                                            <h4><i class="fas fa-chart-line"></i> Performance Monitor</h4>
                                        </div>
                                        <div id="performance-content" class="status-content">
                                            <div class="loading">Loading performance data...</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Auto-Update Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-download"></i>
                                    Automatic Updates
                                </div>
                                <div class="subsection-content">
                                    <!-- Update Status Display -->
                                    <div id="update-status-display" class="status-display">
                                        <div class="status-header">
                                            <h4><i class="fas fa-info-circle"></i> Update Status</h4>
                                        </div>
                                        <div id="update-status-content" class="status-content">
                                            <div id="update-idle-state">
                                                <div class="status-item">
                                                    <div class="status-item-header">Status</div>
                                                    <div class="status-item-value status-success">Ready for Updates</div>
                                                </div>
                                            </div>
                                            <div id="update-progress-state" style="display: none;">
                                                <div class="update-progress-container">
                                                    <div class="update-progress-header">
                                                        <span id="update-phase-text">Checking for updates...</span>
                                                        <span id="update-progress-percent">0%</span>
                                                    </div>
                                                    <div class="progress-bar">
                                                        <div id="update-progress-bar" class="progress-fill"></div>
                                                    </div>
                                                    <div id="update-message" class="update-message">
                                                        Preparing update process...
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Update Actions -->
                                    <div class="form-actions" style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-top: 1rem;">
                                        <button type="button" id="start-auto-update-button" class="btn btn-primary">
                                            <i class="fas fa-download icon"></i>
                                            <span>Start Auto-Update</span>
                                        </button>
                                        <button type="button" id="rollback-update-button" class="btn btn-secondary">
                                            <i class="fas fa-undo icon"></i>
                                            <span>Rollback</span>
                                        </button>
                                    </div>
                                    
                                    <!-- Force option moved into modal when no update is available -->
                                    
                                    <!-- Backup Management -->
                                    <div class="form-actions" style="display: flex; gap: 0.5rem; margin-top: 0.5rem;">
                                        <button type="button" id="list-backups-button" class="btn btn-secondary" style="flex: 1;">
                                            <i class="fas fa-archive icon"></i>
                                            <span>View Backups</span>
                                        </button>
                                    </div>
                                    
                                    <!-- Backup List Display -->
                                    <div id="backups-display" class="status-display" style="display: none; margin-top: 1rem;">
                                        <div class="status-header">
                                            <h4><i class="fas fa-archive"></i> Available Backups</h4>
                                        </div>
                                        <div id="backups-content" class="status-content">
                                            <div class="loading">Loading backups...</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Server Settings Subsection (moved from General) -->
                                <div class="subsection-header">
                                    <i class="fas fa-server"></i>
                                    Server Settings
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group">
                                        <label for="SERVER_PORT">Port Number</label>
                                        <div class="number-input-wrapper">
                                            <input type="number" id="SERVER_PORT" name="SERVER_PORT" min="1024" max="65535" step="1" required>
                                            <div class="number-controls" role="group">
                                                <button type="button" class="number-btn" id="increment-serverPort">
                                                    <i class="fas fa-chevron-up"></i>
                                                </button>
                                                <button type="button" class="number-btn" id="decrement-serverPort">
                                                    <i class="fas fa-chevron-down"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div id="serverPort-help" class="form-help">Port number for the application server (1024-65535)</div>
                                    </div>
                                </div>

                                <!-- Debug & Logging Subsection (moved from General) -->
                                <div class="subsection-header">
                                    <i class="fas fa-bug"></i>
                                    Debug & Logging
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="DEBUG" name="DEBUG">
                                        <label for="DEBUG">Enable debug mode</label>
                                    </div>
                                    <div id="DEBUG-help" class="form-help">Enable detailed logging for troubleshooting</div>
                                    
                                    <div class="form-actions">
                                        <a href="/admin/logs" target="_blank" class="btn btn-primary">
                                            <i class="fas fa-terminal"></i>
                                            View live logs
                                        </a>
                                    </div>
                                </div>

                                <!-- Promobox Site Subsection -->
                                <div class="subsection-header">
                                    <i class="fas fa-server"></i>
                                    Promobox Site
                                </div>
                                <div class="subsection-content">
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="siteServer.enabled" name="siteServer.enabled">
                                        <label for="siteServer.enabled">Enable Site</label>
                                    </div>
                                    <div class="form-group site-server-port-group" id="siteServerPortGroup">
                                        <label for="siteServer.port">Port Number</label>
                                        <input type="number" id="siteServer.port" name="siteServer.port" min="1024" max="65535" value="4001">
                                    </div>
                                    <!-- Site Status Inline (moved from Promobox Site) -->
                                    <div id="siteServerStatus" class="status-indicator site-server-status" style="margin-top: 0.75rem;">
                                        <div class="status-badge">
                                            <span class="status-icon">ð</span>
                                            <span class="status-text">Promobox site running on <a href="http://localhost:4001" target="_blank" class="status-link">http://localhost:4001</a></span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Project & Support Subsection -->
                                <div class="subsection-header">
                                    <i class="fab fa-github"></i>
                                    Project & Support
                                </div>
                                <div class="subsection-content">
                                    <div class="project-info" style="margin-bottom: 1rem; padding: 1rem; background: rgba(255, 255, 255, 0.02); border-radius: 6px; border: 1px solid rgba(255, 255, 255, 0.1);">
                                        <h4 style="margin: 0 0 0.5rem 0; color: #fff; font-size: 0.95rem;">
                                            <i class="fas fa-heart" style="color: #e74c3c; margin-right: 0.5rem;"></i>
                                            Open Source Project
                                        </h4>
                                        <p style="margin: 0 0 1rem 0; color: #b3b3b3; font-size: 0.85rem; line-height: 1.4;">
                                            Posterrama is free and open source software. Help improve it by reporting issues, suggesting features, or contributing code.
                                        </p>
                                        <div class="form-actions project-buttons" style="margin: 0; display: flex; flex-wrap: wrap; gap: 0.5rem;">
                                            <a href="https://github.com/Posterrama/posterrama" target="_blank" class="btn btn-primary project-btn">
                                                <i class="fab fa-github"></i>
                                                View on GitHub
                                            </a>
                                            <a href="https://github.com/Posterrama/posterrama/issues" target="_blank" class="btn btn-secondary project-btn">
                                                <i class="fas fa-bug"></i>
                                                Report Issue
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <!-- Save Settings Button -->
                    <div class="form-save-section">
                        <div id="config-status">
                            <i class="fas fa-check-circle"></i>
                            Ready to save
                        </div>
                        <button type="submit" id="save-config-button" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            <span>Save Settings</span>
                        </button>
                    </div>
                </form>

            </main>
        </div> <!-- Close main-content -->
        
    </div> <!-- Close admin-layout -->

    <!-- Mobile Navigation Panel - similar to help panel but for navigation -->
    <aside id="mobile-nav-panel" class="mobile-nav-panel mobile-only">
        <div class="mobile-nav-header">
            <h3>Navigation</h3>
            <button class="btn btn-icon" id="close-mobile-nav">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <nav class="mobile-nav-content">
            <button class="mobile-nav-item active" data-section="display">
                <i class="fas fa-tv nav-icon"></i>
                <span>Display</span>
            </button>
            <button class="mobile-nav-item" data-section="media">
                <i class="fas fa-database nav-icon"></i>
                <span>Sources</span>
            </button>
            <button class="mobile-nav-item" data-section="authentication">
                <i class="fas fa-shield-alt nav-icon"></i>
                <span>Security</span>
            </button>
            
            <button class="mobile-nav-item" data-section="management">
                <i class="fas fa-tools nav-icon"></i>
                <span>Management</span>
            </button>
        </nav>
    </aside>

    <!-- Quick Help Panel -->
    <aside id="quick-help-panel" class="quick-help-panel" role="dialog">
        <div class="help-header">
            <h3 id="help-title">Display Settings Help</h3>
            <button class="btn btn-icon" id="close-help-panel">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="help-content" id="help-content" role="document">
            <div class="help-section">
                <h4>Transition Interval</h4>
                <p>How long each poster is displayed before switching to the next one (1â300 seconds). Shorter intervals are more dynamic; longer intervals allow more time to read details.</p>
                <p><em>Tip:</em> A range of <strong>8â15s</strong> usually feels smooth without being too fast.</p>
                <p><strong>Note:</strong> Wallart Mode uses its own refresh logic and ignores the transition interval.</p>
            </div>
            <div class="help-section">
                <h4>Wallart Mode</h4>
                <ul>
                    <li><strong>Enable Wallart Mode:</strong> Switch to a multiâposter grid layout.</li>
                    <li><strong>Poster Density:</strong> Controls how many posters are visible at once.</li>
                    <li><strong>Poster Refresh Rate:</strong> How frequently grid tiles update.</li>
                    <li><strong>Timing Randomness:</strong> Adds variation to refresh timing for a natural look.</li>
                    <li><strong>Animation Type:</strong> Choose a specific animation or use random.</li>
                </ul>
                <p><em>Tip:</em> A randomness of <strong>2â4</strong> and refresh rate around <strong>3â6</strong> gives a balanced, natural flow.</p>
            </div>
            <div class="help-section">
                <h4>Cinema Mode</h4>
                <p>Portraitâstyle digital movie poster mode. You can set the display orientation to Auto or a fixed Portrait option.</p>
            </div>
            <div class="help-section">
                <h4>Visual Elements</h4>
                <ul>
                    <li>Toggle ClearLogo, Poster, and Metadata visibility.</li>
                    <li>Show Rotten Tomatoes badge and set a minimum score threshold.</li>
                </ul>
            </div>
            <div class="help-section">
                <h4>Clock Widget</h4>
                <p>Shows a clock in screensaver mode. Choose the timezone (Auto or specific) and 24h/12h format.</p>
            </div>
            <div class="help-section">
                <h4>UI Element Scaling</h4>
                <p>Resize content, clearlogo, clock, and global UI scale. Use presets for quick deviceâspecific setups or Reset to defaults.</p>
                <p><em>Presets:</em> Try <strong>4K TV</strong> for livingâroom distances, and <strong>Ultrawide</strong> for 21:9 monitors; then fineâtune Global to <strong>110â120%</strong> if needed.</p>
            </div>
            <div class="help-section">
                <h4>Effects & Transitions</h4>
                <p>Select the transition effect (e.g., Ken Burns, Fade, Slide) and adjust the pause time between effects.</p>
            </div>
        </div>
    </div>

    <!-- 2FA Setup Modal -->
    <div id="2fa-modal" class="modal is-hidden">
        <div class="modal-background"></div>
        <div class="modal-content">
            <h2 id="2fa-modal-title">Setup Two-Factor Authentication</h2>
            <p id="2fa-modal-intro">Follow these steps to secure your account with 2FA:</p>
            <ol style="margin: 1rem 0; padding-left: 1.5rem;">
                <li>Install an authenticator app (Google Authenticator, Authy, Microsoft Authenticator, etc.)</li>
                <li>Scan the QR code below with your authenticator app</li>
                <li>Enter the 6-digit code from your app to complete setup</li>
            </ol>
            <div id="qr-code-container" style="text-align: center; margin: 1.5rem 0;">
                <!-- QR code will be inserted here by JS -->
            </div>
            <form id="2fa-verify-form">
                <div class="form-group">
                    <label for="2fa-token">Enter verification code from your authenticator app</label>
                    <input type="text" id="2fa-token" name="2fa-token" required pattern="\d{6}" maxlength="6" autocomplete="one-time-code" inputmode="numeric" placeholder="000000" style="text-align: center; font-size: 1.2rem; letter-spacing: 0.2rem;">
                </div>
                <div class="form-actions">
                    <button type="button" id="cancel-2fa-button" class="btn btn-secondary">Cancel Setup</button>
                    <button type="submit" class="btn btn-primary">Complete Setup</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Disable 2FA Confirmation Modal -->
    <div id="disable-2fa-modal" class="modal is-hidden">
        <div class="modal-background"></div>
        <div class="modal-content">
            <h2>Disable Two-Factor Authentication</h2>
            <p><strong>â ï¸ Warning:</strong> Disabling 2FA will make your account less secure.</p>
            <p>Please enter your current password to confirm this change:</p>
            <form id="disable-2fa-form">
                <div class="form-group">
                    <label for="disable-2fa-password">Current Password</label>
                    <input type="password" id="disable-2fa-password" name="password" required autocomplete="current-password">
                </div>
                <div class="form-actions">
                    <button type="button" id="cancel-disable-2fa-button" class="btn btn-secondary">Keep 2FA Enabled</button>
                    <button type="submit" class="btn btn-danger">Disable 2FA</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Auto-Update Confirmation Modal -->
    <div id="update-confirmation-modal" class="modal is-hidden">
        <div class="modal-background" onclick="closeUpdateConfirmationModal()"></div>
        <div class="modal-content">
            <span class="close" onclick="closeUpdateConfirmationModal()">&times;</span>
            <h3><i class="fas fa-download"></i> Confirm Automatic Update</h3>
            <div id="update-confirmation-content">
                <div style="text-align: center; padding: 2rem;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #667eea;"></i>
                    <p style="margin: 1rem 0 0 0; color: #ccc;">Loading update information...</p>
                </div>
            </div>
            <div class="form-actions" style="margin-top: 1.5rem;">
                <button type="button" id="confirm-update-button" class="btn btn-primary" onclick="confirmAutoUpdate()" disabled>
                    <i class="fas fa-download icon"></i>
                    <span>Start Update</span>
                </button>
                <button type="button" class="btn btn-secondary" onclick="closeUpdateConfirmationModal()">
                    <i class="fas fa-times icon"></i>
                    <span>Cancel</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Load admin JavaScript -->
    <script src="/admin.js?v=20250823a&cb=1755384925&mobilefinal=1" defer></script>
</body>
</html>