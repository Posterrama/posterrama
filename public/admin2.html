<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Posterrama Admin — Dashboard</title>
  <!-- PWA: basic meta + manifest so admin2 independently registers the Service Worker -->
  <meta name="theme-color" content="#1a1d29" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="mobile-web-app-capable" content="yes" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png" />
  <link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="/theme-demo.css?v=20250906-8" />
  <style>
  /* Themed dropdowns */
  select { 
    background: var(--color-bg-card);
    color: var(--color-text-primary);
    border: 1px solid var(--color-border);
    border-radius: 10px; 
    padding: 8px 36px 8px 10px; 
    outline: none; 
    font: inherit; 
    width: 100%;
    appearance: none; 
    -webkit-appearance: none; 
    -moz-appearance: none;
  }
  select:hover { border-color: var(--color-border-light); }
  select:focus { border-color: var(--color-info); box-shadow: 0 0 0 3px rgba(102,126,234,0.25); }
  /* Add chevron to non-multiple selects */
  select:not([multiple]) {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='14' height='14' viewBox='0 0 24 24' fill='none' stroke='%23A3AED0' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 10px center;
    background-size: 14px;
  }
  /* Wrapper to support leading icon for special selects */
  .select-wrap { position: relative; }
  .select-wrap .select-icon { position: absolute; left: 10px; top: 50%; transform: translateY(-50%); pointer-events: none; opacity: .9; }
  .select-wrap .select-icon i { color: var(--color-text-muted); }
  .select-wrap select { padding-left: 34px; }
  
  /* Cache edit button hover */
  .cache-edit-btn:hover {
    background: var(--color-bg-secondary) !important;
    border-color: var(--color-warning) !important;
    color: var(--color-warning) !important;
  }
  
  /* Subtle dropdown item hover */
  .dropdown-item:hover {
    background: rgba(255, 255, 255, 0.03) !important;
    border: none !important;
    box-shadow: none !important;
    transition: all 0.2s ease;
  }
  /* Custom select (for icon-in-list support) */
  .select-wrap.has-custom-select { position: relative; }
  .select-wrap.has-custom-select .select-icon { display: none; }
  .select-wrap select.enhanced { position: absolute; opacity: 0; pointer-events: none; width: 0; height: 0; }
  .custom-select { position: relative; width: 100%; }
  .custom-select-trigger { width: 100%; display: flex; align-items: center; justify-content: space-between; gap: 8px; padding: 8px 36px 8px 10px; border-radius: 10px; background: var(--color-bg-card); color: var(--color-text-primary); border: 1px solid var(--color-border); cursor: pointer; font: inherit; }
  .custom-select-trigger:hover { border-color: var(--color-border-light); }
  .custom-select-trigger:focus { outline: none; border-color: var(--color-info); box-shadow: 0 0 0 3px rgba(102,126,234,0.25); }
  .custom-select-trigger .left { display: inline-flex; align-items: center; gap: 8px; }
  .custom-select-trigger .caret { color: var(--color-text-muted); }
  .custom-options { position: fixed; z-index: 3002; margin-top: 0; background: var(--color-bg-card); border: 1px solid var(--color-border); border-radius: 10px; box-shadow: var(--shadow-lg); max-height: 260px; overflow: auto; padding: 6px; display: none; }
  /* visibility toggled via inline styles/js when appended to body */
  .custom-option { display: flex; align-items: center; gap: 10px; padding: 8px 10px; border-radius: 8px; cursor: pointer; }
  .custom-option:hover { background: var(--color-bg-tertiary); }
  .custom-option[aria-selected="true"] { background: var(--color-bg-tertiary); box-shadow: inset 3px 0 0 var(--color-info); }
  .custom-option i { color: var(--color-text-muted); }
  /* Custom select optgroup header */
  .custom-optgroup { position: sticky; top: 0; background: var(--color-bg-card); color: var(--color-text-muted); font-size: 0.78rem; letter-spacing: .02em; text-transform: none; padding: 6px 10px; margin: 4px 0 2px; opacity: .9; }
  @media (prefers-reduced-motion: no-preference) {
    .custom-options { transition: opacity .12s ease, transform .12s ease; }
    .custom-select.open .custom-options { opacity: 1; transform: translateY(0); }
  }
    /* Status tiles styling */
    .status-tiles { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 10px; }
    .status-tile { display: flex; align-items: center; justify-content: space-between; padding: 10px 12px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.03); }
    .status-tile .tile-left { display: flex; align-items: center; gap: 10px; }
    .status-tile .tile-title { font-weight: 600; opacity: 0.95; display: flex; align-items: center; gap: 8px; }
    .status-tile .tile-badge { font-size: 0.75rem; padding: 4px 10px; border-radius: 999px; background: rgba(255,255,255,0.08); text-transform: capitalize; }
    .tile-badge.status-success { background: rgba(34,197,94,0.15); color: #86efac; }
    .tile-badge.status-warning { background: rgba(245,158,11,0.15); color: #fcd34d; }
    .tile-badge.status-error { background: rgba(239,68,68,0.15); color: #fca5a5; }
  /* Theme alignment for dropdown links */
  .dropdown-menu a.dropdown-item { text-decoration: none; color: var(--color-text-primary); }
  .dropdown-menu a.dropdown-item:hover,
    .dropdown-menu a.dropdown-item:focus { text-decoration: none; }
  .dropdown-menu .dropdown-divider { height:1px; background: rgba(255,255,255,0.08); margin:6px 0; }
  
  /* Modern Dropdown Menu Styling */
  .dropdown-menu {
    position: absolute !important;
    top: calc(100% + 4px) !important; /* Reduced gap to improve hover */
    min-width: 240px !important;
    max-width: 280px !important;
    padding: 8px !important;
    margin: 0 !important;
    z-index: 2000 !important;
    display: block !important; /* Override any display: none */
    
    /* Modern glassmorphism design using theme colors */
    background: linear-gradient(135deg, 
      var(--color-bg-card) 0%,
      var(--color-bg-tertiary) 50%,
      var(--color-bg-card) 100%) !important;
    backdrop-filter: blur(20px) !important;
    -webkit-backdrop-filter: blur(20px) !important;
    
    border: 1px solid var(--color-border) !important;
    border-radius: var(--border-radius-lg) !important;
    
    box-shadow: var(--shadow-lg) !important;
    
    /* Animation */
    opacity: 0 !important;
    transform: translateY(-8px) scale(0.98) !important;
    transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1) !important;
    pointer-events: none !important;
  }
  /* Disable hover bridges; menus are click-open, JS-managed */
  #settings-menu::before,
  #user-menu::before { content: none !important; }
  /* Remove arrow/anchor notch above dropdowns */
  #settings-menu::after, #user-menu::after,
  .dropdown.dropdown-left .dropdown-menu::after,
  .dropdown.dropdown-right .dropdown-menu::after {
    content: none !important;
  }
  
  .dropdown-menu.show {
    opacity: 1 !important;
    transform: translateY(0) scale(1) !important;
    pointer-events: auto !important;
  }
  /* No CSS hover-open; JS controls visibility */

  /* Trigger buttons: modern hover/active visuals */
  .nav-actions .dropdown .btn.btn-icon {
    border: 1px solid transparent;
    border-radius: 10px;
    background: transparent;
    transition: background .2s ease, border-color .2s ease, box-shadow .2s ease, transform .12s ease;
  }
  .nav-actions .dropdown .btn.btn-icon:hover,
  .nav-actions .dropdown .btn.btn-icon:focus-visible {
    outline: none;
  }
  /* (removed empty rules for aria-expanded and icon hover to keep CSS tidy) */
  /* Minimal hover/active for settings and user buttons (slightly darker bg + dark border, no shadow) */
  #settings-btn.btn.btn-icon,
  #user-btn.btn.btn-icon {
    border: 1px solid transparent !important;
    border-radius: 10px !important;
    background: transparent !important;
    transition: background .12s ease, border-color .12s ease !important;
  }
  /* Minimal hover/active for settings and user buttons (slightly darker bg + dark border, no shadow) */
  #settings-btn.btn.btn-icon,
  #user-btn.btn.btn-icon {
    border: 1px solid transparent !important;
    border-radius: 10px !important;
    background: transparent !important;
    transition: background .12s ease, border-color .12s ease !important;
  }
  #settings-btn.btn.btn-icon:hover,
  #settings-btn.btn.btn-icon:focus-visible,
  #settings-btn.btn.btn-icon[aria-expanded="true"],
  #user-btn.btn.btn-icon:hover,
  #user-btn.btn.btn-icon:focus-visible,
  #user-btn.btn.btn-icon[aria-expanded="true"] {
    background: rgba(0,0,0,0.18) !important;
    border-color: rgba(0,0,0,0.7) !important;
    box-shadow: none !important;
  }
  #settings-btn.btn.btn-icon:hover i,
  #settings-btn.btn.btn-icon[aria-expanded="true"] i,
  #user-btn.btn.btn-icon:hover i,
  #user-btn.btn.btn-icon[aria-expanded="true"] i {
    filter: none !important;
    transform: none !important;
  }
  /* Fix: user button shouldn’t be a square when it has text; keep within navbar height */
  .nav-user .btn.btn-icon,
  #user-btn.btn.btn-icon {
    aspect-ratio: auto !important;
    height: auto !important;
    max-height: calc(var(--navbar-height) - 12px) !important;
    padding: 8px 10px !important;
    line-height: 1 !important;
    align-self: center !important;
  }
  
  /* Settings menu positioning is handled via JS to avoid viewport overflow */
  /* Limit dropdown container size to its contents (avoid oversized hitbox) */
  .nav-actions .dropdown,
  #user-dropdown.dropdown.nav-user {
    display: inline-flex !important;
    align-items: center !important;
    height: var(--navbar-height) !important;
  }
  
  /* User menu (right) positioning - MORE SPECIFIC */
  #user-dropdown #user-menu,
  #user-menu {
    right: 12px !important;
    left: auto !important;
    transform-origin: right top !important;
  }
  /* Utility classes for explicit dropdown alignment */
  .dropdown.dropdown-left .dropdown-menu {
    left: 0 !important;
    right: auto !important;
    transform-origin: left top !important;
  }
  .dropdown.dropdown-right .dropdown-menu {
    right: 0 !important;
    left: auto !important;
    transform-origin: right top !important;
  }
  .dropdown.dropdown-left .dropdown-menu::after {
    left: 22px !important;
    right: auto !important;
  }
  .dropdown.dropdown-right .dropdown-menu::after {
    right: 22px !important;
    left: auto !important;
  }
  
  /* (removed forced-left rules; JS sets left/right per available space) */
  
  /* Force user menu to right with extreme specificity */  
  body .dropdown #user-menu,
  body #user-dropdown #user-menu,
  body .dropdown-menu.dropdown-right#user-menu,
  body #user-dropdown .dropdown-menu.dropdown-right#user-menu {
  right: 0 !important;
    left: auto !important;
  margin-top: 0 !important;
    margin-right: 0 !important;
  top: calc(100% + 4px) !important; /* small gap from button */
    position: absolute !important;
  }
  
  /* Dropdown items */
  .dropdown-menu .dropdown-item {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
    padding: 12px 14px !important;
    margin: 2px 0 !important;
    border-radius: var(--border-radius-md) !important;
    color: var(--color-text-primary) !important;
    text-decoration: none !important;
    font-size: 14px !important;
    font-weight: 500 !important;
    border: 1px solid transparent !important;
    transition: all 0.15s ease !important;
    position: relative !important;
    overflow: hidden !important;
  }
  
  .dropdown-menu .dropdown-item:before {
    content: '' !important;
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: linear-gradient(135deg, 
      rgba(255, 255, 255, 0.03) 0%,
      rgba(255, 255, 255, 0.06) 50%,
      rgba(255, 255, 255, 0.03) 100%) !important;
    opacity: 0 !important;
    transition: opacity 0.15s ease !important;
    z-index: -1 !important;
  }
  
  .dropdown-menu .dropdown-item:hover:before { opacity: 0 !important; }
  
  .dropdown-menu .dropdown-item:hover {
    background: rgba(0,0,0,0.18) !important;
    border-color: rgba(0,0,0,0.7) !important;
    transform: none !important;
    box-shadow: none !important;
    transition: background .12s ease, border-color .12s ease !important;
  }
  
  .dropdown-menu .dropdown-item i {
    width: 18px !important;
    height: 18px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 14px !important;
    opacity: 0.8 !important;
    color: var(--color-text-secondary) !important;
    will-change: transform !important;
    transition: transform .12s ease, color .12s ease, opacity .12s ease !important;
  }
  
  .dropdown-menu .dropdown-item:hover i {
    opacity: 1 !important;
    color: var(--color-text-primary) !important;
    transform: translateY(-1px) scale(1.06) !important;
    transition: transform .12s ease, color .12s ease, opacity .12s ease !important;
  }
  /* Keyboard focus parity */
  .dropdown-menu .dropdown-item:focus-visible i {
    opacity: 1 !important;
    color: var(--color-text-primary) !important;
    transform: translateY(-1px) scale(1.06) !important;
  }
  /* Respect reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .dropdown-menu .dropdown-item i { transition: none !important; }
    .dropdown-menu .dropdown-item:hover i,
    .dropdown-menu .dropdown-item:focus-visible i { transform: none !important; }
  }
  /* Clean hover without accents/shadows */
  .dropdown-menu .dropdown-item:hover { box-shadow: none !important; }
  
  /* Special styling for danger items */
  .dropdown-menu .dropdown-item.text-danger:hover {
    background: rgba(239, 68, 68, 0.1) !important;
    border-color: rgba(239, 68, 68, 0.2) !important;
    color: #fca5a5 !important;
  }
  
  /* Dropdown divider */
  .dropdown-menu .dropdown-divider {
    height: 1px !important;
    background: linear-gradient(90deg, 
      transparent 0%,
      var(--color-border) 20%,
      var(--color-border-hover) 50%,
      var(--color-border) 80%,
      transparent 100%) !important;
    margin: 8px 6px !important;
    border: none !important;
  }
  
  /* Dropdown heading */
  .dropdown-menu .dropdown-heading {
    font-size: 12px !important;
    font-weight: 600 !important;
    color: var(--color-text-secondary) !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    padding: 8px 14px 4px !important;
    margin-bottom: 4px !important;
  }

  
  /* Dropdown items */
  .dropdown-menu .dropdown-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 14px;
    margin: 2px 0;
    border-radius: 12px;
    color: var(--color-text-primary);
    text-decoration: none;
    font-size: 14px;
    font-weight: 500;
    border: 1px solid transparent;
    transition: all 0.15s ease;
    position: relative;
    overflow: hidden;
  }
  
  .dropdown-menu .dropdown-item:before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, 
      rgba(255, 255, 255, 0.03) 0%,
      rgba(255, 255, 255, 0.06) 50%,
      rgba(255, 255, 255, 0.03) 100%);
    opacity: 0;
    transition: opacity 0.15s ease;
    z-index: -1;
  }
  
  /* (removed duplicate legacy hover rules to avoid conflicts) */
  
  /* Special styling for danger items */
  .dropdown-menu .dropdown-item.text-danger:hover {
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.08), rgba(239, 68, 68, 0.05));
    border-color: rgba(239, 68, 68, 0.15);
    color: #fca5a5;
    box-shadow: 0 0 20px rgba(239, 68, 68, 0.05);
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Dropdown divider */
  .dropdown-menu .dropdown-divider {
    height: 1px;
    background: linear-gradient(90deg, 
      transparent 0%,
      rgba(255, 255, 255, 0.08) 20%,
      rgba(255, 255, 255, 0.12) 50%,
      rgba(255, 255, 255, 0.08) 80%,
      transparent 100%);
    margin: 8px 6px;
    border: none;
  }
    /* Toasts – theme alignment, bottom-right placement */
  .toast-container { position: fixed; right: 16px; bottom: 16px; display: flex; flex-direction: column; gap: 8px; z-index: 3001; }
    .toast { display: flex; align-items: flex-start; gap: 10px; min-width: 260px; max-width: 360px; padding: 10px 12px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.08); background: rgba(20,20,28,0.95); color: var(--color-text-primary, #E5E7EB); box-shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.05); opacity: 0; transform: translateY(8px); transition: opacity .18s ease, transform .18s ease; }
    .toast.show { opacity: 1; transform: translateY(0); }
    .toast .toast-icon { font-size: 1rem; line-height: 1.2; }
    .toast .toast-content { flex: 1; }
    .toast .toast-title { display:block; margin-bottom: 2px; font-weight: 600; opacity: .95; }
    .toast .toast-message { font-size: .9rem; opacity: .9; }
    .toast .toast-close { background: transparent; border: none; color: inherit; font-size: 1.1rem; cursor: pointer; opacity: .7; }
    .toast .toast-close:hover { opacity: 1; }
    .toast-info { border-left: 4px solid #60a5fa; }
    .toast-success { border-left: 4px solid #34d399; }
    .toast-warning { border-left: 4px solid #f59e0b; }
    .toast-error { border-left: 4px solid #ef4444; }
    /* Button loading spinner */
    @keyframes spin { to { transform: rotate(360deg); } }
    .spinner { display:inline-block; width:14px; height:14px; border:2px solid rgba(255,255,255,0.25); border-top-color:#60a5fa; border-radius:50%; animation:spin .8s linear infinite; margin-right:6px; vertical-align:-2px; }
    .btn .spinner { display:none; }
    .btn.btn-loading .spinner { display:inline-block; }
    .btn.btn-loading i { display:none; }
    /* Prevent header shift when icon buttons show spinner */
    .panel-actions .btn.btn-icon.btn-sm {
      width: 32px;
      min-width: 32px;
      height: 32px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .panel-actions .btn.btn-icon .spinner { margin-right: 0; }
    .btn[aria-busy="true"] { cursor: progress; opacity: .85; }

  /* MODERN DASHBOARD - inspired by the screenshot */
  #panel-perf-dashboard {
    background: linear-gradient(135deg, var(--color-bg-card), var(--color-bg-tertiary)) !important;
    border: 1px solid var(--color-border) !important;
    border-radius: var(--border-radius-lg) !important;
    box-shadow: var(--shadow-md) !important;
  }
  
  #panel-perf-dashboard .panel-header {
    background: linear-gradient(135deg, var(--color-bg-tertiary), var(--color-bg-card)) !important;
    border-bottom: 1px solid var(--color-border) !important;
    border-radius: 12px 12px 0 0 !important;
    padding: 20px 24px !important;
  }
  
  #panel-perf-dashboard .panel-header h2 {
    color: var(--color-text-primary) !important;
    font-weight: 600 !important;
    font-size: 1.25rem !important;
    margin: 0 !important;
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
  }
  
  #panel-perf-dashboard .panel-header h2 i {
    color: var(--color-text-primary) !important;
  }
  
  /* Button hover effects */
  #panel-perf-dashboard button:hover {
    opacity: 0.8 !important;
    transform: translateY(-1px) !important;
    transition: all 0.2s ease !important;
  }
  
  #panel-perf-dashboard .btn-icon:hover {
    background: #e5e7eb !important;
  }
  /* Sections: visible by default; hide only when [hidden] is set */
  .app-section { display: block; }
  .app-section[hidden] { display: none !important; }
  /* Safety: ensure Plex panel content is visible */
  #panel-plex .panel-content { display: block !important; visibility: visible !important; }
  /* Consistent inner padding for Media Sources panels (Plex/Jellyfin/TMDB/TVDB) */
  #section-media-sources .panel > .panel-content { padding: 16px 20px; }
  /* Lightweight sub-section groupings inside panels */
  .form-section { margin: 14px 0 8px; }
  .form-section .section-title { display:flex; align-items:center; gap:8px; margin: 6px 0 10px; padding-left: 10px; border-left: 3px solid var(--color-border); color: var(--color-text-primary); font-size: 1rem; font-weight: 600; opacity: .95; }
  .form-section .section-title i { color: var(--color-text-secondary); }
  /* Operations panel polish (align with theme-demo) */
  /* Ensure Operations panel uses the same panel background as theme-demo */
  .operations-panel {
    background: linear-gradient(135deg, var(--color-bg-card), var(--color-bg-tertiary)) !important;
    border: 1px solid var(--color-border) !important;
    border-radius: var(--border-radius-lg) !important;
    box-shadow: var(--shadow-md) !important;
  }
  .operations-panel > .panel-header {
    background: linear-gradient(135deg, var(--color-bg-tertiary), var(--color-bg-card)) !important;
    border-bottom: 1px solid var(--color-border) !important;
  }
  /* Operations grouping */
  .ops-group { margin: 6px 0 10px; padding: 0; }
  .ops-group-title { display:flex; align-items:center; gap:8px; margin: 8px 0 10px; padding-left: 10px; border-left: 3px solid var(--color-border); color: var(--color-text-primary); font-size: 0.95rem; font-weight: 700; letter-spacing: .01em; opacity:.95; }
  .ops-group-title i { color: var(--color-text-secondary); }
  .operations-panel .actions { display:flex; flex-wrap:wrap; gap:8px; align-items:center; }
  .operations-panel .main-actions { margin-top: 8px; }
  .operations-panel .sub-actions { margin-top: 8px; }
  .operations-panel .input-row { display:flex; gap:8px; align-items:center; }
  .operations-panel .status-pill { font-size: 0.8rem; padding: 4px 10px; border-radius: 999px; background: rgba(255,255,255,0.08); }
  .operations-panel .status-pill.status-success { background: rgba(34,197,94,0.15); color: #86efac; }
  .operations-panel .status-pill.status-info { background: rgba(59,130,246,0.15); color: #93c5fd; }
  .operations-panel .status-pill.status-warning { background: rgba(251,191,36,0.15); color: #fde68a; }
  .operations-panel .status-pill.status-error { background: rgba(239,68,68,0.15); color: #fca5a5; }
  .operations-panel .card-subtext { font-size: 0.85rem; color: var(--color-text-secondary); margin: -2px 0 8px; opacity: .9; }
  /* Utilities for spacing and sizing */
  .mt-6 { margin-top: 6px !important; }
  .mt-8 { margin-top: 8px !important; }
  .nowrap { white-space: nowrap !important; }
  .w-90 { width: 90px !important; }
  .w-110 { width: 110px !important; }
  /* Operations layout */
  .operations-panel .content-grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 12px; align-items: start; }
  @media (max-width: 1200px) { .operations-panel .content-grid { grid-template-columns: 1fr; } }
  .operations-panel .ops-col { display: flex; flex-direction: column; gap: 12px; }
  /* URL chip and status line */
  .operations-panel .status-line { display:flex; align-items:center; gap:8px; margin-top:6px; }
  .operations-panel .url-chip { display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; border:1px solid rgba(255,255,255,0.12); background: rgba(255,255,255,0.04); color: inherit; text-decoration: none; }
  .operations-panel .url-chip:hover { border-color: rgba(96,165,250,0.45); box-shadow: inset 0 1px 0 rgba(255,255,255,0.06); }
  /* Operations cards (theme aligned) */
  .operations-panel .perf-card { position: relative; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.08); border-radius: 14px; padding: 12px 14px; box-shadow: 0 6px 20px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.04); }
  .operations-panel .perf-card h3 { margin: 0 0 10px 0; font-size: 0.95rem; opacity: 0.9; display: flex; align-items: center; gap: 8px; }
  .operations-panel .metric-row { display: flex; flex-direction: column; gap: 10px; }
  /* Small, muted inline hints */
  .operations-panel .micro-hint { display: inline-flex; align-items: center; gap: 6px; font-size: 0.78rem; color: var(--color-text-secondary); opacity: 0.7; margin-top: 4px; }
  .operations-panel .micro-hint i { font-size: 0.8em; color: var(--color-text-secondary); opacity: 0.6; }
  /* Top-right pill placement inside cards */
  .operations-panel .card-pill-spot { position: absolute; top: 10px; right: 12px; display: flex; gap: 6px; }
  /* API key field styling */
  .operations-panel #api-key-input { flex: 1; min-width: 220px; background: var(--color-bg-card); color: var(--color-text-primary); border: 1px solid var(--color-border); border-radius: 10px; padding: 8px 12px; outline: none; }
  .operations-panel #api-key-input:focus { border-color: var(--color-info); box-shadow: 0 0 0 3px rgba(102,126,234,0.25); }
  /* Inline field styling for label + input rows */
  .operations-panel .inline-field { display: flex; align-items: center; gap: 12px; justify-content: flex-start; flex-wrap: nowrap; }
  .operations-panel .inline-field label {
    display: inline-flex; align-items: center; margin: 0; line-height: 1.2; white-space: nowrap; width: auto;
  }
  .operations-panel .inline-field input,
  .operations-panel .inline-field select {
    flex: 0 0 auto;
  }
  /* removed number input left padding per UX request */
  /* Update progress bar */
  .meter { height: 8px; border-radius: 999px; background: rgba(255,255,255,0.06); overflow: hidden; }
  .meter > div { height: 100%; width: 0; background: linear-gradient(90deg, #60a5fa, #2563eb); transition: width .2s ease; }
  /* Backups list styling */
  #backups-display { border-top: 1px dashed rgba(255,255,255,0.08); padding-top: 10px; }
  #backups-content { display: grid; gap: 8px; }
  #backups-content .backup-item { display:flex; justify-content:space-between; align-items:center; padding:8px 10px; border:1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.02); border-radius:10px; }
  /* Operations panel – compact layout */
  /* Match inner card backgrounds to theme across panels */
  .operations-panel .perf-card {
    background: linear-gradient(135deg, var(--color-bg-card), var(--color-bg-tertiary));
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 14px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.04);
  }
  .operations-panel .perf-card { position: relative; background: linear-gradient(135deg, var(--color-bg-card), var(--color-bg-tertiary)); border: 1px solid rgba(255,255,255,0.08); border-radius: 14px; padding: 12px 14px; box-shadow: 0 6px 20px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.04); }
  /* Utility */
  .is-hidden { display: none !important; }

  /* Subheader inside panels (e.g., Streaming Releases under TMDB) */
  .panel-header.panel-sub {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    padding: 8px 0;
    margin: 8px 0;
    border-top: 1px dashed rgba(255,255,255,0.08);
    border-bottom: 1px dashed rgba(255,255,255,0.08);
  }
  .panel-header.panel-sub h3 {
    margin: 0;
    font-size: 1rem;
    font-weight: 600;
    opacity: .92;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  /* (clean) visibility uses [hidden] default styles in theme */
  /* Panel loading overlay (prevents default-value flash) */
  .panel .panel-content { position: relative; }
  /* Subpanel styling (used inside TMDB for Streaming Releases) */
  .subpanel { border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; padding: 10px 12px; background: rgba(255,255,255,0.02); box-shadow: inset 0 1px 0 rgba(255,255,255,0.04); }
  .subpanel + .subpanel { margin-top: 10px; }
  /* Streaming Releases should match themed panel background */
  #subpanel-streaming { background: linear-gradient(135deg, var(--color-bg-card), var(--color-bg-tertiary)); }
  .subpanel-header { display:flex; align-items:center; justify-content:space-between; gap:10px; margin: -2px 0 8px; }
  .subpanel-header h3 { margin:0; font-size: 1rem; display:flex; align-items:center; gap:8px; opacity:.95; }
  .subpanel-body .subtle { opacity:.8; margin-bottom: 8px; }
  .loading-overlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; z-index: 2; opacity: 0; pointer-events: none; transition: opacity .18s ease; }
  .loading-overlay .glass { position: absolute; inset: 0; background: transparent; backdrop-filter: blur(6px); -webkit-backdrop-filter: blur(6px); border-radius: 12px; }
  .loading-overlay .loader { position: relative; display: flex; align-items: center; justify-content: center; padding: 0; border: 0; background: transparent; box-shadow: none; color: var(--color-text-primary); }
  .loading-overlay .loader .spinner { margin: 0; width: 20px; height: 20px; border-width: 2px; filter: drop-shadow(0 0 10px rgba(96,165,250,0.35)); }
  .panel.is-loading .loading-overlay { opacity: 1; pointer-events: auto; }
  /* Blur/dim content while loading, then fade to sharp */
  .panel .panel-content > *:not(.loading-overlay) { opacity: 1; transform: none; filter: none; transition: opacity .18s ease, transform .18s ease, filter .18s ease; }
  .panel.is-loading .panel-content > *:not(.loading-overlay) { opacity: 1; filter: blur(4px); }
  @media (prefers-reduced-motion: reduce) {
    .loading-overlay,
    .panel .panel-content > *:not(.loading-overlay) {
      transition: none !important;
    }
  }

  /* Media Sources header with elegant subtitle */
  #panel-sources-overview > .panel-header { 
    display: flex; 
    align-items: flex-start; 
    justify-content: space-between; 
    gap: 12px; 
  }
  #panel-sources-overview .panel-title { display: flex; flex-direction: column; gap: 4px; }
  #panel-sources-overview .panel-title h2 { 
    margin: 0; 
    display: flex; 
    align-items: center; 
    gap: 10px; 
    line-height: 1.2; 
  }
  #panel-sources-overview .panel-title h2 i { color: inherit; }
  /* Generic subtitle style for panel headers (used by Media Sources and Operations) */
  .panel-header .panel-subtitle {
    font-size: 0.95rem;
    color: var(--color-text-secondary);
    opacity: 0.9;
    max-width: 70ch;
    margin-top: 2px;
  }
  
  /* Media Sources Help Cards */
  .card-description {
    font-size: 0.9rem;
    opacity: 0.8;
    margin-bottom: 12px;
  }
  .card-features {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  .card-features li {
    font-size: 0.85rem;
    opacity: 0.9;
    margin-bottom: 6px;
    padding-left: 12px;
    position: relative;
  }
  .card-features li:before {
    content: "•";
    color: rgba(255,255,255,0.6);
    position: absolute;
    left: 0;
  }
  .card-steps {
    margin-top: 8px;
  }
  .card-steps .step {
    font-size: 0.85rem;
    opacity: 0.9;
    margin-bottom: 6px;
    padding-left: 0;
  }
  .card-tips {
    margin-top: 8px;
  }
  .card-tips .tip {
    font-size: 0.85rem;
    opacity: 0.9;
    margin-bottom: 8px;
    line-height: 1.4;
  }

  /* Force correct icon colors for Media Sources cards */
  #section-media-sources .status-card.status-info .card-icon i {
    color: var(--color-info) !important;
  }
  #section-media-sources .status-card.status-success .card-icon i {
    color: var(--color-success) !important;
  }
  #section-media-sources .status-card.status-warning .card-icon i {
    color: var(--color-warning) !important;
  }
  #section-media-sources .status-card.status-error .card-icon i {
    color: var(--color-error) !important;
  }
  #section-media-sources .status-card.status-primary .card-icon i {
    color: var(--color-primary) !important;
  }
  #section-media-sources .status-card.status-secondary .card-icon i {
    color: var(--color-secondary) !important;
  }
  #section-media-sources .status-card.status-accent .card-icon i {
    color: var(--color-accent) !important;
  }

  /* Border-left colors for all status types */
  #section-media-sources .status-card.status-primary {
    border-left-color: var(--color-primary) !important;
  }
  #section-media-sources .status-card.status-secondary {
    border-left-color: var(--color-secondary) !important;
  }
  #section-media-sources .status-card.status-accent {
    border-left-color: var(--color-accent) !important;
  }
  #section-media-sources .status-card.status-error {
    border-left-color: var(--color-error) !important;
  }

  /* Media Sources – Modern overview cards */
  #section-media-sources .source-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 18px;
  }
  /* At larger widths, prefer a clean 3-column layout */
  @media (min-width: 1200px) {
    #section-media-sources .source-grid {
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 20px;
    }
  }
  #section-media-sources .source-card {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    padding: 18px 20px;
    box-shadow: var(--shadow-md);
    transition: transform .16s ease, box-shadow .16s ease, border-color .16s ease;
  }
  /* Help tile accent + ensure last position */
  #section-media-sources .source-grid .source-card.help-card { 
    order: 999; /* pin to end */
    border-left: 3px solid var(--color-warning);
    background: linear-gradient(180deg, var(--color-bg-card), rgba(255,255,255,0.02));
  }
  #section-media-sources .source-grid .source-card.help-card .sc-icon i { color: var(--color-warning); }
  #section-media-sources .source-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
    border-color: rgba(255,255,255,0.16);
  }
  /* Make Help & Tips as wide as two cards when layout supports >=2 columns */
  @media (min-width: 680px) {
    #section-media-sources .source-grid .source-card.help-card { grid-column: span 2; }
  }
  /* Overview status row */
  #section-media-sources .sc-status { display:flex; align-items:center; gap:10px; margin: 10px 0 8px; }
  #section-media-sources .sc-status .status-dot { width: 8px; height: 8px; border-radius: 50%; display:inline-block; }
  #section-media-sources .sc-status .status-dot.status-success { background: #34d399; box-shadow: 0 0 0 0 rgba(52,211,153,.6); }
  #section-media-sources .sc-status .status-dot.status-warning { background: #f59e0b; box-shadow: 0 0 0 0 rgba(245,158,11,.6); }
  #section-media-sources .sc-status .status-dot.status-error { background: #ef4444; box-shadow: 0 0 0 0 rgba(239,68,68,.6); }
  @media (prefers-reduced-motion: no-preference) {
    #section-media-sources .sc-status .status-dot { animation: pulse-dot 2.2s ease-out infinite; }
  }
  @keyframes pulse-dot { 0%{ box-shadow: 0 0 0 0 rgba(255,255,255,.0);} 70%{ box-shadow: 0 0 0 6px rgba(255,255,255,.05);} 100%{ box-shadow: 0 0 0 0 rgba(255,255,255,.0);} }
  #section-media-sources .sc-status .status-pill { font-size:.75rem; padding: 3px 10px; border-radius:999px; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.1); }
  #section-media-sources .sc-status .header-toggle { margin-left:auto; }
  #section-media-sources .sc-meta { display:flex; align-items:center; gap:10px; font-size:.85rem; color: var(--color-text-secondary); margin: 6px 0 12px; }
  #section-media-sources .sc-meta .sep { opacity:.5; }
  #section-media-sources .sc-header { display:flex; align-items:center; gap:14px; margin-bottom: 10px; }
  #section-media-sources .sc-icon {
    width: 36px; height: 36px; border-radius: 50%; display:flex; align-items:center; justify-content:center;
    background: var(--color-bg-secondary);
  }
  #section-media-sources .sc-title { font-size: 1.05rem; font-weight: 600; color: var(--color-text-primary); }
  #section-media-sources .sc-desc { font-size: .9rem; color: var(--color-text-secondary); margin: 0 0 10px; }
  #section-media-sources .sc-points { list-style:none; margin:0 0 12px; padding:0; }
  #section-media-sources .sc-points li { font-size: .85rem; color: var(--color-text-primary); opacity:.9; margin: 4px 0; padding-left: 14px; position: relative; }
  #section-media-sources .sc-points li:before { content: "•"; position:absolute; left:0; color: rgba(255,255,255,0.6); }
  #section-media-sources .sc-actions { display:flex; gap: 10px; align-items:center; }
  #section-media-sources .btn-ghost { background: var(--color-bg-tertiary); border: 1px solid var(--color-border); color: var(--color-text-secondary); }
  /* Help card styles */
  #section-media-sources .help-card .help-group { margin-top: 8px; }
  #section-media-sources .help-card .help-title { font-size: .9rem; font-weight: 600; color: var(--color-text-primary); margin: 6px 0 4px; }
  #section-media-sources .help-card .help-steps { margin: 0; padding-left: 18px; color: var(--color-text-secondary); }
  #section-media-sources .help-card .help-steps li { margin: 2px 0; line-height: 1.35; }
  #section-media-sources .help-card .help-list { list-style: disc; margin: 0; padding-left: 18px; color: var(--color-text-secondary); }
  #section-media-sources .help-card .help-list li { margin: 2px 0; line-height: 1.35; }
  /* Side-by-side layout inside Help card */
  #section-media-sources .help-card .help-columns { display: grid; grid-template-columns: 1fr; gap: 12px; }
  @media (min-width: 680px) {
    #section-media-sources .help-card .help-columns { grid-template-columns: 1fr 1fr; }
  }
  
  </style>
</head>
<body>
  <!-- Top navbar -->
  <nav class="navbar">
    <div class="nav-brand">
      <button class="btn btn-icon mobile-only" id="mobile-nav-toggle" aria-label="Toggle navigation" aria-expanded="false">
        <i class="fas fa-bars"></i>
      </button>
      <span>Posterrama</span>
  <span class="version" id="app-version" title="Current version" style="margin-left:8px;">—</span>
  <span class="nav-badge" id="update-available-pill" hidden title="" style="margin-left:6px;">Update available</span>
    </div>
    <div class="nav-actions">
      <button class="btn btn-icon" id="notif-btn" title="Notifications">
        <i class="fas fa-bell"></i>
        <span class="badge" id="notif-count" hidden>0</span>
      </button>
  <div class="dropdown" id="settings-dropdown">
        <button class="btn btn-icon dropdown-toggle" id="settings-btn" title="Settings" aria-haspopup="true" aria-expanded="false" aria-controls="settings-menu">
          <i class="fas fa-cog"></i>
        </button>
        <div class="dropdown-menu" id="settings-menu" role="menu" aria-hidden="true">
          <div class="dropdown-heading">Quick links</div>
          <a class="dropdown-item" href="/" target="_blank" rel="noopener" title="Open Posterrama in a new tab">
            <i class="fas fa-external-link-alt"></i>
            <span>View Posterrama</span>
          </a>
          
          <a class="dropdown-item" href="/api-docs" target="_blank" rel="noopener">
            <i class="fas fa-book"></i>
            <span>API Docs</span>
          </a>
          <a class="dropdown-item" href="https://github.com/Posterrama/posterrama" target="_blank" rel="noopener">
            <i class="fab fa-github"></i>
            <span>GitHub Repository</span>
          </a>
          <a class="dropdown-item" href="https://github.com/Posterrama/posterrama/issues/new/choose" target="_blank" rel="noopener">
            <i class="fas fa-bug"></i>
            <span>Report an Issue</span>
          </a>
          <div class="dropdown-divider"></div>
          <div class="dropdown-heading">Server</div>
          <a class="dropdown-item" href="#" id="menu-restart">
            <i class="fas fa-rotate"></i>
            <span>Restart Posterrama</span>
          </a>
        </div>
      </div>
      <div class="dropdown nav-user" id="user-dropdown">
        <button class="btn btn-icon dropdown-toggle" id="user-btn" title="Account" aria-haspopup="true" aria-expanded="false" aria-controls="user-menu">
          <i class="fas fa-user-circle"></i>
          <span>Admin</span>
        </button>
        <div class="dropdown-menu dropdown-right" id="user-menu" role="menu" aria-hidden="true">
          <div class="dropdown-heading">Account</div>
          <a class="dropdown-item" href="#" id="user-change-password">
            <i class="fas fa-key"></i>
            <span>Change Password</span>
          </a>
          <a class="dropdown-item" href="#" id="user-two-fa">
            <i class="fas fa-user-lock"></i>
            <span>Two‑Factor</span>
          </a>
          <a class="dropdown-item" href="#" id="user-profile-photo">
            <i class="fas fa-image"></i>
            <span>Profile Photo</span>
          </a>
          <div class="dropdown-divider"></div>
          <a class="dropdown-item" href="/admin/logout" id="user-logout">
            <i class="fas fa-sign-out-alt"></i>
            <span>Logout</span>
          </a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Sidebar -->
  <aside class="sidebar">
    <nav class="sidebar-nav">
      <a href="#" class="nav-item active" data-nav="dashboard">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
      </a>
      <a href="#" class="nav-item" data-nav="display">
        <i class="fas fa-desktop"></i>
        <span>Display Settings</span>
      </a>
      <div class="nav-group">
        <a href="#" class="nav-item nav-toggle">
          <i class="fas fa-server"></i>
          <span>Media Sources</span>
          <i class="fas fa-chevron-down nav-arrow"></i>
        </a>
        <div class="nav-submenu">
          <a href="#" class="nav-subitem" data-sub="plex"><i class="fas fa-film"></i><span>Plex</span></a>
          <a href="#" class="nav-subitem" data-sub="jellyfin"><i class="fas fa-play"></i><span>Jellyfin</span></a>
          <a href="#" class="nav-subitem" data-sub="tmdb"><i class="fas fa-database"></i><span>TMDB</span></a>
          <a href="#" class="nav-subitem" data-sub="tvdb"><i class="fas fa-tv"></i><span>TVDB</span></a>
        </div>
      </div>
      <a href="#" class="nav-item" data-nav="devices">
        <i class="fas fa-laptop"></i>
        <span class="nav-text-with-badge">
          Device Management
          <span class="nav-badge">BETA</span>
        </span>
      </a>
      <a href="#" class="nav-item" data-nav="operations"><i class="fas fa-screwdriver-wrench"></i><span>Operations</span></a>
    </nav>
  <div class="sidebar-footer"></div>
  </aside>

  <div class="sidebar-overlay" id="sidebar-overlay" hidden></div>

  <!-- Main content -->
  <main class="main-content">
    <header class="page-header">
      <div class="page-title">
  <h1><i class="fas fa-gauge-high"></i> Dashboard</h1>
  <p>Devices, media, and health at a glance</p>
      </div>
      <div class="page-actions">
        <span class="header-pill" id="perf-activity" title="Overall system activity (CPU and memory)">
          <i class="fas fa-wave-square"></i>
          <span class="label">Activity</span>
          <span class="value">—</span>
        </span>
      </div>
    </header>

  <!-- Dashboard Section -->
  <section id="section-dashboard" class="app-section active">
  <!-- KPI cards -->
  <section class="card-grid" id="kpi-cards">
      <div class="status-card status-success" title="Devices that are Online or Live">
        <div class="card-icon"><i class="fas fa-check-circle"></i></div>
        <div class="card-content">
          <h3>Active Devices</h3>
          <span class="metric" id="metric-active-devices">—</span>
          <span class="trend" id="metric-active-trend"></span>
        </div>
      </div>
      <div class="status-card status-info" title="Total media items across connected sources">
        <div class="card-icon"><i class="fas fa-images"></i></div>
        <div class="card-content">
          <h3>Media Items</h3>
          <span class="metric" id="metric-media-items">—</span>
          <span class="trend" id="metric-media-sub">from sources</span>
        </div>
      </div>
      <div class="status-card status-warning" title="Open warnings and recent errors">
        <div class="card-icon"><i class="fas fa-exclamation-triangle"></i></div>
        <div class="card-content">
          <h3>Warnings</h3>
          <span class="metric" id="metric-warnings">—</span>
          <span class="trend" id="metric-warn-sub"></span>
        </div>
      </div>
      <div class="status-card status-error" title="Devices currently Offline">
        <div class="card-icon"><i class="fas fa-times-circle"></i></div>
        <div class="card-content">
          <h3>Offline Devices</h3>
          <span class="metric" id="metric-offline-devices">—</span>
          <span class="trend negative" id="metric-offline-sub">needs attention</span>
        </div>
      </div>
    </section>

    
    

  <section class="content-grid" style="margin-top: 16px;">
      <!-- Unified System Performance Dashboard -->
      <section class="panel" id="panel-perf-dashboard" style="background: var(--color-bg-card); border: 1px solid var(--color-border); border-radius: 12px; box-shadow: var(--shadow-md);">
        <header class="panel-header" style="background: var(--color-bg-card); border-bottom: 1px solid var(--color-border); border-radius: 12px 12px 0 0; padding: 20px 24px; display: flex; justify-content: space-between; align-items: center;">
          <h2 style="color: var(--color-text-primary); font-size: 1.25rem; font-weight: 600; margin: 0; display: flex; align-items: center; gap: 12px;"><i class="fas fa-gauge-high" style="color: var(--color-accent);"></i> System Performance</h2>
          
          <!-- Status pills in header -->
          <div style="display: flex; gap: 16px; align-items: center;">
            <span class="header-pill status-success" id="perf-app-status" title="Application server status">
              <i class="fas fa-rocket"></i>
              <span class="label">Application</span>
              <span class="value">Running</span>
            </span>
            <span class="header-pill" id="perf-db-status" title="Database connection status" style="background: rgba(59, 130, 246, 0.15); color: #93c5fd; border-color: rgba(59, 130, 246, 0.25);">
              <i class="fas fa-server"></i>
              <span class="label">Database</span>
              <span class="value">Connected</span>
            </span>
            <span class="header-pill status-warning" id="perf-cache-status" title="Cache system status">
              <i class="fas fa-bolt"></i>
              <span class="label">Cache</span>
              <span class="value">Active</span>
            </span>
            <!-- Uptime moved here as a pill only -->
            <span class="header-pill" id="perf-uptime-pill" title="Server uptime">
              <i class="fas fa-clock"></i>
              <span class="label">Uptime</span>
              <span class="value" id="perf-uptime">—</span>
            </span>
          </div>
        </header>
        <div class="panel-content" style="padding: 24px;">
          
          <!-- Resource usage cards -->
          <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
            
            <!-- Resources card -->
            <div style="background: var(--color-bg-card); border-radius: 12px; padding: 24px; box-shadow: var(--shadow-md); border: 1px solid var(--color-border);">
              <h3 style="margin: 0 0 20px 0; font-size: 1.1rem; font-weight: 600; color: var(--color-text-primary); display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-microchip" style="color: var(--color-info);"></i>
                System Resources
              </h3>
              
              <div style="display: grid; gap: 20px;">
                <!-- CPU -->
                <div>
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <span style="font-size: 0.9rem; color: var(--color-text-secondary); font-weight: 500;">CPU Usage</span>
                    <span style="font-size: 0.9rem; font-weight: 600; color: var(--color-text-primary);" id="perf-cpu">—</span>
                  </div>
                  <div style="width: 100%; height: 8px; background: var(--color-bg-secondary); border-radius: 4px; overflow: hidden;">
                    <div style="height: 100%; background: linear-gradient(90deg, var(--color-info), var(--color-info-dark)); border-radius: 4px; transition: width 0.6s ease; width: 0%;" id="meter-cpu"></div>
                  </div>
                </div>
                
                <!-- Memory -->
                <div>
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <span style="font-size: 0.9rem; color: var(--color-text-secondary); font-weight: 500;">Memory Usage</span>
                    <span style="font-size: 0.9rem; font-weight: 600; color: var(--color-text-primary);" id="perf-mem">—</span>
                  </div>
                  <div style="width: 100%; height: 8px; background: var(--color-bg-secondary); border-radius: 4px; overflow: hidden;">
                    <div style="height: 100%; background: linear-gradient(90deg, var(--color-success), var(--color-success-dark)); border-radius: 4px; transition: width 0.6s ease; width: 0%;" id="meter-mem"></div>
                  </div>
                </div>

                <!-- Disk Usage: full-width bar like CPU/Memory -->
                <div>
                  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <span style="font-size: 0.9rem; color: var(--color-text-secondary); font-weight: 500;">Disk Usage</span>
                    <span style="font-size: 0.9rem; font-weight: 600; color: var(--color-text-primary);" id="perf-disk">—</span>
                  </div>
                  <div style="width: 100%; height: 8px; background: var(--color-bg-secondary); border-radius: 4px; overflow: hidden;">
                    <div style="height: 100%; background: linear-gradient(90deg, var(--color-info), var(--color-info-dark)); border-radius: 4px; transition: width 0.6s ease; width: 0%;" id="meter-disk"></div>
                  </div>
                </div>

                <!-- Load Average under Disk Usage -->
                <div id="perf-loadavg-container" style="margin-top: 8px;">
                  <div style="display: flex; align-items: center; justify-content: space-between; gap: 12px; margin-bottom: 4px;">
                    <div style="display: flex; align-items: center; gap: 8px; color: var(--color-text-secondary);">
                      <i class="fas fa-chart-line" style="color: var(--color-info);"></i>
                      <span style="font-size: 0.9rem; font-weight: 500;">Load Average</span>
                    </div>
                    <div style="display: flex; gap: 8px; align-items: center;">
                      <span style="background: var(--color-bg-tertiary); border: 1px solid var(--color-border); color: var(--color-text-primary); padding: 4px 10px; border-radius: 9999px; font-size: 0.85rem; font-weight: 600;" id="perf-loadavg-1">—</span>
                      <span style="background: var(--color-bg-tertiary); border: 1px solid var(--color-border); color: var(--color-text-primary); padding: 4px 10px; border-radius: 9999px; font-size: 0.85rem; font-weight: 600;" id="perf-loadavg-5">—</span>
                      <span style="background: var(--color-bg-tertiary); border: 1px solid var(--color-border); color: var(--color-text-primary); padding: 4px 10px; border-radius: 9999px; font-size: 0.85rem; font-weight: 600;" id="perf-loadavg-15">—</span>
                    </div>
                  </div>
                  <div style="display: flex; align-items: center; justify-content: flex-end;">
                    <span style="font-size: 0.75rem; color: var(--color-text-secondary);">1min • 5min • 15min averages</span>
                  </div>
                </div>
                
              </div>
            </div>

            <!-- Cache management card -->
            <div style="background: var(--color-bg-card); border-radius: 12px; padding: 24px; box-shadow: var(--shadow-md); border: 1px solid var(--color-border);">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0; font-size: 1.1rem; font-weight: 600; color: var(--color-text-primary); display: flex; align-items: center; gap: 8px;">
                  <i class="fas fa-database" style="color: var(--color-warning);"></i>
                  Cache
                </h3>
                <button type="button" class="btn btn-icon btn-sm cache-edit-btn" id="btn-edit-cache-size" style="background: var(--color-bg-tertiary); border: 1px solid var(--color-border); color: var(--color-text-secondary); padding: 8px; border-radius: 6px; font-size: 0.8rem; transition: all 0.2s ease;">
                  <i class="fas fa-pen"></i>
                </button>
              </div>
              
              <!-- Storage usage -->
              <div style="margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                  <span style="font-size: 0.85rem; color: var(--color-text-secondary);">Storage</span>
                  <span style="font-size: 0.85rem; font-weight: 600; color: var(--color-text-primary);" id="cache-disk-usage">Loading…</span>
                </div>
                <div style="width: 100%; height: 6px; background: var(--color-bg-secondary); border-radius: 3px; overflow: hidden;">
                  <div style="height: 100%; background: linear-gradient(90deg, var(--color-warning), var(--color-warning-dark)); border-radius: 3px; transition: width 0.6s ease; width: 0%;" id="meter-image-cache"></div>
                </div>
              </div>
              
              <!-- Memory items -->
              <div style="margin-bottom: 24px;">
                <div style="font-size: 0.85rem; color: var(--color-text-secondary); margin-bottom: 4px;">Memory Items</div>
                <div style="font-size: 1.2rem; font-weight: 600; color: var(--color-text-primary);" id="cache-item-count">Loading…</div>
              </div>
              
              <!-- Actions -->
              <div style="display: flex !important; flex-direction: row !important; gap: 8px !important;">
                <button type="button" id="cleanup-cache-button" style="flex: 1; padding: 10px 16px; background: var(--color-bg-tertiary); border: 1px solid var(--color-border); border-radius: 8px; font-size: 0.85rem; font-weight: 500; color: var(--color-text-primary); display: flex; align-items: center; justify-content: center; gap: 8px;">
                  <i class="fas fa-compress-alt"></i>
                  <span>Run Cleanup</span>
                </button>
                <button type="button" id="clear-cache-button" style="flex: 1; padding: 10px 16px; background: var(--color-error); border: 1px solid var(--color-error); border-radius: 8px; font-size: 0.85rem; font-weight: 500; color: white; display: flex; align-items: center; justify-content: center; gap: 8px;">
                  <i class="fas fa-broom"></i>
                  <span>Clear Cache</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </section>
    </section> <!-- /section-dashboard -->

    <!-- Media Sources Section (top-level sibling, not nested under dashboard) -->
    <section id="section-media-sources" class="app-section" hidden>
      <section class="panel" id="panel-sources-overview">
        <header class="panel-header">
          <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:10px; width:100%;">
            <div class="panel-title">
              <h2><i class="fas fa-database"></i> Media Sources</h2>
              <div class="panel-subtitle">Combine media across platforms into a unified poster gallery</div>
            </div>
            <div class="panel-actions"></div>
          </div>
        </header>
        <div class="panel-content">
          <div class="help-content">

            <!-- Sources Overview: modern, calm cards -->
            <section class="source-grid" style="margin-bottom: 24px;">
              <!-- Plex Card -->
              <div class="source-card">
                <div class="sc-header">
                  <div class="sc-icon"><i class="fas fa-film" style="color: var(--color-primary);"></i></div>
                  <div class="sc-title">Plex Media Server</div>
                </div>
                <div class="sc-status" id="sc-plex-status">
                  <span class="status-dot" id="sc-plex-dot"></span>
                  <span class="status-pill" id="sc-plex-pill">—</span>
                  <label class="header-toggle" for="sc.plex.enabled" title="Enable Plex">
                    <input type="checkbox" id="sc.plex.enabled" />
                    <span class="ht-switch" aria-hidden="true"></span>
                    <span class="ht-text">Enabled</span>
                  </label>
                </div>
                <div class="sc-meta">
                  <span id="sc-plex-sync">Last sync: —</span>
                  <span class="sep">•</span>
                  <span id="sc-plex-libs">Libraries: —</span>
                  <span class="sep">•</span>
                  <span id="sc-plex-count" title="Items after current filters">Items: —</span>
                </div>
                <p class="sc-desc">Your personal media hub with rich library management.</p>
                <ul class="sc-points">
                  <li>Select movie/TV libraries</li>
                  <li>Apply quality and genre filters</li>
                  <li>Sync collections in real-time</li>
                </ul>
                <div class="sc-actions">
                  <a class="btn btn-primary btn-sm" href="#plex"><i class="fas fa-sliders-h"></i> <span>Configure</span></a>
                  <a class="btn btn-sm btn-ghost" href="https://support.plex.tv/" target="_blank" rel="noopener"><i class="fas fa-book"></i> <span>Docs</span></a>
                </div>
              </div>

              <!-- Jellyfin Card -->
              <div class="source-card">
                <div class="sc-header">
                  <div class="sc-icon"><i class="fas fa-play" style="color: var(--color-accent);"></i></div>
                  <div class="sc-title">Jellyfin Server</div>
                </div>
                <div class="sc-status" id="sc-jf-status">
                  <span class="status-dot" id="sc-jf-dot"></span>
                  <span class="status-pill" id="sc-jf-pill">—</span>
                  <label class="header-toggle" for="sc.jf.enabled" title="Enable Jellyfin">
                    <input type="checkbox" id="sc.jf.enabled" />
                    <span class="ht-switch" aria-hidden="true"></span>
                    <span class="ht-text">Enabled</span>
                  </label>
                </div>
                <div class="sc-meta">
                  <span id="sc-jf-sync">Last sync: —</span>
                  <span class="sep">•</span>
                  <span id="sc-jf-libs">Libraries: —</span>
                  <span class="sep">•</span>
                  <span id="sc-jf-count" title="Items after current filters">Items: —</span>
                </div>
                <p class="sc-desc">Open-source media system with flexible organization.</p>
                <ul class="sc-points">
                  <li>Connect and authenticate server</li>
                  <li>Choose available libraries</li>
                  <li>Organize with genres and metadata</li>
                </ul>
                <div class="sc-actions">
                  <a class="btn btn-primary btn-sm" href="#jellyfin"><i class="fas fa-sliders-h"></i> <span>Configure</span></a>
                  <a class="btn btn-sm btn-ghost" href="https://jellyfin.org/docs/" target="_blank" rel="noopener"><i class="fas fa-book"></i> <span>Docs</span></a>
                </div>
              </div>

              <!-- TMDB Card -->
              <div class="source-card">
                <div class="sc-header">
                  <div class="sc-icon"><i class="fas fa-database" style="color: var(--color-success);"></i></div>
                  <div class="sc-title">The Movie Database (TMDB)</div>
                </div>
                <div class="sc-status" id="sc-tmdb-status">
                  <span class="status-dot" id="sc-tmdb-dot"></span>
                  <span class="status-pill" id="sc-tmdb-pill">—</span>
                  <label class="header-toggle" for="sc.tmdb.enabled" title="Enable TMDB">
                    <input type="checkbox" id="sc.tmdb.enabled" />
                    <span class="ht-switch" aria-hidden="true"></span>
                    <span class="ht-text">Enabled</span>
                  </label>
                </div>
                <div class="sc-meta">
                  <span id="sc-tmdb-sync">Last fetch: —</span>
                  <span class="sep">•</span>
                  <span id="sc-tmdb-mode">Category: —</span>
                  <span class="sep">•</span>
                  <span id="sc-tmdb-count" title="Items from TMDB in current playlist">Items: —</span>
                </div>
                <p class="sc-desc">Comprehensive movie metadata and discovery features.</p>
                <ul class="sc-points">
                  <li>API key for higher rate limits</li>
                  <li>Multi-language metadata</li>
                  <li>Trending and discovery endpoints</li>
                </ul>
                <div class="sc-actions">
                  <a class="btn btn-primary btn-sm" href="#tmdb"><i class="fas fa-sliders-h"></i> <span>Configure</span></a>
                  <a class="btn btn-sm btn-ghost" href="https://developer.themoviedb.org/" target="_blank" rel="noopener"><i class="fas fa-book"></i> <span>Docs</span></a>
                </div>
              </div>

              <!-- TVDB Card -->
              <div class="source-card">
                <div class="sc-header">
                  <div class="sc-icon"><i class="fas fa-tv" style="color: var(--color-info);"></i></div>
                  <div class="sc-title">TheTVDB</div>
                </div>
                <div class="sc-status" id="sc-tvdb-status">
                  <span class="status-dot" id="sc-tvdb-dot"></span>
                  <span class="status-pill" id="sc-tvdb-pill">—</span>
                  <label class="header-toggle" for="sc.tvdb.enabled" title="Enable TVDB">
                    <input type="checkbox" id="sc.tvdb.enabled" />
                    <span class="ht-switch" aria-hidden="true"></span>
                    <span class="ht-text">Enabled</span>
                  </label>
                </div>
                <div class="sc-meta">
                  <span id="sc-tvdb-sync">Last fetch: —</span>
                  <span class="sep">•</span>
                  <span id="sc-tvdb-count" title="Items from TVDB in current playlist">Items: —</span>
                </div>
                <p class="sc-desc">Detailed series and episode metadata with artwork.</p>
                <ul class="sc-points">
                  <li>Series, seasons, and episodes</li>
                  <li>Artwork and thumbnails</li>
                  <li>Multi-language support</li>
                </ul>
                <div class="sc-actions">
                  <a class="btn btn-primary btn-sm" href="#tvdb"><i class="fas fa-sliders-h"></i> <span>Configure</span></a>
                  <a class="btn btn-sm btn-ghost" href="https://thetvdb.com/" target="_blank" rel="noopener"><i class="fas fa-book"></i> <span>Docs</span></a>
                </div>
              </div>

              <!-- Help & Tips Card (merged Getting Started + Pro Tips) – pinned last with accent -->
              <div class="source-card help-card" id="help-tips-tile">
                <div class="sc-header">
                  <div class="sc-icon"><i class="fas fa-circle-question"></i></div>
                  <div class="sc-title">Help & Tips</div>
                </div>
                <p class="sc-desc">Quick start and best practices for configuring sources.</p>
                <div class="help-columns">
                  <div class="help-group">
                    <div class="help-title">Getting Started</div>
                    <ol class="help-steps">
                      <li>Open a source from the submenu above</li>
                      <li>Enable the source using the toggle</li>
                      <li>Enter connection details and save</li>
                      <li>Test the connection</li>
                      <li>Select libraries and apply filters</li>
                    </ol>
                  </div>
                  <div class="help-group">
                    <div class="help-title">Pro Tips</div>
                    <ul class="help-list">
                      <li><strong>Performance:</strong> Enable only active sources to speed up loads.</li>
                      <li><strong>Organization:</strong> Use genre/quality filters for focused galleries.</li>
                      <li><strong>Discovery:</strong> Mix Plex/Jellyfin with TMDB/TVDB for breadth.</li>
                    </ul>
                  </div>
                </div>
              </div>
            </section>

          </div>
        </div>
      </section>

      <!-- Plex Panel -->
      <section class="panel" id="panel-plex">
        <header class="panel-header">
          <h2><i class="fas fa-film"></i> Plex</h2>
          <div class="panel-actions">
            <span class="status-pill" id="plex-status-pill-header" title="Plex configuration status">Not configured</span>
            <span class="status-pill" id="plex-count-pill" title="Change ratings/genres/quality chips or year fields → the “Items: N” pill updates immediately using the cached playlist">Items: —</span>
            <a href="#" id="plex-open-link" class="header-link" title="Open Plex Web UI" hidden aria-label="Open Plex Web UI" target="_blank" rel="noopener"><i class="fas fa-globe"></i></a>
            <label class="header-toggle" for="plex.enabled" title="Enable Plex source">
              <input type="checkbox" id="plex.enabled" />
              <span class="ht-switch" aria-hidden="true"></span>
              <span class="ht-text">Enabled</span>
            </label>
            <button class="btn btn-icon btn-sm" id="btn-plex-test" title="Test connection"><i class="fas fa-vial"></i></button>
            <button class="btn btn-icon btn-sm" id="btn-plex-libraries" title="Fetch libraries"><i class="fas fa-list"></i></button>
            <button class="btn btn-primary btn-sm" id="btn-save-plex" title="Save Plex settings"><i class="fas fa-save"></i><span>Save Settings</span></button>
          </div>
        </header>
        <div class="panel-content">
          <div class="loading-overlay" aria-hidden="true">
            <div class="glass"></div>
            <div class="loader"><span class="spinner"></span></div>
          </div>
          <!-- Connection -->
          <div class="form-section">
            <div class="section-title"><i class="fas fa-server"></i> Server</div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="plex.hostname">Hostname</label>
              <input type="text" id="plex.hostname" placeholder="e.g. 192.168.1.10" autocomplete="off" autocapitalize="off" spellcheck="false">
            </div>
            <div class="form-group">
              <label for="plex.port">Port</label>
              <input type="number" id="plex.port" min="1" max="65535" placeholder="32400" autocomplete="off">
            </div>
            <div class="form-group">
              <label for="plex.token">API Token</label>
              <input type="password" id="plex.token" placeholder="X-Plex-Token" autocomplete="new-password">
              <small class="form-help">Stored in environment. Not shown after save.</small>
            </div>
          </div>

          <!-- Libraries -->
          <div class="form-section">
            <div class="section-title"><i class="fas fa-list"></i> Libraries</div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="plex.movies">Movie Libraries</label>
              <select id="plex.movies" multiple style="display:none"></select>
              <div class="multiselect" id="plex-ms-movies">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="plex-ms-movies-chips"></div>
                  <button class="ms-clear" id="plex-ms-movies-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="plex-ms-movies-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="plex-ms-movies-search" type="text" placeholder="Search libraries…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="plex-ms-movies-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="plex-ms-movies-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="plex-ms-movies-options"></div>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="plex.shows">Show Libraries</label>
              <select id="plex.shows" multiple style="display:none"></select>
              <div class="multiselect" id="plex-ms-shows">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="plex-ms-shows-chips"></div>
                  <button class="ms-clear" id="plex-ms-shows-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="plex-ms-shows-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="plex-ms-shows-search" type="text" placeholder="Search libraries…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="plex-ms-shows-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="plex-ms-shows-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="plex-ms-shows-options"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Years -->
          <div class="form-section">
            <div class="section-title"><i class="fas fa-filter"></i> Filters</div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="plex.yearFilter">Release Years</label>
              <input type="text" id="plex.yearFilter" inputmode="numeric" placeholder="e.g. 1995, 1998, 2015-2025">
            </div>
          </div>

          <!-- Ratings + Genres -->
          <div class="form-grid">
            <div class="form-group">
              <label for="plex.ratingFilter">Ratings</label>
              <input type="hidden" id="plex.ratingFilter-hidden" value="">
              <div class="multiselect" id="plex-ms-ratings">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="plex-ms-ratings-chips"></div>
                  <button class="ms-clear" id="plex-ms-ratings-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="plex-ms-ratings-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="plex-ms-ratings-search" type="text" placeholder="Search ratings…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="plex-ms-ratings-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="plex-ms-ratings-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="plex-ms-ratings-options"></div>
                </div>
              </div>
              <small class="form-help">Select one or more content ratings. Populated from Plex.</small>
            </div>
            <div class="form-group">
              <label for="plex.genreFilter">Genres</label>
              <input type="hidden" id="plex.genreFilter-hidden" value="">
              <div class="multiselect" id="plex-ms-genres">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="plex-ms-genres-chips"></div>
                  <button class="ms-clear" id="plex-ms-genres-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="plex-ms-genres-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="plex-ms-genres-search" type="text" placeholder="Search genres…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="plex-ms-genres-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="plex-ms-genres-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="plex-ms-genres-options"></div>
                </div>
              </div>
              <small id="plex-genre-help" class="form-help">Select one or more genres. Populated from Plex.</small>
            </div>
          </div>

          <!-- Qualities -->
          <div class="form-grid">
            <div class="form-group">
              <label for="plex.qualityFilter">Qualities</label>
              <input type="hidden" id="plex.qualityFilter-hidden" value="">
              <div class="multiselect" id="plex-ms-qualities">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="plex-ms-qualities-chips"></div>
                  <button class="ms-clear" id="plex-ms-qualities-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="plex-ms-qualities-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="plex-ms-qualities-search" type="text" placeholder="Search qualities…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="plex-ms-qualities-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="plex-ms-qualities-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="plex-ms-qualities-options"></div>
                </div>
              </div>
              <small class="form-help">Select one or more qualities (e.g., 720p, 1080p, 4K). Populated from Plex.</small>
            </div>
          </div>
          
            <!-- Recently-added controls moved to bottom of Plex panel -->
            <div class="form-grid">
              <div class="form-group">
                <label class="checkbox"><input type="checkbox" id="plex.recentOnly"><span class="checkmark"></span><span>Recently added only</span></label>
              </div>
              <div class="form-group">
                <label for="plex.recentDays">Recently added days</label>
                <input type="number" id="plex.recentDays" min="1" max="365" placeholder="30">
              </div>
            </div>
        </div>
      </section>

      <!-- Jellyfin Panel -->
      <section class="panel" id="panel-jellyfin" hidden>
        <header class="panel-header">
          <h2><i class="fas fa-play"></i> Jellyfin</h2>
          <div class="panel-actions">
            <span class="status-pill" id="jf-status-pill-header" title="Jellyfin configuration status">Not configured</span>
            <span class="status-pill" id="jf-count-pill" title="Change ratings/genres/quality chips or year fields → the “Items: N” pill updates immediately using the cached playlist">Items: —</span>
            <a href="#" id="jf-open-link" class="header-link" title="Open Jellyfin Web UI" hidden aria-label="Open Jellyfin Web UI" target="_blank" rel="noopener"><i class="fas fa-globe"></i></a>
            <label class="header-toggle" for="jf.enabled" title="Enable Jellyfin source">
              <input type="checkbox" id="jf.enabled" />
              <span class="ht-switch" aria-hidden="true"></span>
              <span class="ht-text">Enabled</span>
            </label>
            <button class="btn btn-icon btn-sm" id="btn-jf-test" title="Test connection"><i class="fas fa-vial"></i></button>
            <button class="btn btn-icon btn-sm" id="btn-jf-libraries" title="Fetch libraries"><i class="fas fa-list"></i></button>
            <button class="btn btn-primary btn-sm" id="btn-save-jellyfin" title="Save Jellyfin settings"><i class="fas fa-save"></i><span>Save Settings</span></button>
          </div>
        </header>
        <div class="panel-content">
          <div class="loading-overlay" aria-hidden="true">
            <div class="glass"></div>
            <div class="loader"><span class="spinner"></span></div>
          </div>
          <div class="form-section">
            <div class="section-title"><i class="fas fa-server"></i> Server</div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="jf.hostname">Hostname</label>
              <input type="text" id="jf.hostname" placeholder="e.g. 192.168.1.20" autocomplete="off" autocapitalize="off" spellcheck="false">
            </div>
            <div class="form-group">
              <label for="jf.port">Port</label>
              <input type="number" id="jf.port" min="1" max="65535" placeholder="8096" autocomplete="off">
            </div>
            <div class="form-group">
              <label for="jf.apikey">API Key</label>
              <input type="password" id="jf.apikey" placeholder="Jellyfin API Key" autocomplete="new-password">
              <small class="form-help">Stored in environment. Not shown after save.</small>
            </div>
            <div class="form-group">
              <label class="header-toggle" for="jf.insecureHttps" title="Allow insecure HTTPS (self-signed)">
                <input type="checkbox" id="jf.insecureHttps" />
                <span class="ht-switch" aria-hidden="true"></span>
                <span class="ht-text">Insecure HTTPS</span>
              </label>
              <small class="form-help">Use for testing with self-signed certs (e.g., HTTPS on port 8920).</small>
            </div>
          </div>
          <div class="form-section">
            <div class="section-title"><i class="fas fa-list"></i> Libraries</div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="jf.movies">Movie Libraries</label>
              <select id="jf.movies" multiple style="display:none"></select>
              <div class="multiselect" id="jf-ms-movies">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="jf-ms-movies-chips"></div>
                  <button class="ms-clear" id="jf-ms-movies-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="jf-ms-movies-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="jf-ms-movies-search" type="text" placeholder="Search libraries…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="jf-ms-movies-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="jf-ms-movies-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="jf-ms-movies-options"></div>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label for="jf.shows">Show Libraries</label>
              <select id="jf.shows" multiple style="display:none"></select>
              <div class="multiselect" id="jf-ms-shows">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="jf-ms-shows-chips"></div>
                  <button class="ms-clear" id="jf-ms-shows-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="jf-ms-shows-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="jf-ms-shows-search" type="text" placeholder="Search libraries…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="jf-ms-shows-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="jf-ms-shows-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="jf-ms-shows-options"></div>
                </div>
              </div>
            </div>
          </div>
          
          <div class="form-section">
            <div class="section-title"><i class="fas fa-filter"></i> Filters</div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="jf.yearFilter">Release Years</label>
              <input type="text" id="jf.yearFilter" inputmode="numeric" placeholder="e.g. 1995, 1998, 2015-2025">
            </div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="jf.ratingFilter">Ratings</label>
              <input type="hidden" id="jf.ratingFilter-hidden" value="">
              <div class="multiselect" id="jf-ms-ratings">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="jf-ms-ratings-chips"></div>
                  <button class="ms-clear" id="jf-ms-ratings-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="jf-ms-ratings-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="jf-ms-ratings-search" type="text" placeholder="Search ratings…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="jf-ms-ratings-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="jf-ms-ratings-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="jf-ms-ratings-options"></div>
                </div>
              </div>
              <small class="form-help">Select one or more content ratings. Populated from Jellyfin.</small>
            </div>
            <div class="form-group">
              <label for="jf.genreFilter">Genres</label>
              <input type="hidden" id="jf.genreFilter-hidden" value="">
              <div class="multiselect" id="jf-ms-genres">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="jf-ms-genres-chips"></div>
                  <button class="ms-clear" id="jf-ms-genres-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="jf-ms-genres-menu" role="listbox">
                  <div class="ms-search">
                    <i class="fas fa-search"></i>
                    <input id="jf-ms-genres-search" type="text" placeholder="Search genres…">
                  </div>
                  <div class="ms-actions">
                    <button class="btn btn-outline btn-sm" id="jf-ms-genres-select-all"><i class="fas fa-square-check"></i> Select all</button>
                    <button class="btn btn-outline btn-sm" id="jf-ms-genres-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                  </div>
                  <div class="ms-options" id="jf-ms-genres-options"></div>
                </div>
              </div>
              <small class="form-help">Select one or more genres. Populated from selected Jellyfin libraries.</small>
            </div>
          </div>
          <!-- Jellyfin Qualities hidden (disabled feature) -->
          <div class="form-grid" style="display:none">
            <div class="form-group">
              <label for="jf.qualityFilter">Qualities</label>
              <input type="hidden" id="jf.qualityFilter-hidden" value="">
              <div class="multiselect" id="jf-ms-qualities"></div>
              <small class="form-help">Qualities disabled for Jellyfin</small>
            </div>
          </div>
          <!-- Recently-added controls moved to bottom of Jellyfin panel -->
          <div class="form-grid">
            <div class="form-group">
              <label class="checkbox"><input type="checkbox" id="jf.recentOnly"><span class="checkmark"></span><span>Recently added only</span></label>
            </div>
            <div class="form-group">
              <label for="jf.recentDays">Recently added days</label>
              <input type="number" id="jf.recentDays" min="1" max="365" placeholder="30">
            </div>
          </div>
        </div>
      </section>

      <!-- TMDB Panel -->
      <section class="panel" id="panel-tmdb">
        <header class="panel-header">
          <h2><i class="fas fa-database"></i> TMDB</h2>
          <div class="panel-actions">
            <span class="status-pill" id="tmdb-status-pill-header" title="TMDB configuration status">Not configured</span>
            <span class="status-pill" id="tmdb-count-pill" title="Items from TMDB in the current playlist">Items: —</span>
            <label class="header-toggle" for="tmdb.enabled" title="Enable TMDB source">
              <input type="checkbox" id="tmdb.enabled" />
              <span class="ht-switch" aria-hidden="true"></span>
              <span class="ht-text">Enabled</span>
            </label>
            <button class="btn btn-icon btn-sm" id="btn-tmdb-test" title="Test connection"><i class="fas fa-vial"></i></button>
            <button class="btn btn-primary btn-sm" id="btn-save-tmdb" title="Save TMDB settings"><i class="fas fa-save"></i><span>Save Settings</span></button>
          </div>
        </header>
        <div class="panel-content">
          <div class="loading-overlay" aria-hidden="true">
            <div class="glass"></div>
            <div class="loader"><span class="spinner"></span></div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="tmdb.apikey">API Key</label>
              <input type="password" id="tmdb.apikey" placeholder="TMDB API Key" autocomplete="new-password">
            </div>
            <div class="form-group">
              <label for="tmdb.category">Category</label>
              <div class="select-wrap">
                <span class="select-icon" id="tmdb-category-icon"><i class="fas fa-fire"></i></span>
                <select id="tmdb.category">
                  <optgroup label="Movies">
                    <option value="popular">Popular Movies</option>
                    <option value="top_rated">Top Rated Movies</option>
                    <option value="now_playing">Now Playing</option>
                    <option value="upcoming">Upcoming Movies</option>
                    <option value="latest">Latest Movies</option>
                  </optgroup>
                  <optgroup label="TV Shows">
                    <option value="tv_popular">Popular TV Shows</option>
                    <option value="tv_top_rated">Top Rated TV Shows</option>
                    <option value="tv_on_the_air">Currently Airing</option>
                    <option value="tv_airing_today">Airing Today</option>
                    <option value="tv_latest">Latest TV Shows</option>
                  </optgroup>
                  <optgroup label="Trending">
                    <option value="trending_all_day">Trending Today (All)</option>
                    <option value="trending_movie_day">Trending Movies (Day)</option>
                    <option value="trending_tv_day">Trending TV (Day)</option>
                    <option value="trending_all_week">Trending Week (All)</option>
                    <option value="trending_movie_week">Trending Movies (Week)</option>
                    <option value="trending_tv_week">Trending TV (Week)</option>
                  </optgroup>
                  <optgroup label="Collections">
                    <option value="discover_movie">Discover Movies</option>
                    <option value="discover_tv">Discover TV Shows</option>
                  </optgroup>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="tmdb.minRating">Min Rating</label>
              <input type="number" id="tmdb.minRating" min="0" max="10" step="0.1" placeholder="0">
            </div>
            <div class="form-group">
              <label for="tmdb.yearFilter">Release Years</label>
              <input type="text" id="tmdb.yearFilter" inputmode="numeric" placeholder="e.g. 1995, 1998, 2015-2025">
              
            </div>
          </div>
            <div class="form-grid">
              <div class="form-group" style="grid-column: 1 / -1;">
                <label>Genres</label>
                <input type="hidden" id="tmdb.genreFilter-hidden" value="">
                <div class="multiselect" id="tmdb-ms-genres">
                  <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                    <div class="ms-chips" id="tmdb-ms-genres-chips"></div>
                    <button class="ms-clear" id="tmdb-ms-genres-clear" title="Clear selection"><i class="fas fa-xmark"></i></button>
                    <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                  </div>
                  <div class="ms-menu" id="tmdb-ms-genres-menu" role="listbox">
                    <div class="ms-search">
                      <i class="fas fa-search"></i>
                      <input id="tmdb-ms-genres-search" type="text" placeholder="Search genres…">
                    </div>
                    <div class="ms-actions">
                      <button class="btn btn-outline btn-sm" id="tmdb-ms-genres-select-all"><i class="fas fa-square-check"></i> Select all</button>
                      <button class="btn btn-outline btn-sm" id="tmdb-ms-genres-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                    </div>
                    <div class="ms-options" id="tmdb-ms-genres-options"></div>
                  </div>
                </div>
                <small id="tmdb-genre-help" class="form-help">Select one or more genres. Populated from TMDB.</small>
              </div>
            </div>

          <!-- Streaming Releases (TMDB-based) -->
          <div class="form-divider" aria-hidden="true"></div>
          <section class="subpanel" id="subpanel-streaming">
            <header class="subpanel-header">
              <h3>
                <i class="fas fa-stream" aria-hidden="true"></i>
                <span>Streaming Releases</span>
              </h3>
              <div class="panel-actions">
                <label class="header-toggle" for="streamingSources.enabled" title="Enable Streaming Releases">
                  <input type="checkbox" id="streamingSources.enabled" />
                  <span class="ht-switch" aria-hidden="true"></span>
                  <span class="ht-text">Enabled</span>
                </label>
                <button class="btn btn-icon btn-sm" id="test-streaming-button" title="Test Streaming"><i class="fas fa-vial"></i></button>
              </div>
            </header>
            <div class="subpanel-body">
              <div class="subtle">Add latest releases from popular streaming platforms using TMDB's provider data.</div>
              <small id="streaming-connection-status" class="form-help"></small>
          
          <div class="form-grid">
            <div class="form-group" style="grid-column: 1 / -1;">
              <label>Streaming Providers</label>
              <select id="streaming.providers" multiple style="display:none"></select>
              <div class="multiselect" id="streaming-ms-providers">
                <div class="ms-control" role="combobox" aria-expanded="false" aria-haspopup="listbox">
                  <div class="ms-chips" id="streaming-ms-providers-chips"></div>
                  <div class="placeholder">Select streaming providers</div>
                  <i class="fas fa-chevron-down ms-caret" aria-hidden="true"></i>
                </div>
                <div class="ms-menu" id="streaming-ms-providers-menu" role="listbox">
                  <div class="ms-actions">
                    <input type="text" id="streaming-ms-providers-search" placeholder="Search providers" aria-label="Search providers">
                    <div class="ms-actions-buttons">
                      <button class="btn btn-outline btn-sm" id="streaming-ms-providers-select-all"><i class="fas fa-plus"></i> Select all</button>
                      <button class="btn btn-outline btn-sm" id="streaming-ms-providers-clear-all"><i class="fas fa-eraser"></i> Clear</button>
                    </div>
                  </div>
                  <div class="ms-options" id="streaming-ms-providers-options"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label class="checkbox"><input type="checkbox" id="streamingSources.newReleases"><span class="checkmark"></span><span>New Releases (Selected)</span></label>
            </div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="streamingSources.region">Region</label>
              <select id="streamingSources.region">
                <option value="US">🇺🇸 United States</option>
                <option value="NL">🇳🇱 Netherlands</option>
                <option value="GB">🇬🇧 United Kingdom</option>
                <option value="DE">🇩🇪 Germany</option>
                <option value="FR">🇫🇷 France</option>
                <option value="CA">🇨🇦 Canada</option>
                <option value="AU">🇦🇺 Australia</option>
                <option value="ES">🇪🇸 Spain</option>
                <option value="IT">🇮🇹 Italy</option>
                <option value="BR">🇧🇷 Brazil</option>
                <option value="MX">🇲🇽 Mexico</option>
                <option value="AR">🇦🇷 Argentina</option>
                <option value="JP">🇯🇵 Japan</option>
                <option value="KR">🇰🇷 South Korea</option>
                <option value="IN">🇮🇳 India</option>
                <option value="CN">🇨🇳 China</option>
                <option value="RU">🇷🇺 Russia</option>
                <option value="BE">🇧🇪 Belgium</option>
                <option value="AT">🇦🇹 Austria</option>
                <option value="CH">🇨🇭 Switzerland</option>
                <option value="SE">🇸🇪 Sweden</option>
                <option value="NO">🇳🇴 Norway</option>
                <option value="DK">🇩🇰 Denmark</option>
                <option value="FI">🇫🇮 Finland</option>
                <option value="PL">🇵🇱 Poland</option>
                <option value="CZ">🇨🇿 Czech Republic</option>
                <option value="HU">🇭🇺 Hungary</option>
                <option value="PT">🇵🇹 Portugal</option>
                <option value="GR">🇬🇷 Greece</option>
                <option value="TR">🇹🇷 Turkey</option>
                <option value="IL">🇮🇱 Israel</option>
                <option value="ZA">🇿🇦 South Africa</option>
                <option value="EG">🇪🇬 Egypt</option>
                <option value="SA">🇸🇦 Saudi Arabia</option>
                <option value="AE">🇦🇪 United Arab Emirates</option>
                <option value="TH">🇹🇭 Thailand</option>
                <option value="SG">🇸🇬 Singapore</option>
                <option value="MY">🇲🇾 Malaysia</option>
                <option value="ID">🇮🇩 Indonesia</option>
                <option value="PH">🇵🇭 Philippines</option>
                <option value="VN">🇻🇳 Vietnam</option>
                <option value="TW">🇹🇼 Taiwan</option>
                <option value="HK">🇭🇰 Hong Kong</option>
                <option value="NZ">🇳🇿 New Zealand</option>
                <option value="CL">🇨🇱 Chile</option>
                <option value="CO">🇨🇴 Colombia</option>
                <option value="PE">🇵🇪 Peru</option>
                <option value="VE">🇻🇪 Venezuela</option>
                <option value="UY">🇺🇾 Uruguay</option>
                <option value="EC">🇪🇨 Ecuador</option>
                <option value="BO">🇧🇴 Bolivia</option>
                <option value="PY">🇵🇾 Paraguay</option>
              </select>
            </div>
          </div>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="streamingSources.minRating">Minimum Rating (0-10)</label>
              <input type="number" id="streamingSources.minRating" min="0" max="10" step="0.1" placeholder="6.0">
            </div>
          </div>
            </div>
          </section>
        </div>
      </section>

      <!-- TVDB Panel -->
      <section class="panel" id="panel-tvdb">
        <header class="panel-header">
          <h2><i class="fas fa-tv"></i> TVDB</h2>
          <div class="panel-actions">
            <span class="status-pill" id="tvdb-count-pill" title="Items from TVDB in the current playlist">Items: —</span>
            <label class="header-toggle" for="tvdb.enabled" title="Enable TVDB source">
              <input type="checkbox" id="tvdb.enabled" />
              <span class="ht-switch" aria-hidden="true"></span>
              <span class="ht-text">Enabled</span>
            </label>
            <button class="btn btn-icon btn-sm" id="btn-tvdb-test" title="Test connection"><i class="fas fa-vial"></i></button>
            <button class="btn btn-primary btn-sm" id="btn-save-tvdb" title="Save TVDB settings"><i class="fas fa-save"></i><span>Save Settings</span></button>
          </div>
        </header>
        <div class="panel-content">
          <div class="loading-overlay" aria-hidden="true">
            <div class="glass"></div>
            <div class="loader"><span class="spinner"></span></div>
          </div>
          <div class="form-grid">
            <div class="form-group">
              <label for="tvdb.category">Category</label>
              <div class="select-wrap">
                <span class="select-icon" id="tvdb-category-icon"><i class="fas fa-fire"></i></span>
                <select id="tvdb.category">
                <optgroup label="By Rating & Popularity">
                  <option value="top_rated">Top Rated</option>
                  <option value="popular">Most Popular</option>
                </optgroup>
                <optgroup label="By Date">
                  <option value="recently_updated">Recently Updated</option>
                  <option value="newest">Newest Releases</option>
                  <option value="oldest">Classic Content</option>
                </optgroup>
                <optgroup label="By Activity">
                  <option value="trending">Trending Now</option>
                  <option value="recently_added">Recently Added to TVDB</option>
                </optgroup>
                <optgroup label="Alphabetical">
                  <option value="alphabetical">A-Z Order</option>
                </optgroup>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="tvdb.minRating">Min Rating</label>
              <input type="number" id="tvdb.minRating" min="0" max="10" step="0.1" placeholder="e.g. 7.0">
            </div>
            <div class="form-group">
              <label for="tvdb.yearFilter">Release Years</label>
              <input type="text" id="tvdb.yearFilter" inputmode="numeric" placeholder="e.g. 1995, 1998, 2015-2025">
              
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- Operations Section (top-level sibling) -->
  <section id="section-operations" class="app-section" hidden>
    <section class="panel operations-panel">
        <header class="panel-header">
          <div style="display:flex; align-items:flex-start; justify-content:space-between; gap:10px; width:100%;">
            <div class="panel-title">
              <h2><i class="fas fa-screwdriver-wrench"></i> Operations</h2>
              <div class="panel-subtitle">Run media refresh and manage auto-updates</div>
            </div>
            <div class="panel-actions">
              <button type="button" id="btn-save-operations" class="btn btn-primary btn-sm" title="Save all operation settings">
                <i class="fas fa-save"></i><span>Save Settings</span>
              </button>
            </div>
          </div>
        </header>
        <div class="panel-content">
      <div class="content-grid" style="gap:12px;">
        <div class="ops-col">
          <div class="ops-group">
            <div class="ops-group-title"><i class="fas fa-download"></i> Updates</div>
          </div>
            <!-- Auto-Update Operations (moved to top-left) -->
            <section class="perf-card" aria-label="Automatic Updates">
              <h3><i class="fas fa-download"></i> Automatic Updates</h3>
              <div class="card-pill-spot">
                <span id="update-phase-text" class="status-pill status-info" style="display:none;">Checking…</span>
                <span id="update-progress-percent" class="status-pill" style="display:none;">0%</span>
                <span id="update-idle-pill" class="status-pill status-success">Ready</span>
              </div>
              <div class="card-subtext">Manage updates and view progress.</div>
              <div id="ops-update-status" class="status-display">
                <div id="update-idle-state"></div>
                <div id="update-progress-state" style="display:none;" class="mt-8">
                  <div class="meter mt-6">
                    <div id="update-progress-bar" style="width:0%; background: linear-gradient(90deg,#60a5fa,#1e40af);"></div>
                  </div>
                  <div id="update-message" class="subtle mt-6">Preparing…</div>
                </div>
              </div>
              <div class="actions main-actions">
                <button type="button" id="btn-start-update" class="btn btn-success btn-sm"><i class="fas fa-download"></i><span>Start Auto-Update</span></button>
                <button type="button" id="btn-rollback-update" class="btn btn-secondary btn-sm"><i class="fas fa-undo"></i><span>Rollback</span></button>
                <button type="button" id="btn-list-backups" class="btn btn-secondary btn-sm"><i class="fas fa-archive"></i><span>View Backups</span></button>
              </div>
              <div class="actions sub-actions">
                <div class="input-row">
                  <div class="form-group" style="margin:0;">
                    <input type="number" id="input-keep-backups" min="1" max="20" value="5" class="w-90" />
                  </div>
                  <button type="button" id="btn-cleanup-backups" class="btn btn-secondary btn-sm"><i class="fas fa-trash"></i><span>Cleanup Old</span></button>
                </div>
              </div>
              <div id="backups-display" class="status-display" style="display:none; margin-top:10px;">
                <div class="subtle" style="display:flex; align-items:center; gap:8px;"><i class="fas fa-archive"></i> Available Backups</div>
                <div id="backups-content" class="metric-row" style="margin-top:6px;">
                  <div class="subtle">Loading…</div>
                </div>
              </div>
      </section>
            <!-- Media Operations -->
            <section class="perf-card" aria-label="Media Operations">
              <h3><i class="fas fa-sync-alt"></i> Media</h3>
              <div class="card-subtext">Refresh media from configured sources.</div>
        <div class="actions main-actions">
                <button type="button" id="btn-refresh-media" class="btn btn-success btn-sm">
                  <i class="fas fa-sync-alt"></i><span>Refresh Media</span>
                </button>
              </div>
            </section>
            <!-- Server Settings -->
            <section class="perf-card" aria-label="Server Settings">
              <h3><i class="fas fa-gear"></i> Server</h3>
              <div class="card-subtext">Core server configuration.</div>
              <div class="metric-row">
                <div class="form-group inline-field nowrap" style="display: block;">
                  <label for="SERVER_PORT" style="margin:0;display:inline-flex;align-items:center;padding-right:12px;">Port</label>
                  <input type="number" id="SERVER_PORT" min="1024" max="65535" step="1" class="w-110" />
                </div>
              </div>
            </section>
        </div>
  <div class="ops-col">
      <div class="ops-group">
        <div class="ops-group-title"><i class="fas fa-server"></i> Server & Access</div>
      </div>
      <!-- Debug & Logging -->
            <section class="perf-card" aria-label="Debug & Logging">
              <h3><i class="fas fa-bug"></i> Debug & Logging</h3>
              <div class="card-pill-spot">
                <span class="status-pill" id="debug-status-pill">Debug: Off</span>
              </div>
              <div class="card-subtext">Detailed logging for troubleshooting.</div>
              <div class="metric-row mt-6">
                <div class="form-group checkbox-group">
                  <label class="checkbox" for="DEBUG">
                    <input type="checkbox" id="DEBUG" />
                    <span class="checkmark"></span>
                    <span>Enable Debug Mode</span>
                  </label>
                </div>
                <div class="micro-hint"><i class="fas fa-info-circle" aria-hidden="true"></i><span>Use temporarily; verbose logs can impact performance.</span></div>
              </div>
              <div class="actions mt-8">
                <a href="/logs.html" target="_blank" rel="noopener" class="btn btn-secondary btn-sm"><i class="fas fa-scroll"></i><span>Open Logs</span></a>
              </div>
            </section>
  <!-- Promobox Site -->
            <section class="perf-card" aria-label="Promobox Site">
              <h3><i class="fas fa-bullhorn"></i> Promobox Site</h3>
              <div class="card-pill-spot">
                <span class="status-pill status-warning" id="siteServer-pill">Disabled</span>
              </div>
              <div class="card-subtext">Optional static poster showcase.</div>
              <div class="metric-row mt-6">
                <div class="form-group checkbox-group">
                  <label class="checkbox" for="siteServer.enabled">
                    <input type="checkbox" id="siteServer.enabled" />
                    <span class="checkmark"></span>
                    <span>Enable Promobox Site</span>
                  </label>
                </div>
                <div class="form-group inline-field nowrap" id="siteServerPortGroup" style="display:none;">
                  <label for="siteServer.port" style="margin:0;display:inline-flex;align-items:center;padding-right:12px;">Port</label>
                  <input type="number" id="siteServer.port" min="1024" max="65535" value="4001" class="w-110" />
                </div>
                <div id="siteServerStatus" class="subtle" style="display:none;"></div>
              </div>
            </section>

            <!-- API Access -->
            <section class="perf-card" aria-label="API Access Management">
              <h3><i class="fas fa-code"></i> API Access</h3>
              <div class="card-pill-spot">
                <span class="status-pill" id="api-key-status-pill">Key: <span id="api-key-status-text">Loading…</span></span>
              </div>
              <div class="card-subtext">Programmatic access to admin endpoints.</div>
              <div id="api-key-display" class="is-hidden mt-6">
                <div class="input-row">
                  <input id="api-key-input" type="password" readonly />
                  <div class="actions">
                    <button id="toggle-api-key-visibility-button" type="button" class="btn btn-icon btn-sm" title="Show/Hide"><i class="fas fa-eye"></i></button>
                    <button id="copy-api-key-button" type="button" class="btn btn-icon btn-sm" title="Copy to clipboard"><i class="fas fa-copy"></i></button>
                  </div>
                </div>
              </div>
              <div class="actions" style="margin-top:6px;">
                <button id="generate-api-key-button" type="button" class="btn btn-success btn-sm">
                  <i class="fas fa-key"></i>
                  <span>Generate New Key</span>
                </button>
                <button id="revoke-api-key-button" type="button" class="btn btn-error btn-sm" disabled>
                  <i class="fas fa-trash-alt"></i>
                  <span>Revoke Key</span>
                </button>
              </div>
            </section>
      
    </div>
          </div>
        </div>
      </section>
    </section>

  </main>

  <!-- Change Password Modal -->
  <div class="modal-overlay" id="modal-change-password">
    <div class="modal modal-sm" role="dialog" aria-modal="true" aria-labelledby="modal-change-password-title">
      <div class="modal-header">
        <div class="modal-title" id="modal-change-password-title"><i class="fas fa-key"></i> Change Password</div>
        <button class="modal-close" data-close-modal aria-label="Close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" style="text-align: center; padding: 24px;">
        
        <!-- Security icon and intro -->
        <div style="margin-bottom: 24px;">
          <div style="
            width: 64px; 
            height: 64px; 
            margin: 0 auto 16px auto; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
          ">
            <i class="fas fa-key" style="font-size: 24px; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
          </div>
          <h3 style="margin: 0 0 6px 0; font-size: 1.1rem; font-weight: 600;">Update Your Password</h3>
          <p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.7); line-height: 1.4;">
            Choose a strong password to keep your account secure
          </p>
        </div>

        <!-- Password form section -->
        <div style="background: rgba(255,255,255,0.02); border-radius: 12px; padding: 20px; border: 1px solid rgba(255,255,255,0.06);">
          
          <!-- Current password -->
          <div style="margin-bottom: 16px; text-align: left;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <i class="fas fa-unlock" style="color: var(--color-warning); font-size: 0.8rem;"></i>
              <span style="font-weight: 600; font-size: 0.85rem;">Current Password</span>
            </div>
            <input 
              type="password" 
              id="input-current-password" 
              autocomplete="current-password" 
              placeholder="Enter your current password"
              style="
                width: 100%;
                padding: 10px 12px;
                border-radius: 6px;
                border: 2px solid rgba(255,255,255,0.1);
                background: rgba(255,255,255,0.05);
                color: white;
                font-size: 0.9rem;
                transition: border-color 0.2s ease;
              "
            />
          </div>
          
          <!-- New password -->
          <div style="margin-bottom: 16px; text-align: left;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <i class="fas fa-lock" style="color: var(--color-success); font-size: 0.8rem;"></i>
              <span style="font-weight: 600; font-size: 0.85rem;">New Password</span>
            </div>
            <input 
              type="password" 
              id="input-new-password" 
              autocomplete="new-password" 
              placeholder="Enter a strong new password"
              style="
                width: 100%;
                padding: 10px 12px;
                border-radius: 6px;
                border: 2px solid rgba(255,255,255,0.1);
                background: rgba(255,255,255,0.05);
                color: white;
                font-size: 0.9rem;
                transition: border-color 0.2s ease;
              "
            />
          </div>
          
          <!-- Confirm password -->
          <div style="margin-bottom: 16px; text-align: left;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <i class="fas fa-check-circle" style="color: var(--color-accent); font-size: 0.8rem;"></i>
              <span style="font-weight: 600; font-size: 0.85rem;">Confirm Password</span>
            </div>
            <input 
              type="password" 
              id="input-confirm-password" 
              autocomplete="new-password" 
              placeholder="Confirm your new password"
              style="
                width: 100%;
                padding: 10px 12px;
                border-radius: 6px;
                border: 2px solid rgba(255,255,255,0.1);
                background: rgba(255,255,255,0.05);
                color: white;
                font-size: 0.9rem;
                transition: border-color 0.2s ease;
              "
            />
          </div>

          <!-- Password strength indicator -->
          <div id="password-strength" style="margin-bottom: 12px; text-align: left; display: none;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
              <i class="fas fa-shield-alt" style="font-size: 0.75rem; color: rgba(255,255,255,0.6);"></i>
              <span style="font-size: 0.75rem; font-weight: 600; color: rgba(255,255,255,0.8);">Password Strength</span>
            </div>
            <div style="display: flex; gap: 2px; margin-bottom: 6px;">
              <div class="strength-bar" style="height: 4px; flex: 1; background: rgba(255,255,255,0.1); border-radius: 2px;"></div>
              <div class="strength-bar" style="height: 4px; flex: 1; background: rgba(255,255,255,0.1); border-radius: 2px;"></div>
              <div class="strength-bar" style="height: 4px; flex: 1; background: rgba(255,255,255,0.1); border-radius: 2px;"></div>
              <div class="strength-bar" style="height: 4px; flex: 1; background: rgba(255,255,255,0.1); border-radius: 2px;"></div>
            </div>
            <div id="strength-text" style="font-size: 0.7rem; color: rgba(255,255,255,0.6);"></div>
          </div>

          <!-- Status message -->
          <div id="password-status" class="status-message" style="display: none; margin-top: 12px;"></div>
        </div>
      </div>
      
      <div class="modal-footer" style="display: flex; gap: 12px; justify-content: flex-end; padding: 16px 24px;">
        <button type="button" class="btn btn-outline" data-close-modal style="min-width: 80px;">Cancel</button>
        <button type="button" id="btn-change-password" class="btn btn-primary" style="min-width: 140px;">
          <i class="fas fa-key"></i><span>Change Password</span>
        </button>
      </div>
    </div>
  </div>

  <!-- 2FA Enable Modal (theme-demo structure) -->
  <div class="modal-overlay" id="modal-2fa">
    <div class="modal modal-md" role="dialog" aria-modal="true" aria-labelledby="modal-2fa-title">
      <div class="modal-header">
        <div class="modal-title" id="modal-2fa-title"><i class="fas fa-shield-alt"></i> Enable Two-Factor Authentication</div>
        <button class="modal-close" data-close-modal aria-label="Close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" style="text-align: center; padding: 24px;">
        
        <!-- Compact security icon and intro -->
        <div style="margin-bottom: 24px;">
          <div style="
            width: 60px; 
            height: 60px; 
            margin: 0 auto 16px auto; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            background: linear-gradient(135deg, var(--color-success), var(--color-primary));
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
          ">
            <i class="fas fa-shield-alt" style="font-size: 24px; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
          </div>
          <h3 style="margin: 0 0 6px 0; font-size: 1.1rem; font-weight: 600;">Secure Your Account</h3>
          <p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.7); line-height: 1.4;">
            Add an extra layer of security with 2FA
          </p>
        </div>

        <!-- Compact steps in horizontal layout -->
        <div style="background: rgba(255,255,255,0.02); border-radius: 12px; padding: 20px; border: 1px solid rgba(255,255,255,0.06);">
          
          <!-- Two-column layout for steps -->
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: start;">
            
            <!-- Step 1: QR Code -->
            <div>
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; justify-content: center;">
                <div style="
                  width: 24px; 
                  height: 24px; 
                  border-radius: 50%; 
                  background: var(--color-primary); 
                  display: flex; 
                  align-items: center; 
                  justify-content: center;
                  font-size: 0.75rem;
                  font-weight: 700;
                  color: white;
                ">1</div>
                <span style="font-weight: 600; font-size: 0.9rem;">Scan QR Code</span>
              </div>
              
              <div id="qr-code-container" style="
                background: white; 
                border-radius: 8px; 
                padding: 12px; 
                margin: 0 auto 8px auto; 
                display: inline-block;
                box-shadow: 0 3px 8px rgba(0,0,0,0.15);
              ">
                <div class="subtle" style="color: #666; font-size: 0.85rem;">Loading QR...</div>
              </div>
              
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin: 0; line-height: 1.3;">
                Use any TOTP app
              </p>
            </div>

            <!-- Step 2: Verification -->
            <div>
              <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; justify-content: center;">
                <div style="
                  width: 24px; 
                  height: 24px; 
                  border-radius: 50%; 
                  background: var(--color-accent); 
                  display: flex; 
                  align-items: center; 
                  justify-content: center;
                  font-size: 0.75rem;
                  font-weight: 700;
                  color: white;
                ">2</div>
                <span style="font-weight: 600; font-size: 0.9rem;">Enter Code</span>
              </div>
              
              <div style="margin-top: 8px;">
                <input 
                  id="input-2fa-token" 
                  inputmode="numeric" 
                  autocomplete="one-time-code" 
                  placeholder="000 000" 
                  maxlength="7"
                  style="
                    width: 140px;
                    font-size: 1rem;
                    font-weight: 600;
                    text-align: center;
                    letter-spacing: 0.4em;
                    padding: 10px 12px;
                    border-radius: 6px;
                    border: 2px solid rgba(255,255,255,0.1);
                    background: rgba(255,255,255,0.05);
                    color: white;
                  " 
                />
              </div>
              
              <p style="font-size: 0.75rem; color: rgba(255,255,255,0.6); margin: 8px 0 0 0; line-height: 1.3;">
                6-digit verification code
              </p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer" style="display: flex; gap: 12px; justify-content: flex-end; padding: 16px 24px;">
        <button type="button" class="btn btn-outline" data-close-modal style="min-width: 80px;">Cancel</button>
        <button type="button" id="btn-2fa-verify" class="btn btn-success" style="min-width: 140px;">
          <i class="fas fa-check-circle"></i><span>Verify & Enable</span>
        </button>
      </div>
    </div>
  </div>

  <!-- 2FA Disable Modal (theme-demo structure) -->
  <div class="modal-overlay" id="modal-2fa-disable">
    <div class="modal modal-sm" role="dialog" aria-modal="true" aria-labelledby="modal-2fa-disable-title">
      <div class="modal-header">
        <div class="modal-title" id="modal-2fa-disable-title"><i class="fas fa-shield-alt"></i> Disable Two-Factor Authentication</div>
        <button class="modal-close" data-close-modal aria-label="Close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" style="text-align: center; padding: 20px;">
        
        <!-- Compact warning icon and message -->
        <div style="margin-bottom: 20px;">
          <div style="
            width: 60px; 
            height: 60px; 
            margin: 0 auto 12px auto; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            background: linear-gradient(135deg, var(--color-warning), var(--color-error));
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
          ">
            <i class="fas fa-exclamation-triangle" style="font-size: 24px; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
          </div>
          <h3 style="margin: 0 0 6px 0; font-size: 1.1rem; font-weight: 600;">Disable Two-Factor Auth</h3>
          <p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.7); line-height: 1.4;">
            This will reduce your account security
          </p>
        </div>

        <!-- Compact password input section -->
        <div style="background: rgba(255,255,255,0.02); border-radius: 12px; padding: 16px; border: 1px solid rgba(255,255,255,0.06);">
          <div style="margin-bottom: 12px; text-align: left;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <i class="fas fa-key" style="color: var(--color-warning); font-size: 0.8rem;"></i>
              <span style="font-weight: 600; font-size: 0.85rem;">Confirm with password</span>
            </div>
            <input 
              type="password" 
              id="input-2fa-disable-password" 
              autocomplete="current-password" 
              placeholder="Current password"
              style="
                width: 100%;
                padding: 10px 12px;
                border-radius: 6px;
                border: 2px solid rgba(255,255,255,0.1);
                background: rgba(255,255,255,0.05);
                color: white;
                font-size: 0.95rem;
              "
            />
          </div>
          
          <!-- Compact security warning -->
          <div style="
            background: rgba(var(--color-warning-rgb, 251, 191, 36), 0.1); 
            border: 1px solid rgba(var(--color-warning-rgb, 251, 191, 36), 0.2);
            border-radius: 6px; 
            padding: 8px; 
            text-align: left;
          ">
            <div style="display: flex; align-items: center; gap: 6px;">
              <i class="fas fa-info-circle" style="color: var(--color-warning); font-size: 0.75rem; flex-shrink: 0;"></i>
              <div style="font-size: 0.75rem; color: var(--color-warning); line-height: 1.3;">
                Your account will only be protected by password
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer" style="display: flex; gap: 12px; justify-content: flex-end; padding: 16px 20px;">
        <button type="button" class="btn btn-outline" data-close-modal style="min-width: 80px;">Cancel</button>
        <button type="button" id="btn-2fa-disable-confirm" class="btn btn-error" style="min-width: 120px;">
          <i class="fas fa-shield-alt"></i><span>Disable 2FA</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Revoke API Key Confirmation Modal (theme-demo structure) -->
  <div class="modal-overlay" id="modal-revoke-api-key">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-revoke-title">
      <div class="modal-header">
        <div class="modal-title" id="modal-revoke-title"><i class="fas fa-trash-alt"></i> Revoke API Key</div>
        <button class="modal-close" data-close-modal aria-label="Close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to revoke the current API key? Any client using it will stop working immediately.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline" data-close-modal>Cancel</button>
        <button type="button" id="btn-revoke-api-key-confirm" class="btn btn-error"><i class="fas fa-trash-alt"></i><span>Revoke Key</span></button>
      </div>
    </div>
  </div>

  <!-- Update Confirmation Modal (theme-demo structure) -->
  <div class="modal-overlay" id="modal-update">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-update-title">
      <div class="modal-header">
        <div class="modal-title" id="modal-update-title"><i class="fas fa-download"></i> Confirm Auto-Update</div>
        <button class="modal-close" data-close-modal aria-label="Close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" id="modal-update-content">
        <div class="subtle">Loading update information…</div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline" data-close-modal>Cancel</button>
        <button type="button" id="btn-update-force" class="btn btn-warning" style="display:none;"><i class="fas fa-hammer"></i><span>Force Update</span></button>
        <button type="button" id="btn-update-confirm" class="btn btn-primary" disabled><i class="fas fa-check"></i><span>Start Update</span></button>
      </div>
    </div>
  </div>

  <!-- Cache Size Edit Modal -->
  <div class="modal-overlay" id="modal-cache-size">
    <div class="modal modal-sm" role="dialog" aria-modal="true" aria-labelledby="modal-cache-size-title">
      <div class="modal-header">
        <div class="modal-title" id="modal-cache-size-title"><i class="fas fa-database"></i> Edit Cache Size</div>
        <button class="modal-close" data-close-modal aria-label="Close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" style="text-align: center; padding: 24px;">
        
        <!-- Cache icon and intro -->
        <div style="margin-bottom: 24px;">
          <div style="
            width: 64px; 
            height: 64px; 
            margin: 0 auto 16px auto; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center;
            background: linear-gradient(135deg, var(--color-warning), var(--color-warning-dark));
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
          ">
            <i class="fas fa-database" style="font-size: 24px; color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.3);"></i>
          </div>
          <h3 style="margin: 0 0 6px 0; font-size: 1.1rem; font-weight: 600;">Configure Cache Storage</h3>
          <p style="margin: 0; font-size: 0.85rem; color: rgba(255,255,255,0.7); line-height: 1.4;">
            Set the maximum disk space for cached poster images
          </p>
        </div>

        <!-- Cache size form section -->
        <div style="background: rgba(255,255,255,0.02); border-radius: 12px; padding: 20px; border: 1px solid rgba(255,255,255,0.06);">
          
          <!-- Cache size input -->
          <div style="margin-bottom: 16px; text-align: left;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
              <i class="fas fa-hdd" style="color: var(--color-warning); font-size: 0.8rem;"></i>
              <span style="font-weight: 600; font-size: 0.85rem;">Maximum Cache Size</span>
            </div>
            <div style="display: flex; gap: 12px; align-items: center;">
              <input 
                id="input-cache-size-gb" 
                type="number" 
                inputmode="decimal" 
                step="0.1" 
                min="0.1" 
                placeholder="2.0"
                style="
                  flex: 1;
                  padding: 12px 16px;
                  border-radius: 8px;
                  border: 2px solid rgba(255,255,255,0.1);
                  background: rgba(255,255,255,0.05);
                  color: white;
                  font-size: 1rem;
                  font-weight: 600;
                  text-align: center;
                  transition: all 0.2s ease;
                "
              />
              <div style="
                padding: 12px 16px;
                background: rgba(var(--color-warning-rgb), 0.15);
                border: 2px solid rgba(var(--color-warning-rgb), 0.3);
                border-radius: 8px;
                color: var(--color-warning);
                font-weight: 600;
                font-size: 0.9rem;
              ">
                GB
              </div>
            </div>
          </div>

          <!-- Storage info -->
          <div style="
            background: rgba(var(--color-info-rgb), 0.1); 
            border: 1px solid rgba(var(--color-info-rgb), 0.2); 
            border-radius: 8px; 
            padding: 12px 16px;
            text-align: center;
            margin-top: 16px;
          ">
            <div style="display: flex; align-items: center; justify-content: center; gap: 6px; margin-bottom: 4px;">
              <i class="fas fa-info-circle" style="color: var(--color-info); font-size: 0.8rem;"></i>
              <span style="font-weight: 600; font-size: 0.8rem; color: var(--color-info);">Recommended Range</span>
            </div>
            <div style="font-size: 0.75rem; color: rgba(255,255,255,0.6);">
              1.0 - 5.0 GB • Must be greater than 0.1 GB
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer" style="padding: 20px 24px; border-top: 1px solid rgba(255,255,255,0.1);">
        <button type="button" class="btn btn-outline" data-close-modal style="margin-right: 12px;">
          <i class="fas fa-times"></i>
          <span>Cancel</span>
        </button>
        <button type="button" id="btn-cache-size-save" class="btn" style="
          background: linear-gradient(135deg, var(--color-warning), var(--color-warning-dark));
          border: none;
          color: white;
          font-weight: 600;
          box-shadow: 0 4px 12px rgba(var(--color-warning-rgb), 0.3);
          transition: all 0.2s ease;
        ">
          <i class="fas fa-save"></i>
          <span>Save Changes</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Profile Photo Modal -->
  <div class="modal-overlay" id="modal-avatar" hidden>
    <div class="modal modal-sm" role="dialog" aria-modal="true" aria-labelledby="modal-avatar-title">
      <div class="modal-header">
        <div class="modal-title" id="modal-avatar-title"><i class="fas fa-image"></i> Profile Photo</div>
        <button class="modal-close" data-close-modal aria-label="Close"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body" style="text-align: center; padding: 24px;">
        
        <!-- Large centered avatar preview -->
        <div style="margin-bottom: 32px;">
          <div class="avatar-preview" id="avatar-preview" aria-live="polite" style="
            width: 120px; 
            height: 120px; 
            margin: 0 auto 16px auto; 
            border-radius: 50%; 
            overflow: hidden; 
            border: 4px solid rgba(255,255,255,0.1);
            box-shadow: 0 8px 24px rgba(0,0,0,0.3);
            position: relative;
            background: linear-gradient(135deg, var(--color-primary), var(--color-accent));
          ">
            <div class="avatar-initials" id="avatar-initials-fallback" style="
              position: absolute;
              top: 50%;
              left: 50%;
              transform: translate(-50%, -50%);
              font-size: 36px;
              font-weight: 700;
              color: white;
              text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            ">AD</div>
            <img id="avatar-image-preview" alt="Current profile photo" style="
              width: 100%;
              height: 100%;
              object-fit: cover;
              position: absolute;
              top: 0;
              left: 0;
            " />
          </div>
        </div>

        <!-- Upload section with modern design -->
        <div style="background: rgba(255,255,255,0.02); border-radius: 16px; padding: 24px; border: 1px solid rgba(255,255,255,0.06);">
          <div style="margin-bottom: 20px;">
            <div class="file-upload-area" style="
              border: 2px dashed rgba(255,255,255,0.2);
              border-radius: 12px;
              padding: 32px 16px;
              cursor: pointer;
              transition: all 0.2s ease;
              position: relative;
              background: rgba(255,255,255,0.01);
            " id="upload-drop-zone">
              <div style="margin-bottom: 16px;">
                <i class="fas fa-cloud-upload-alt" style="font-size: 32px; color: var(--color-primary); opacity: 0.8;"></i>
              </div>
              <button type="button" class="btn btn-primary btn-sm" id="avatar-file-trigger" style="margin-bottom: 12px;">
                <i class="fas fa-file-upload"></i><span>Choose Image</span>
              </button>
              <div style="font-size: 0.9rem; color: rgba(255,255,255,0.7); margin-bottom: 8px;">
                or drag and drop your image here
              </div>
              <div style="font-size: 0.8rem; color: rgba(255,255,255,0.5);">
                PNG, JPG, or WebP — up to 2 MB
              </div>
              <input type="file" id="avatar-file" accept="image/png,image/jpeg,image/webp" style="position:absolute;left:-9999px;opacity:0;pointer-events:none;" />
            </div>
            
            <!-- Selected file display -->
            <div id="selected-file-display" style="display: none; margin-top: 16px; padding: 12px; background: rgba(var(--color-success-rgb, 16, 185, 129), 0.1); border-radius: 8px; border: 1px solid rgba(var(--color-success-rgb, 16, 185, 129), 0.2);">
              <div style="display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-check-circle" style="color: var(--color-success);"></i>
                <span id="avatar-file-name" style="font-size: 0.9rem; color: var(--color-success);">No file selected</span>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer" style="display: flex; gap: 12px; justify-content: flex-end; padding: 20px 24px;">
        <button type="button" class="btn btn-outline" data-close-modal style="min-width: 80px;">Cancel</button>
        <button type="button" class="btn btn-error" id="avatar-remove-btn" style="min-width: 90px;">
          <i class="fas fa-trash"></i><span>Remove</span>
        </button>
        <button type="button" class="btn btn-primary" id="avatar-upload-btn" style="min-width: 90px;">
          <i class="fas fa-upload"></i><span>Upload</span>
        </button>
      </div>
    </div>
  </div>

  <script src="/notify.js?v=20250906-1"></script>
  <script src="/admin2.js?v=20250907-04"></script>
  <!-- PWA Service Worker Registration (admin2) -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js').catch(() => { /* silent */ });
      });
    }
  </script>
</body>
</html>

