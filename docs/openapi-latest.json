{
    "openapi": "3.0.0",
    "info": {
        "title": "Posterrama API",
        "version": "2.9.2",
        "description": "# Posterrama API Documentation\n\n**Posterrama** transforms any screen into a dynamic movie poster gallery by aggregating media from multiple sources including Plex, Jellyfin, and TMDB.\n\n## Overview\n\nThis API provides comprehensive access to:\n- **Media Management**: Retrieve and display movie/TV show posters with metadata\n- **Device Control**: Manage display devices, groups, and real-time playback\n- **Configuration**: Complete system and per-device settings management\n- **Admin Panel**: Full administrative control and monitoring\n\n## Key Features\n\n### Multi-Source Aggregation\nPosterrama seamlessly combines content from:\n- **Plex Media Server**: Direct integration with your local media library\n- **Jellyfin**: Open-source media server support\n- **TMDB**: The Movie Database for trending content\n- **Local Posterpacks**: Offline ZIP-based media packages\n\n### Display Modes\nThree distinct viewing experiences:\n- **Screensaver**: Rotating poster display with customizable transitions\n- **Cinema**: Coming attractions style with trailers and theme music\n- **Wallart**: Gallery-style continuous display\n\n### Real-time Control\n- WebSocket-based device management\n- Live settings updates without page reload\n- Group broadcasting for multi-device setups\n- Remote command execution (pause, play, reload, etc.)\n\n## Authentication\n\nThe API uses session-based authentication with cookies for admin endpoints. Public endpoints (like `/get-media`) are accessible without authentication.\n\n**Security Note**: Always use HTTPS in production to protect session cookies.\n\n## Rate Limiting\n\nSome endpoints have rate limiting to prevent abuse:\n- Media endpoints: Cached responses with configurable TTL\n- Admin operations: Standard rate limits apply\n- WebSocket connections: Maximum 1 active connection per device\n\n## Getting Started\n\n1. Access the admin panel at `/admin` to configure your media sources\n2. Use `/get-media` to retrieve the aggregated playlist\n3. Implement the display frontend using `/screensaver`, `/cinema`, or `/wallart` modes\n4. Register devices via `/api/devices/register` for remote control\n\nFor more information, visit the [GitHub repository](https://github.com/Posterrama/posterrama).",
        "contact": {
            "name": "Posterrama Project",
            "url": "https://github.com/Posterrama/posterrama",
            "email": "support@posterrama.app"
        },
        "license": {
            "name": "GPL-3.0-or-later",
            "url": "https://www.gnu.org/licenses/gpl-3.0.html"
        }
    },
    "tags": [
        {
            "name": "Public API",
            "description": "Public endpoints accessible without authentication. These are the core endpoints used by display devices to retrieve media content, images, and configuration.\n                    \n**Key Endpoints:**\n- `/get-media`: Primary media playlist endpoint\n- `/proxy`: Image proxy for secure media delivery\n- `/get-config`: Public configuration retrieval"
        },
        {
            "name": "Frontend",
            "description": "Frontend asset serving and template rendering. Serves the HTML/CSS/JS for the display modes and admin interface.\n                    \n**Available Pages:**\n- `/screensaver`: Rotating poster display\n- `/cinema`: Movie theater experience\n- `/wallart`: Gallery-style display\n- `/admin`: Administrative control panel\n- `/admin-analytics`: Analytics dashboard\n\n**Static Assets:**\n- Versioned CSS/JS with cache busting\n- Favicon and branding assets\n- Font files and icons"
        },
        {
            "name": "Authentication",
            "description": "Authentication and authorization system. Posterrama uses session-based authentication with optional 2FA support.\n                    \n**Security Features:**\n- Session management with secure cookies\n- Password hashing (bcrypt)\n- Two-factor authentication (TOTP)\n- API key support for programmatic access\n- Rate limiting on auth endpoints\n\n**Session Lifecycle:**\n- Login creates session cookie (connect.sid)\n- Session persists across requests\n- Logout invalidates session"
        },
        {
            "name": "Security",
            "description": "Security monitoring and violation reporting. Tracks authentication failures, rate limit violations, and suspicious activity.\n                    \n**Security Features:**\n- Failed login tracking\n- Rate limit enforcement\n- Session hijacking protection\n- CSRF protection\n- Security headers (CSP, HSTS)\n- IP-based blocking\n\n**Monitoring:**\n- Real-time security event log\n- Violation statistics\n- IP reputation tracking\n- Alert notifications for security events"
        },
        {
            "name": "Admin",
            "description": "Administrative endpoints for system configuration and management. These endpoints require an active admin session.\n                    \n**Capabilities:**\n- Complete configuration management\n- System monitoring and performance metrics\n- User authentication and session management\n- Backup and restore operations\n- Source connection testing\n\n**Authentication Required**: Session-based (cookie: connect.sid)"
        },
        {
            "name": "Configuration",
            "description": "Application configuration management. Configuration is stored in `config.json` with automatic validation and hot-reloading support.\n                    \n**Configuration Sections:**\n- Media sources (Plex, Jellyfin, TMDB, Local)\n- Display mode settings (Screensaver, Cinema, Wallart)\n- Server settings (port, cache, logging)\n- Device management\n- Security settings\n\n**Best Practices:**\n- Always validate before saving\n- Create backups before major changes\n- Test source connections after updates"
        },
        {
            "name": "Validation",
            "description": "Configuration and data validation endpoints. These endpoints validate configuration changes before applying them, preventing invalid configurations.\n                    \n**Validation Types:**\n- Server connectivity (Plex, Jellyfin)\n- API key validity\n- Configuration schema compliance\n- Port availability\n- File path accessibility"
        },
        {
            "name": "Devices",
            "description": "Device management system for controlling display clients. Posterrama supports registering unlimited devices and organizing them into groups.\n                    \n**Features:**\n- Device registration with pairing codes\n- Real-time status monitoring\n- Per-device settings overrides\n- Heartbeat tracking\n- WebSocket command channel\n\n**Device Lifecycle:**\n1. Register via `/api/devices/register`\n2. Pair with code via `/api/devices/pair`\n3. Send heartbeats via `/api/devices/heartbeat`\n4. Receive commands via WebSocket at `/ws/devices`"
        },
        {
            "name": "Groups",
            "description": "Organize devices into logical groups for coordinated control. Groups enable broadcasting commands to multiple devices simultaneously.\n                    \n**Use Cases:**\n- Floor/room organization\n- Synchronized displays\n- Bulk configuration updates\n- Targeted content delivery\n\n**Operations:**\n- Create and manage groups\n- Assign devices to groups\n- Broadcast commands to all group members"
        },
        {
            "name": "Local Directory",
            "description": "Local media source management for posterpack archives and directory-based media. Supports offline media delivery and custom collections.\n                    \n**Features:**\n- Posterpack generation from Plex/Jellyfin\n- ZIP archive management\n- Directory browsing\n- File upload/download\n- Metadata management\n- Asset extraction (posters, backgrounds, trailers, themes)\n\n**Posterpack Format:**\nA posterpack is a self-contained ZIP archive containing:\n- `metadata.json`: Complete media information\n- `poster.jpg`: Movie/show poster\n- `background.jpg`: Backdrop image\n- `thumbnail.jpg`: Small preview image\n- `trailer.mp4`: Optional trailer video\n- `theme.mp3`: Optional theme music\n- `clearlogo.png`: Optional logo overlay\n- `people/`: Cast/crew photos\n\n**Use Cases:**\n- Offline display setups\n- Custom media collections\n- Pre-packaged content distribution\n- Backup media libraries"
        },
        {
            "name": "Cache",
            "description": "Multi-tier caching system for optimal performance. Posterrama uses memory and disk caching with intelligent invalidation.\n                    \n**Cache Types:**\n- **Memory Cache**: Fast in-memory storage for API responses\n- **Disk Cache**: Persistent image cache\n- **HTTP Cache**: ETags and conditional requests\n- **Browser Cache**: Client-side caching with versioning\n\n**Operations:**\n- View cache statistics\n- Clear specific cache entries\n- Invalidate on configuration changes\n- Configure TTL per endpoint"
        },
        {
            "name": "Metrics",
            "description": "Performance monitoring and metrics collection. Real-time system health, source performance, and cache statistics.\n                    \n**Metrics Categories:**\n- System resources (CPU, memory, uptime)\n- Source performance (response times, error rates)\n- Cache efficiency (hit rate, size, TTL)\n- Request statistics (throughput, latency)\n- Device activity (connections, commands)\n\n**Use Cases:**\n- Performance optimization\n- Troubleshooting slow responses\n- Capacity planning\n- Source reliability monitoring"
        },
        {
            "name": "Auto-Update",
            "description": "Automatic application update system powered by PM2 ecosystem. Safely updates Posterrama to the latest version with rollback support.\n                    \n**Update Process:**\n1. Backup current configuration\n2. Pull latest code from GitHub\n3. Install npm dependencies\n4. Run database migrations (if any)\n5. Restart application gracefully\n6. Verify health post-update\n\n**Safety Features:**\n- Automatic configuration backups\n- Health check verification\n- Rollback on failure\n- Update status tracking\n- Manual control override\n\n**Requirements:**\n- PM2 process manager\n- Git repository access\n- Write permissions to install directory"
        },
        {
            "name": "GitHub Integration",
            "description": "Integration with GitHub API for release information and automatic updates.\n                    \n**Features:**\n- Check for latest releases\n- Download release assets\n- Version comparison\n- Changelog retrieval\n- Release notes display\n\n**Update Process:**\n1. Check `/api/admin/github/latest-release`\n2. Compare with current version\n3. Notify admin of available updates\n4. Optional: Auto-update via updater service"
        },
        {
            "name": "Documentation",
            "description": "API documentation and specification endpoints. Provides access to this interactive documentation and the raw OpenAPI specification.\n                    \n**Endpoints:**\n- `/api-docs`: Interactive ReDoc documentation (this page)\n- `/api-docs/swagger.json`: Raw OpenAPI 3.0 specification\n\n**OpenAPI Spec:**\nThe OpenAPI specification is dynamically generated from JSDoc comments in the source code, ensuring documentation stays synchronized with implementation."
        },
        {
            "name": "Site Server",
            "description": "Public-facing site server for marketing and information pages. Serves static content about Posterrama.\n                    \n**Content:**\n- Project information\n- Installation guides\n- Feature showcase\n- Support resources\n- Community links\n\n**Note:** These endpoints are separate from the application API and do not require authentication."
        }
    ],
    "x-tagGroups": [
        {
            "name": "Core API",
            "tags": ["Public API", "Frontend"]
        },
        {
            "name": "Authentication & Security",
            "tags": ["Authentication", "Security"]
        },
        {
            "name": "Admin & Configuration",
            "tags": ["Admin", "Configuration", "Validation"]
        },
        {
            "name": "Device Management",
            "tags": ["Devices", "Groups"]
        },
        {
            "name": "Media Sources",
            "tags": ["Local Directory"]
        },
        {
            "name": "System Monitoring",
            "tags": ["Cache", "Metrics"]
        },
        {
            "name": "Updates & Integrations",
            "tags": ["Auto-Update", "GitHub Integration"]
        },
        {
            "name": "Utilities",
            "tags": ["Documentation", "Site Server"]
        }
    ],
    "servers": [
        {
            "url": "/",
            "description": "Current server"
        }
    ],
    "components": {
        "securitySchemes": {
            "isAuthenticated": {
                "type": "apiKey",
                "in": "cookie",
                "name": "connect.sid",
                "description": "Session-based authentication (alias for sessionAuth)"
            },
            "sessionAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "connect.sid",
                "description": "Session-based authentication using cookies"
            },
            "bearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT",
                "description": "Bearer token authentication. The application accepts API keys as Bearer tokens."
            },
            "BearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT",
                "description": "Bearer token authentication (alias for bearerAuth)."
            },
            "SessionAuth": {
                "type": "apiKey",
                "in": "cookie",
                "name": "connect.sid",
                "description": "Session-based authentication (alias for sessionAuth)"
            },
            "ApiKeyAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "API-Key",
                "description": "API Key authentication using Bearer scheme"
            }
        },
        "schemas": {
            "StandardOkResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean",
                        "example": true
                    }
                },
                "example": {
                    "ok": true
                }
            },
            "BackupCreateResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean",
                        "example": true
                    },
                    "backup": {
                        "$ref": "#/components/schemas/BackupRecord"
                    }
                },
                "example": {
                    "ok": true,
                    "backup": {
                        "id": "config-backup-1730000000000",
                        "createdAt": "2025-10-25T12:00:00.000Z",
                        "sizeBytes": 4096,
                        "type": "manual"
                    }
                }
            },
            "BackupRecord": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string",
                        "description": "Backup identifier (filename or UUID)"
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "sizeBytes": {
                        "type": "integer"
                    },
                    "type": {
                        "type": "string",
                        "description": "backup type (manual|auto|upgrade)"
                    }
                }
            },
            "BackupListResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean"
                    },
                    "backups": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/BackupRecord"
                        }
                    }
                }
            },
            "BackupCleanupResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean"
                    },
                    "removed": {
                        "type": "integer"
                    },
                    "retained": {
                        "type": "integer"
                    }
                }
            },
            "BackupRestoreResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean"
                    },
                    "restored": {
                        "type": "boolean"
                    },
                    "backup": {
                        "$ref": "#/components/schemas/BackupRecord"
                    }
                }
            },
            "BackupDeleteResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean"
                    },
                    "deleted": {
                        "type": "boolean"
                    },
                    "id": {
                        "type": "string"
                    }
                }
            },
            "BackupSchedule": {
                "type": "object",
                "properties": {
                    "enabled": {
                        "type": "boolean"
                    },
                    "cron": {
                        "type": "string",
                        "description": "Cron expression for automated backups"
                    },
                    "retain": {
                        "type": "integer",
                        "description": "How many backups to retain"
                    }
                }
            },
            "BackupScheduleResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean"
                    },
                    "schedule": {
                        "$ref": "#/components/schemas/BackupSchedule"
                    }
                }
            },
            "NotificationTestRequest": {
                "type": "object",
                "properties": {
                    "level": {
                        "type": "string",
                        "enum": ["info", "warn", "error"],
                        "default": "warn"
                    },
                    "message": {
                        "type": "string"
                    }
                }
            },
            "NotificationTestResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean"
                    },
                    "level": {
                        "type": "string"
                    },
                    "message": {
                        "type": "string"
                    }
                }
            },
            "StandardErrorResponse": {
                "type": "object",
                "properties": {
                    "error": {
                        "type": "string",
                        "description": "Error message",
                        "example": "Invalid request"
                    },
                    "code": {
                        "type": "string",
                        "description": "Optional machine-readable code",
                        "example": "VALIDATION_ERROR"
                    }
                },
                "example": {
                    "error": "Invalid request",
                    "code": "VALIDATION_ERROR"
                }
            },
            "PaginatedMediaResponse": {
                "type": "object",
                "description": "Generic paginated media list wrapper",
                "properties": {
                    "ok": {
                        "type": "boolean",
                        "example": true
                    },
                    "total": {
                        "type": "integer",
                        "description": "Total items available (may be capped)",
                        "example": 150
                    },
                    "page": {
                        "type": "integer",
                        "description": "Current page index (1-based)",
                        "example": 1
                    },
                    "pageSize": {
                        "type": "integer",
                        "description": "Requested page size",
                        "example": 20
                    },
                    "items": {
                        "type": "array",
                        "description": "Media items (shape depends on source aggregation)",
                        "items": {
                            "type": "object"
                        }
                    }
                },
                "example": {
                    "ok": true,
                    "total": 150,
                    "page": 1,
                    "pageSize": 20,
                    "items": []
                }
            },
            "Device": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string",
                        "description": "Unique device identifier"
                    },
                    "name": {
                        "type": "string",
                        "description": "Human-friendly name"
                    },
                    "location": {
                        "type": "string",
                        "description": "Optional physical location"
                    },
                    "tags": {
                        "type": "array",
                        "description": "Custom device tags",
                        "items": {
                            "type": "string"
                        }
                    },
                    "groups": {
                        "type": "array",
                        "description": "Assigned group IDs",
                        "items": {
                            "type": "string"
                        }
                    },
                    "installId": {
                        "type": "string",
                        "nullable": true,
                        "description": "Browser/session install identifier (nullable)"
                    },
                    "hardwareId": {
                        "type": "string",
                        "nullable": true,
                        "description": "Stable hardware identifier when available (nullable)"
                    },
                    "createdAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "updatedAt": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "lastSeenAt": {
                        "type": "string",
                        "format": "date-time",
                        "nullable": true
                    },
                    "status": {
                        "type": "string",
                        "description": "Reported status",
                        "enum": ["unknown", "online", "offline"]
                    },
                    "clientInfo": {
                        "type": "object",
                        "properties": {
                            "userAgent": {
                                "type": "string"
                            },
                            "screen": {
                                "type": "object",
                                "properties": {
                                    "w": {
                                        "type": "integer"
                                    },
                                    "h": {
                                        "type": "integer"
                                    },
                                    "dpr": {
                                        "type": "number"
                                    }
                                }
                            },
                            "mode": {
                                "type": "string"
                            }
                        }
                    },
                    "settingsOverride": {
                        "type": "object",
                        "description": "Per-device settings override payload"
                    },
                    "preset": {
                        "type": "string",
                        "description": "Optional preset name"
                    },
                    "currentState": {
                        "type": "object",
                        "properties": {
                            "mediaId": {
                                "type": "string",
                                "nullable": true
                            },
                            "paused": {
                                "type": "boolean",
                                "nullable": true
                            },
                            "pinned": {
                                "type": "boolean",
                                "nullable": true
                            },
                            "pinMediaId": {
                                "type": "string",
                                "nullable": true
                            },
                            "poweredOff": {
                                "type": "boolean",
                                "nullable": true
                            }
                        }
                    },
                    "wsConnected": {
                        "type": "boolean",
                        "description": "Derived flag indicating active WebSocket connection"
                    }
                }
            },
            "DeviceRegisterRequest": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "location": {
                        "type": "string"
                    },
                    "installId": {
                        "type": "string",
                        "nullable": true
                    },
                    "hardwareId": {
                        "type": "string",
                        "nullable": true
                    }
                }
            },
            "DeviceRegisterResponse": {
                "type": "object",
                "required": ["deviceId", "deviceSecret"],
                "properties": {
                    "deviceId": {
                        "type": "string",
                        "example": "dev_abc123xyz"
                    },
                    "deviceSecret": {
                        "type": "string",
                        "example": "$2b$10$abcdefghijklmnopqrstuvwxyz1234567890",
                        "description": "Bcrypt hashed secret - store securely"
                    }
                },
                "example": {
                    "deviceId": "dev_abc123xyz",
                    "deviceSecret": "$2b$10$abcdefghijklmnopqrstuvwxyz1234567890"
                }
            },
            "DeviceQueuedCommand": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string",
                        "description": "Server-assigned queue id"
                    },
                    "type": {
                        "type": "string"
                    },
                    "payload": {
                        "type": "object"
                    }
                }
            },
            "DeviceHeartbeatRequest": {
                "type": "object",
                "required": ["deviceId", "deviceSecret"],
                "properties": {
                    "deviceId": {
                        "type": "string"
                    },
                    "deviceSecret": {
                        "type": "string"
                    },
                    "userAgent": {
                        "type": "string"
                    },
                    "screen": {
                        "type": "object",
                        "properties": {
                            "w": {
                                "type": "integer"
                            },
                            "h": {
                                "type": "integer"
                            },
                            "dpr": {
                                "type": "number"
                            }
                        }
                    },
                    "mode": {
                        "type": "string"
                    },
                    "mediaId": {
                        "type": "string"
                    },
                    "paused": {
                        "type": "boolean"
                    },
                    "pinned": {
                        "type": "boolean"
                    },
                    "pinMediaId": {
                        "type": "string"
                    },
                    "poweredOff": {
                        "type": "boolean"
                    },
                    "installId": {
                        "type": "string"
                    },
                    "hardwareId": {
                        "type": "string"
                    }
                }
            },
            "DeviceHeartbeatResponse": {
                "type": "object",
                "properties": {
                    "serverTime": {
                        "type": "integer",
                        "example": 1730000000000
                    },
                    "commandsQueued": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/DeviceQueuedCommand"
                        }
                    }
                },
                "example": {
                    "serverTime": 1730000000000,
                    "commandsQueued": []
                }
            },
            "PairingCodeRequest": {
                "type": "object",
                "properties": {
                    "ttlMs": {
                        "type": "integer",
                        "description": "TTL in milliseconds (min 60000, max 3600000)",
                        "example": 600000
                    }
                }
            },
            "PairingCodeResponse": {
                "type": "object",
                "properties": {
                    "code": {
                        "type": "string",
                        "description": "Numeric pairing code",
                        "example": "123456"
                    },
                    "token": {
                        "type": "string",
                        "description": "One-time token (only shown once) for added security",
                        "example": "tok_abc123xyz789"
                    },
                    "expiresAt": {
                        "type": "string",
                        "format": "date-time",
                        "example": "2025-10-25T12:10:00.000Z"
                    }
                },
                "example": {
                    "code": "123456",
                    "token": "tok_abc123xyz789",
                    "expiresAt": "2025-10-25T12:10:00.000Z"
                }
            },
            "PairingClaimRequest": {
                "type": "object",
                "required": ["code"],
                "properties": {
                    "code": {
                        "type": "string"
                    },
                    "token": {
                        "type": "string",
                        "description": "Token from PairingCodeResponse"
                    },
                    "name": {
                        "type": "string"
                    },
                    "location": {
                        "type": "string"
                    }
                }
            },
            "PairingClaimResponse": {
                "type": "object",
                "properties": {
                    "deviceId": {
                        "type": "string"
                    },
                    "deviceSecret": {
                        "type": "string"
                    }
                }
            },
            "DeviceCommandRequest": {
                "type": "object",
                "required": ["type"],
                "properties": {
                    "type": {
                        "type": "string",
                        "description": "Command type (e.g., reload, clear-cache, next, prev)"
                    },
                    "payload": {
                        "type": "object"
                    }
                }
            },
            "DeviceCommandResponse": {
                "type": "object",
                "properties": {
                    "queued": {
                        "type": "boolean"
                    },
                    "live": {
                        "type": "boolean"
                    },
                    "command": {
                        "$ref": "#/components/schemas/DeviceQueuedCommand"
                    }
                }
            },
            "DeviceCommandAck": {
                "type": "object",
                "properties": {
                    "status": {
                        "type": "string",
                        "enum": ["ok", "timeout", "error"]
                    },
                    "info": {
                        "type": "object",
                        "nullable": true
                    }
                }
            },
            "Group": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "settingsTemplate": {
                        "type": "object",
                        "description": "Settings template applied to group members"
                    },
                    "order": {
                        "type": "integer",
                        "description": "Sort order (ascending)"
                    }
                }
            },
            "GroupCommandResult": {
                "type": "object",
                "properties": {
                    "deviceId": {
                        "type": "string"
                    },
                    "status": {
                        "type": "string",
                        "description": "Per-device status",
                        "enum": ["ok", "timeout", "queued", "error"]
                    },
                    "detail": {
                        "type": "string",
                        "nullable": true
                    }
                }
            },
            "DevicePatchRequest": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "location": {
                        "type": "string"
                    },
                    "tags": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "groups": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    },
                    "settingsOverride": {
                        "type": "object"
                    },
                    "preset": {
                        "type": "string"
                    }
                }
            },
            "GroupCreateRequest": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "settingsTemplate": {
                        "type": "object"
                    },
                    "order": {
                        "type": "integer"
                    }
                }
            },
            "GroupPatchRequest": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    },
                    "settingsTemplate": {
                        "type": "object"
                    },
                    "order": {
                        "type": "integer"
                    }
                }
            },
            "DeviceMergeRequest": {
                "type": "object",
                "required": ["sourceIds"],
                "properties": {
                    "sourceIds": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "IDs of devices to merge into target"
                    }
                }
            },
            "GroupCommandResponse": {
                "type": "object",
                "properties": {
                    "ok": {
                        "type": "boolean"
                    },
                    "live": {
                        "type": "integer"
                    },
                    "queued": {
                        "type": "integer"
                    },
                    "total": {
                        "type": "integer"
                    },
                    "results": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/GroupCommandResult"
                        }
                    }
                }
            },
            "Config": {
                "type": "object",
                "properties": {
                    "clockWidget": {
                        "type": "boolean",
                        "description": "Whether the clock widget is enabled."
                    },
                    "transitionIntervalSeconds": {
                        "type": "integer",
                        "description": "Time in seconds between media transitions."
                    },
                    "backgroundRefreshMinutes": {
                        "type": "integer",
                        "description": "How often the media playlist is refreshed from the server."
                    },
                    "showClearLogo": {
                        "type": "boolean",
                        "description": "Whether the ClearLogo image should be displayed."
                    },
                    "showPoster": {
                        "type": "boolean",
                        "description": "Whether the poster image should be displayed."
                    },
                    "showMetadata": {
                        "type": "boolean",
                        "description": "Whether metadata text (tagline, year, etc.) should be displayed."
                    },
                    "showRottenTomatoes": {
                        "type": "boolean",
                        "description": "Whether the Rotten Tomatoes badge should be displayed."
                    },
                    "rottenTomatoesMinimumScore": {
                        "type": "number",
                        "description": "Minimum score (scale 0-10) for an item to be included if it has a Rotten Tomatoes rating. A value of 7.5 corresponds to 75%."
                    },
                    "kenBurnsEffect": {
                        "type": "object",
                        "properties": {
                            "enabled": {
                                "type": "boolean"
                            },
                            "durationSeconds": {
                                "type": "integer"
                            }
                        }
                    },
                    "isPublicSite": {
                        "type": "boolean",
                        "description": "Flag indicating if this is the public site server (added by site server proxy)."
                    }
                }
            },
            "MediaItem": {
                "type": "object",
                "description": "A media item from any source (Plex, Jellyfin, TMDB, or Local). Contains all metadata needed to display the poster and additional information.",
                "properties": {
                    "key": {
                        "type": "string",
                        "description": "A unique identifier for the media item, composed of source type, server name, and item ID (e.g., \"plex-MyServer-12345\", \"jellyfin-Home-67890\", \"tmdb-movie-550\").",
                        "example": "plex-MyPlexServer-12345"
                    },
                    "title": {
                        "type": "string",
                        "description": "Title of the movie or TV show",
                        "example": "Blade Runner 2049"
                    },
                    "backgroundUrl": {
                        "type": "string",
                        "format": "uri",
                        "description": "URL to the background/backdrop image, proxied through /proxy endpoint to hide server details.",
                        "example": "/proxy?server=MyPlexServer&path=/library/metadata/12345/art/1234567890"
                    },
                    "posterUrl": {
                        "type": "string",
                        "format": "uri",
                        "description": "URL to the poster image, proxied through /proxy endpoint.",
                        "example": "/proxy?server=MyPlexServer&path=/library/metadata/12345/thumb/1234567890"
                    },
                    "thumbnailUrl": {
                        "type": "string",
                        "format": "uri",
                        "nullable": true,
                        "description": "URL to a smaller thumbnail image when available (primarily from Local posterpacks). Useful for gallery views.",
                        "example": "/local-posterpack?zip=complete/plex-export/Blade%20Runner%202049%20(2017).zip&entry=thumbnail"
                    },
                    "clearLogoUrl": {
                        "type": "string",
                        "format": "uri",
                        "nullable": true,
                        "description": "URL to the ClearLogo image (transparent logo), proxied through the app. Great for overlays.",
                        "example": "/proxy?server=MyPlexServer&path=/library/metadata/12345/clearlogo"
                    },
                    "tagline": {
                        "type": "string",
                        "nullable": true,
                        "description": "Movie tagline or short description",
                        "example": "The key to the future is finally unearthed."
                    },
                    "rating": {
                        "type": "number",
                        "nullable": true,
                        "description": "The general audience rating on a scale (typically 0-10).",
                        "example": 8
                    },
                    "year": {
                        "type": "integer",
                        "nullable": true,
                        "description": "Release year",
                        "example": 2017
                    },
                    "imdbUrl": {
                        "type": "string",
                        "format": "uri",
                        "nullable": true,
                        "description": "Direct link to the IMDb page for this item.",
                        "example": "https://www.imdb.com/title/tt1856101/"
                    },
                    "rottenTomatoes": {
                        "type": "object",
                        "nullable": true,
                        "description": "Rotten Tomatoes score information when available",
                        "properties": {
                            "score": {
                                "type": "integer",
                                "description": "The Rotten Tomatoes score (0-100).",
                                "example": 88
                            },
                            "icon": {
                                "type": "string",
                                "enum": ["fresh", "rotten", "certified-fresh"],
                                "description": "The corresponding RT freshness icon.",
                                "example": "certified-fresh"
                            },
                            "originalScore": {
                                "type": "number",
                                "description": "The original score from the source before conversion to 0-100 scale.",
                                "example": 8.8
                            }
                        }
                    },
                    "extras": {
                        "type": "array",
                        "nullable": true,
                        "description": "Array of extras (trailers, behind the scenes, deleted scenes, interviews, etc.). Only populated when includeExtras=true query parameter is set. Available for Plex and Jellyfin sources only.",
                        "items": {
                            "type": "object",
                            "properties": {
                                "type": {
                                    "type": "string",
                                    "description": "Type of extra content",
                                    "example": "clip",
                                    "enum": [
                                        "clip",
                                        "behindTheScenes",
                                        "deletedScene",
                                        "interview",
                                        "sceneOrSample",
                                        "featurette",
                                        "short"
                                    ]
                                },
                                "title": {
                                    "type": "string",
                                    "description": "Title of the extra",
                                    "example": "Official Trailer"
                                },
                                "thumb": {
                                    "type": "string",
                                    "format": "uri",
                                    "nullable": true,
                                    "description": "Thumbnail image URL for the extra",
                                    "example": "/proxy?server=MyPlexServer&path=/library/metadata/12346/thumb"
                                },
                                "key": {
                                    "type": "string",
                                    "description": "Server-specific key/ID for the extra (used to construct streaming URLs)",
                                    "example": "/library/metadata/12346"
                                },
                                "duration": {
                                    "type": "integer",
                                    "nullable": true,
                                    "description": "Duration in milliseconds",
                                    "example": 155000
                                },
                                "year": {
                                    "type": "integer",
                                    "nullable": true,
                                    "example": 2017
                                },
                                "addedAt": {
                                    "type": "integer",
                                    "nullable": true,
                                    "description": "Timestamp when extra was added (Unix timestamp in seconds)",
                                    "example": 1635724800
                                }
                            }
                        },
                        "example": [
                            {
                                "type": "clip",
                                "title": "Official Trailer",
                                "thumb": "/proxy?server=MyPlexServer&path=/library/metadata/12346/thumb",
                                "key": "/library/metadata/12346",
                                "duration": 155000,
                                "year": 2017,
                                "addedAt": 1635724800
                            },
                            {
                                "type": "behindTheScenes",
                                "title": "Making Of",
                                "thumb": "/proxy?server=MyPlexServer&path=/library/metadata/12347/thumb",
                                "key": "/library/metadata/12347",
                                "duration": 892000,
                                "year": 2017,
                                "addedAt": 1635724800
                            }
                        ]
                    },
                    "trailer": {
                        "type": "object",
                        "nullable": true,
                        "description": "First trailer from the extras array for convenience. Only populated when includeExtras=true. Provides quick access to the main trailer without filtering the extras array.",
                        "properties": {
                            "type": {
                                "type": "string",
                                "example": "clip"
                            },
                            "title": {
                                "type": "string",
                                "example": "Official Trailer"
                            },
                            "thumb": {
                                "type": "string",
                                "format": "uri",
                                "nullable": true,
                                "example": "/proxy?server=MyPlexServer&path=/library/metadata/12346/thumb"
                            },
                            "key": {
                                "type": "string",
                                "description": "Key to fetch full trailer metadata and construct streaming URL",
                                "example": "/library/metadata/12346"
                            },
                            "duration": {
                                "type": "integer",
                                "nullable": true,
                                "example": 155000
                            },
                            "year": {
                                "type": "integer",
                                "nullable": true,
                                "example": 2017
                            },
                            "addedAt": {
                                "type": "integer",
                                "nullable": true,
                                "example": 1635724800
                            }
                        },
                        "example": {
                            "type": "clip",
                            "title": "Official Trailer",
                            "thumb": "/proxy?server=MyPlexServer&path=/library/metadata/12346/thumb",
                            "key": "/library/metadata/12346",
                            "duration": 155000,
                            "year": 2017,
                            "addedAt": 1635724800
                        }
                    },
                    "theme": {
                        "type": "string",
                        "nullable": true,
                        "description": "Raw theme music path from Plex (e.g., /library/metadata/12345/theme/1234567890). Only populated when includeExtras=true for Plex sources with theme music.",
                        "example": "/library/metadata/12345/theme/1730000000"
                    },
                    "themeUrl": {
                        "type": "string",
                        "format": "uri",
                        "nullable": true,
                        "description": "Proxied theme music URL for streaming (e.g., /proxy/plex?server=...&path=...). Only populated when includeExtras=true for Plex sources with theme music. Note: Direct streaming via /proxy/plex endpoint is planned but not yet implemented. For now, use /get-media?includeExtras=true and construct URLs manually.",
                        "example": "/proxy?server=MyPlexServer&path=/library/metadata/12345/theme/1730000000"
                    },
                    "_raw": {
                        "type": "object",
                        "description": "Raw metadata from the media server (only included when debug mode is enabled in config). Useful for development and troubleshooting."
                    }
                },
                "example": {
                    "key": "plex-MyPlexServer-12345",
                    "title": "Blade Runner 2049",
                    "backgroundUrl": "/proxy?server=MyPlexServer&path=/library/metadata/12345/art/1234567890",
                    "posterUrl": "/proxy?server=MyPlexServer&path=/library/metadata/12345/thumb/1234567890",
                    "thumbnailUrl": null,
                    "clearLogoUrl": "/proxy?server=MyPlexServer&path=/library/metadata/12345/clearlogo",
                    "tagline": "The key to the future is finally unearthed.",
                    "rating": 8,
                    "year": 2017,
                    "imdbUrl": "https://www.imdb.com/title/tt1856101/",
                    "rottenTomatoes": {
                        "score": 88,
                        "icon": "certified-fresh",
                        "originalScore": 8.8
                    },
                    "extras": [
                        {
                            "type": "clip",
                            "title": "Official Trailer",
                            "thumb": "/proxy?server=MyPlexServer&path=/library/metadata/12346/thumb",
                            "key": "/library/metadata/12346",
                            "duration": 155000,
                            "year": 2017,
                            "addedAt": 1635724800
                        }
                    ],
                    "trailer": {
                        "type": "clip",
                        "title": "Official Trailer",
                        "thumb": "/proxy?server=MyPlexServer&path=/library/metadata/12346/thumb",
                        "key": "/library/metadata/12346",
                        "duration": 155000,
                        "year": 2017,
                        "addedAt": 1635724800
                    },
                    "theme": "/library/metadata/12345/theme/1730000000",
                    "themeUrl": "/proxy?server=MyPlexServer&path=/library/metadata/12345/theme/1730000000"
                }
            },
            "ApiMessage": {
                "type": "object",
                "properties": {
                    "status": {
                        "type": "string",
                        "example": "building"
                    },
                    "message": {
                        "type": "string",
                        "example": "Playlist is being built. Please try again in a few seconds."
                    },
                    "retryIn": {
                        "type": "integer",
                        "example": 2000
                    },
                    "error": {
                        "type": "string"
                    }
                }
            },
            "AdminApiResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": true
                    },
                    "message": {
                        "type": "string"
                    },
                    "error": {
                        "type": "string"
                    }
                }
            },
            "PlexConnectionRequest": {
                "type": "object",
                "required": ["hostname", "port"],
                "properties": {
                    "hostname": {
                        "type": "string",
                        "description": "The hostname or IP address of the Plex server.",
                        "example": "192.168.1.10"
                    },
                    "port": {
                        "type": "integer",
                        "description": "The port of the Plex server.",
                        "example": 32400
                    },
                    "token": {
                        "type": "string",
                        "description": "The Plex X-Plex-Token. Optional when testing, required when fetching libraries if none is configured."
                    }
                }
            },
            "PlexLibrary": {
                "type": "object",
                "properties": {
                    "key": {
                        "type": "string",
                        "description": "The unique key of the library.",
                        "example": "1"
                    },
                    "name": {
                        "type": "string",
                        "description": "The name of the library.",
                        "example": "Movies"
                    },
                    "type": {
                        "type": "string",
                        "description": "The type of the library.",
                        "example": "movie",
                        "enum": ["movie", "show", "artist"]
                    }
                }
            },
            "PlexLibrariesResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": true
                    },
                    "libraries": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/PlexLibrary"
                        }
                    }
                }
            },
            "AdminConfigResponse": {
                "type": "object",
                "properties": {
                    "config": {
                        "type": "object",
                        "description": "The complete contents of config.json."
                    },
                    "env": {
                        "type": "object",
                        "description": "A selection of relevant environment variables."
                    },
                    "security": {
                        "type": "object",
                        "properties": {
                            "is2FAEnabled": {
                                "type": "boolean",
                                "description": "Indicates whether 2FA is enabled for the admin."
                            }
                        }
                    }
                }
            },
            "SaveConfigRequest": {
                "type": "object",
                "properties": {
                    "config": {
                        "type": "object",
                        "description": "The complete config.json object to save."
                    },
                    "env": {
                        "type": "object",
                        "description": "Key-value pairs of environment variables to save."
                    }
                }
            },
            "ChangePasswordRequest": {
                "type": "object",
                "required": ["currentPassword", "newPassword", "confirmPassword"],
                "properties": {
                    "currentPassword": {
                        "type": "string",
                        "format": "password"
                    },
                    "newPassword": {
                        "type": "string",
                        "format": "password"
                    },
                    "confirmPassword": {
                        "type": "string",
                        "format": "password"
                    }
                }
            },
            "Generate2FAResponse": {
                "type": "object",
                "properties": {
                    "qrCodeDataUrl": {
                        "type": "string",
                        "format": "uri",
                        "description": "A data URI of the QR code image that can be scanned."
                    }
                }
            },
            "Verify2FARequest": {
                "type": "object",
                "required": ["token"],
                "properties": {
                    "token": {
                        "type": "string",
                        "description": "The 6-digit TOTP code from the authenticator app."
                    }
                }
            },
            "Disable2FARequest": {
                "type": "object",
                "required": ["password"],
                "properties": {
                    "password": {
                        "type": "string",
                        "format": "password",
                        "description": "The current admin password of the user."
                    }
                }
            },
            "DebugResponse": {
                "type": "object",
                "properties": {
                    "note": {
                        "type": "string",
                        "description": "A note about the contents of the response."
                    },
                    "playlist_item_count": {
                        "type": "integer",
                        "description": "The number of items in the current playlist cache."
                    },
                    "playlist_items_raw": {
                        "type": "array",
                        "description": "An array of the raw media objects as received from the media server.",
                        "items": {
                            "type": "object"
                        }
                    }
                }
            },
            "ApiKeyResponse": {
                "type": "object",
                "properties": {
                    "apiKey": {
                        "type": "string",
                        "description": "The newly generated API key. Will only be shown once.",
                        "example": "pk_live_1234567890abcdefghijklmnop"
                    },
                    "message": {
                        "type": "string",
                        "example": "API key generated successfully"
                    }
                },
                "example": {
                    "apiKey": "pk_live_1234567890abcdefghijklmnop",
                    "message": "API key generated successfully. Store this securely - it will not be shown again."
                }
            },
            "RefreshMediaResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": true
                    },
                    "message": {
                        "type": "string",
                        "example": "Media playlist successfully refreshed. 150 items found."
                    },
                    "itemCount": {
                        "type": "integer",
                        "example": 150,
                        "description": "Number of media items found after refresh."
                    }
                },
                "example": {
                    "success": true,
                    "message": "Media playlist successfully refreshed. 150 items found.",
                    "itemCount": 150
                }
            },
            "LogEntry": {
                "type": "object",
                "properties": {
                    "timestamp": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "level": {
                        "type": "string",
                        "enum": ["TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL"]
                    },
                    "message": {
                        "type": "string"
                    }
                }
            },
            "ErrorResponse": {
                "type": "object",
                "properties": {
                    "error": {
                        "type": "string",
                        "description": "Error message describing what went wrong."
                    }
                }
            },
            "BasicHealthResponse": {
                "type": "object",
                "required": ["status", "service", "version", "timestamp", "uptime"],
                "properties": {
                    "status": {
                        "type": "string",
                        "enum": ["ok"],
                        "description": "Service status",
                        "example": "ok"
                    },
                    "service": {
                        "type": "string",
                        "description": "Service name",
                        "example": "posterrama"
                    },
                    "version": {
                        "type": "string",
                        "description": "Service version",
                        "example": "1.2.5"
                    },
                    "timestamp": {
                        "type": "string",
                        "format": "date-time",
                        "description": "Current timestamp",
                        "example": "2025-07-27T12:00:00Z"
                    },
                    "uptime": {
                        "type": "number",
                        "description": "Process uptime in seconds",
                        "example": 3600
                    }
                }
            },
            "HealthCheckResult": {
                "type": "object",
                "required": ["name", "status", "message"],
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "The name of the check performed",
                        "example": "Connection: Plex Server (plex)"
                    },
                    "status": {
                        "type": "string",
                        "enum": ["ok", "warn", "error"],
                        "description": "The status of the check",
                        "example": "ok"
                    },
                    "message": {
                        "type": "string",
                        "description": "A descriptive message about the check result",
                        "example": "Connection successful"
                    },
                    "details": {
                        "type": "object",
                        "description": "Additional details about the check"
                    }
                }
            },
            "HealthCheckResponse": {
                "type": "object",
                "required": ["status", "timestamp", "checks"],
                "properties": {
                    "status": {
                        "type": "string",
                        "enum": ["ok", "error", "error"],
                        "description": "Overall health status of the application",
                        "example": "ok"
                    },
                    "timestamp": {
                        "type": "string",
                        "format": "date-time",
                        "description": "Timestamp when the health check was performed",
                        "example": "2025-07-27T12:00:00Z"
                    },
                    "checks": {
                        "type": "array",
                        "description": "List of individual health check results",
                        "items": {
                            "$ref": "#/components/schemas/HealthCheckResult"
                        }
                    }
                }
            },
            "ValidationResponse": {
                "type": "object",
                "properties": {
                    "valid": {
                        "type": "boolean",
                        "description": "Whether the data is valid",
                        "example": true
                    },
                    "message": {
                        "type": "string",
                        "description": "Validation result message",
                        "example": "Validation passed"
                    },
                    "sanitized": {
                        "type": "object",
                        "description": "Sanitized data if validation passed"
                    },
                    "errors": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "List of validation errors if any"
                    }
                },
                "example": {
                    "valid": true,
                    "message": "Validation passed",
                    "sanitized": {},
                    "errors": []
                }
            },
            "PlexTestResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the connection test was successful"
                    },
                    "message": {
                        "type": "string",
                        "description": "Result message"
                    },
                    "serverInfo": {
                        "type": "object",
                        "description": "Plex server information if successful"
                    }
                }
            },
            "ApiKeyStatusResponse": {
                "type": "object",
                "properties": {
                    "hasApiKey": {
                        "type": "boolean",
                        "description": "Whether an API key is configured"
                    },
                    "keyId": {
                        "type": "string",
                        "description": "ID of the current API key"
                    }
                }
            },
            "MetricsResponse": {
                "type": "object",
                "properties": {
                    "performance": {
                        "type": "object",
                        "description": "Performance metrics"
                    },
                    "endpoints": {
                        "type": "object",
                        "description": "Endpoint usage metrics"
                    },
                    "system": {
                        "type": "object",
                        "description": "System resource metrics"
                    },
                    "cache": {
                        "type": "object",
                        "description": "Cache usage metrics"
                    }
                }
            },
            "GenreResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether the genre fetch was successful"
                    },
                    "genres": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "List of available genres"
                    }
                }
            },
            "LoginRequest": {
                "type": "object",
                "required": ["username", "password"],
                "properties": {
                    "username": {
                        "type": "string",
                        "description": "Username for authentication"
                    },
                    "password": {
                        "type": "string",
                        "format": "password",
                        "description": "Password for authentication"
                    }
                }
            },
            "LoginResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "description": "Whether login was successful",
                        "example": true
                    },
                    "requires2FA": {
                        "type": "boolean",
                        "description": "Whether 2FA verification is required",
                        "example": false
                    },
                    "redirectTo": {
                        "type": "string",
                        "description": "URL to redirect to after login",
                        "example": "/admin"
                    },
                    "message": {
                        "type": "string",
                        "description": "Login result message",
                        "example": "Login successful"
                    }
                },
                "example": {
                    "success": true,
                    "requires2FA": false,
                    "redirectTo": "/admin",
                    "message": "Login successful"
                }
            },
            "SessionResponse": {
                "type": "object",
                "properties": {
                    "sessions": {
                        "type": "array",
                        "description": "List of active user sessions"
                    }
                }
            },
            "TMDBConnectionRequest": {
                "type": "object",
                "required": ["apiKey"],
                "properties": {
                    "apiKey": {
                        "type": "string",
                        "description": "The TMDB API key"
                    }
                }
            },
            "TMDBGenresResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": true
                    },
                    "genres": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "List of TMDB genres"
                    }
                }
            },
            "PlexGenresResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": true
                    },
                    "genres": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "List of Plex genres"
                    }
                }
            },
            "GitHubRelease": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer"
                    },
                    "tag_name": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "body": {
                        "type": "string"
                    },
                    "published_at": {
                        "type": "string",
                        "format": "date-time"
                    },
                    "prerelease": {
                        "type": "boolean"
                    }
                }
            },
            "GitHubReleaseResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": true
                    },
                    "release": {
                        "$ref": "#/components/schemas/GitHubRelease"
                    }
                }
            },
            "UpdateCheckResponse": {
                "type": "object",
                "properties": {
                    "success": {
                        "type": "boolean",
                        "example": true
                    },
                    "hasUpdate": {
                        "type": "boolean",
                        "example": true
                    },
                    "currentVersion": {
                        "type": "string",
                        "example": "2.8.0"
                    },
                    "latestVersion": {
                        "type": "string",
                        "example": "2.8.1"
                    },
                    "releaseInfo": {
                        "$ref": "#/components/schemas/GitHubRelease"
                    }
                },
                "example": {
                    "success": true,
                    "hasUpdate": true,
                    "currentVersion": "2.8.0",
                    "latestVersion": "2.8.1",
                    "releaseInfo": {
                        "id": 123456,
                        "tag_name": "v2.8.1",
                        "name": "Release 2.8.1",
                        "body": "## Bug Fixes\n- Fixed MQTT broker display issue",
                        "published_at": "2025-10-25T10:00:00Z",
                        "prerelease": false
                    }
                }
            }
        }
    },
    "paths": {
        "/api/v1/config": {
            "get": {
                "summary": "Get configuration (v1 API alias)",
                "description": "Version 1 API alias that redirects to the main configuration endpoint /get-config",
                "tags": ["Public API"],
                "responses": {
                    "200": {
                        "description": "Configuration data (handled by /get-config endpoint)",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Config"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/media": {
            "get": {
                "summary": "Get media data (v1 API alias)",
                "description": "Version 1 API alias that redirects to the main media endpoint /get-media",
                "tags": ["Public API"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "search",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Search term to filter media"
                    },
                    {
                        "in": "query",
                        "name": "year",
                        "schema": {
                            "type": "integer"
                        },
                        "description": "Filter by year"
                    },
                    {
                        "in": "query",
                        "name": "genre",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Filter by genre"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Media data (handled by /get-media endpoint)",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/MediaItem"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/": {
            "get": {
                "summary": "Main index/landing page",
                "description": "Serves the landing page with configurable redirect behavior",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "Landing page HTML",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "302": {
                        "description": "Redirect to display mode (if configured)"
                    }
                }
            }
        },
        "/index.html": {
            "get": {
                "summary": "Serve main application HTML (alternative route)",
                "description": "Alternative route for main application HTML with asset version stamping",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "Main application HTML",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/local-media/{path}": {
            "get": {
                "summary": "Serve local media files",
                "description": "Serves images and videos from configured local directories.\nThis endpoint is disabled by default for security.\nLocal media can be accessed via /local-posterpack for ZIP contents.\n",
                "tags": ["Local Media"],
                "parameters": [
                    {
                        "name": "path",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Relative path to media file (e.g., posters/Movie.jpg)"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Media file content",
                        "content": {
                            "image/jpeg": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            },
                            "image/png": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            },
                            "video/mp4": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Local directory support not enabled or direct serving disabled"
                    }
                }
            }
        },
        "/local-posterpack": {
            "get": {
                "summary": "Stream assets from posterpack ZIP files",
                "description": "Streams poster, background, clearlogo, thumbnail, or banner directly from a posterpack ZIP\nwithout extraction. Used for serving local media from compressed archives.\n",
                "tags": ["Local Media"],
                "parameters": [
                    {
                        "name": "zip",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Relative path to ZIP file (e.g., complete/manual/Movie (2024).zip)",
                        "example": "complete/manual/Movie (2024).zip"
                    },
                    {
                        "name": "entry",
                        "in": "query",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": ["poster", "background", "clearlogo", "thumbnail", "banner"]
                        },
                        "description": "Type of asset to extract from ZIP",
                        "example": "poster"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Image content from ZIP",
                        "content": {
                            "image/jpeg": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            },
                            "image/png": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing parameters or invalid zip path/entry type"
                    },
                    "404": {
                        "description": "Local directory support not enabled or file not found"
                    },
                    "500": {
                        "description": "Error reading ZIP file"
                    }
                }
            }
        },
        "/api/admin/filter-preview": {
            "post": {
                "summary": "Preview filter results for admin configuration",
                "description": "Admin-only. Generates a preview of media results given filter criteria without caching them.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "description": "Filter criteria object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Preview results",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "cached": {
                                            "type": "boolean"
                                        },
                                        "count": {
                                            "type": "integer"
                                        },
                                        "sample": {
                                            "type": "array",
                                            "items": {
                                                "type": "object"
                                            }
                                        },
                                        "warnings": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation/timeout error"
                    }
                }
            }
        },
        "/api/v1/admin/config/validate": {
            "post": {
                "summary": "Validate configuration data",
                "description": "Validates configuration object against schema and returns sanitized data",
                "tags": ["Validation"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "description": "Configuration object to validate"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Configuration is valid",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Configuration is valid"
                                        },
                                        "sanitized": {
                                            "type": "object",
                                            "description": "Sanitized configuration data"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/StandardErrorResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/admin/plex/validate-connection": {
            "post": {
                "summary": "Validate Plex connection data",
                "description": "Validates Plex server connection parameters against schema",
                "tags": ["Validation"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "hostname": {
                                        "type": "string",
                                        "description": "Plex server hostname or IP"
                                    },
                                    "port": {
                                        "type": "number",
                                        "description": "Plex server port"
                                    },
                                    "token": {
                                        "type": "string",
                                        "description": "Plex authentication token"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Plex connection data is valid",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Plex connection data is valid"
                                        },
                                        "sanitized": {
                                            "type": "object",
                                            "description": "Sanitized connection data"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error"
                    }
                }
            }
        },
        "/api/v1/admin/metrics/config": {
            "post": {
                "summary": "Update metrics configuration",
                "description": "Updates the metrics collection configuration",
                "tags": ["Metrics", "Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "enabled": {
                                        "type": "boolean",
                                        "description": "Enable or disable metrics collection"
                                    },
                                    "collectInterval": {
                                        "type": "number",
                                        "description": "Metrics collection interval in milliseconds"
                                    },
                                    "retentionPeriod": {
                                        "type": "number",
                                        "description": "How long to retain metrics data in milliseconds"
                                    },
                                    "endpoints": {
                                        "type": "object",
                                        "description": "Per-endpoint configuration"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Configuration updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "config": {
                                            "type": "object",
                                            "description": "Updated configuration"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid configuration"
                    }
                }
            }
        },
        "/api/admin/device-presets": {
            "get": {
                "summary": "Get device presets",
                "description": "Returns the list of saved device presets for quick per-device overrides.",
                "tags": ["Admin", "Devices"],
                "security": [
                    {
                        "sessionAuth": []
                    },
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Array of device presets",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "key": {
                                                "type": "string",
                                                "description": "Preset identifier"
                                            },
                                            "label": {
                                                "type": "string",
                                                "description": "Human-friendly name"
                                            },
                                            "settings": {
                                                "type": "object",
                                                "description": "Settings override payload applied when preset is used"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "500": {
                        "description": "Failed to read presets"
                    }
                }
            },
            "put": {
                "summary": "Replace device presets",
                "description": "Replaces the entire device presets list. Provide an array of presets with unique keys.",
                "tags": ["Admin", "Devices"],
                "security": [
                    {
                        "sessionAuth": []
                    },
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "required": ["key"],
                                    "properties": {
                                        "key": {
                                            "type": "string",
                                            "description": "Preset identifier (must be unique)"
                                        },
                                        "label": {
                                            "type": "string"
                                        },
                                        "settings": {
                                            "type": "object"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Presets replaced",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "allOf": [
                                        {
                                            "$ref": "#/components/schemas/StandardOkResponse"
                                        },
                                        {
                                            "type": "object",
                                            "properties": {
                                                "count": {
                                                    "type": "integer"
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Validation error (array required or invalid entries)"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "500": {
                        "description": "Failed to write presets"
                    }
                }
            }
        },
        "/api/admin/plex/music-libraries": {
            "get": {
                "summary": "Get all Plex music libraries with metadata",
                "description": "Returns a list of all music libraries from the configured Plex server, including album and artist counts.",
                "tags": ["Admin", "Plex", "Music"],
                "security": [
                    {
                        "sessionAuth": []
                    },
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of music libraries",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "key": {
                                                "type": "string",
                                                "description": "Library section key"
                                            },
                                            "title": {
                                                "type": "string",
                                                "description": "Library name"
                                            },
                                            "type": {
                                                "type": "string",
                                                "description": "Library type (artist for music)"
                                            },
                                            "agent": {
                                                "type": "string",
                                                "nullable": true
                                            },
                                            "scanner": {
                                                "type": "string",
                                                "nullable": true
                                            },
                                            "language": {
                                                "type": "string",
                                                "nullable": true
                                            },
                                            "uuid": {
                                                "type": "string",
                                                "nullable": true
                                            },
                                            "albumCount": {
                                                "type": "integer",
                                                "description": "Number of albums in library"
                                            },
                                            "artistCount": {
                                                "type": "integer",
                                                "description": "Number of artists in library"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "No Plex server configured"
                    },
                    "500": {
                        "description": "Failed to fetch music libraries"
                    }
                }
            }
        },
        "/api/admin/plex/music-genres": {
            "get": {
                "summary": "Get genres from a Plex music library",
                "description": "Returns all genres available in the specified music library with usage counts, sorted by count descending.",
                "tags": ["Admin", "Plex", "Music"],
                "security": [
                    {
                        "sessionAuth": []
                    },
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "library",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Library section key"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of genres with counts",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "tag": {
                                                "type": "string",
                                                "description": "Genre name"
                                            },
                                            "count": {
                                                "type": "integer",
                                                "description": "Number of albums with this genre"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing library parameter"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "No Plex server configured"
                    },
                    "500": {
                        "description": "Failed to fetch genres"
                    }
                }
            }
        },
        "/api/admin/plex/music-artists": {
            "get": {
                "summary": "Get artists from a Plex music library",
                "description": "Returns artists from the specified music library with pagination support.",
                "tags": ["Admin", "Plex", "Music"],
                "security": [
                    {
                        "sessionAuth": []
                    },
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "query",
                        "name": "library",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Library section key"
                    },
                    {
                        "in": "query",
                        "name": "limit",
                        "schema": {
                            "type": "integer",
                            "default": 100
                        },
                        "description": "Maximum number of artists to return"
                    },
                    {
                        "in": "query",
                        "name": "offset",
                        "schema": {
                            "type": "integer",
                            "default": 0
                        },
                        "description": "Starting offset for pagination"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Artists with pagination info",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "artists": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "key": {
                                                        "type": "string",
                                                        "description": "Artist rating key"
                                                    },
                                                    "title": {
                                                        "type": "string",
                                                        "description": "Artist name"
                                                    },
                                                    "thumb": {
                                                        "type": "string",
                                                        "nullable": true,
                                                        "description": "Artist thumbnail URL"
                                                    },
                                                    "albumCount": {
                                                        "type": "integer",
                                                        "description": "Number of albums by this artist"
                                                    }
                                                }
                                            }
                                        },
                                        "total": {
                                            "type": "integer",
                                            "description": "Total number of artists in library"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing library parameter"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "No Plex server configured"
                    },
                    "500": {
                        "description": "Failed to fetch artists"
                    }
                }
            }
        },
        "/csp-report": {
            "post": {
                "summary": "Receive CSP violation reports",
                "description": "Accepts Content Security Policy violation reports from browsers to monitor security issues",
                "tags": ["Security"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/csp-report": {
                            "schema": {
                                "type": "object"
                            }
                        },
                        "application/reports+json": {
                            "schema": {
                                "type": "array",
                                "items": {
                                    "type": "object"
                                }
                            }
                        },
                        "application/json": {
                            "schema": {
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "204": {
                        "description": "Report received and logged"
                    },
                    "400": {
                        "description": "Invalid report format"
                    }
                }
            }
        },
        "/api/admin/cache/stats": {
            "get": {
                "summary": "Get API cache statistics",
                "description": "Retrieve detailed statistics about API cache performance and usage",
                "tags": ["Cache"],
                "security": [
                    {
                        "isAuthenticated": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Cache statistics",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "data": {
                                            "type": "object",
                                            "description": "Cache statistics data"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "403": {
                        "description": "Forbidden - Admin role required"
                    }
                }
            }
        },
        "/api-docs/swagger.json": {
            "get": {
                "summary": "Get OpenAPI/Swagger specification",
                "description": "Returns the complete OpenAPI specification for the API",
                "tags": ["Documentation"],
                "responses": {
                    "200": {
                        "description": "OpenAPI specification",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "description": "OpenAPI 3.0 specification"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/admin": {
            "get": {
                "summary": "Admin panel homepage",
                "description": "Serves admin panel with auto-register support and asset versioning",
                "tags": ["Admin"],
                "responses": {
                    "200": {
                        "description": "Admin panel HTML",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "302": {
                        "description": "Redirect to setup or login"
                    },
                    "401": {
                        "description": "Authentication required"
                    }
                }
            }
        },
        "/admin/logs": {
            "get": {
                "summary": "Admin logs viewer",
                "description": "Serves the live log viewer page for administrators",
                "tags": ["Admin"],
                "security": [
                    {
                        "isAuthenticated": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Logs viewer page served successfully",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Authentication required"
                    }
                }
            }
        },
        "/api/health": {
            "get": {
                "summary": "Health check endpoint (alias)",
                "description": "Backward-compatible alias for /health. Returns basic health status or detailed diagnostics.",
                "tags": ["System"],
                "responses": {
                    "200": {
                        "description": "Health status",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HealthCheckResponse",
                                    "type": "object",
                                    "properties": {
                                        "status": {
                                            "type": "string",
                                            "enum": ["ok", "degraded", "error"]
                                        },
                                        "timestamp": {
                                            "type": "string",
                                            "format": "date-time"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "503": {
                        "description": "One or more systems are not operational.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/HealthCheckResponse"
                                }
                            }
                        }
                    }
                },
                "parameters": [
                    {
                        "in": "query",
                        "name": "detailed",
                        "schema": {
                            "type": "boolean"
                        },
                        "description": "If true, returns detailed health information"
                    }
                ]
            }
        },
        "/api/admin/restart-app": {
            "post": {
                "summary": "Restart the application",
                "description": "Sends a command to PM2 to restart the application. This is useful after modifying critical settings such as the port. The API responds immediately with a 202 Accepted status.\n",
                "tags": ["Admin", "Operations"],
                "responses": {
                    "200": {
                        "description": "Restart initiated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "ok": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "restarting": {
                                            "type": "boolean",
                                            "example": true
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "202": {
                        "description": "Restart command received and is being processed.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminApiResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized (admin only)"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/admin/jellyfin-libraries": {
            "post": {
                "summary": "Fetch Jellyfin libraries",
                "description": "Retrieves all libraries/views from a Jellyfin server.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "hostname": {
                                        "type": "string",
                                        "description": "Jellyfin server hostname (e.g., '192.168.1.10')"
                                    },
                                    "port": {
                                        "type": "number",
                                        "description": "Jellyfin server port"
                                    },
                                    "apiKey": {
                                        "type": "string",
                                        "description": "Jellyfin API key"
                                    },
                                    "insecureHttps": {
                                        "type": "boolean",
                                        "description": "Allow insecure HTTPS connections"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successfully retrieved libraries",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "libraries": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "key": {
                                                        "type": "string"
                                                    },
                                                    "name": {
                                                        "type": "string"
                                                    },
                                                    "type": {
                                                        "type": "string"
                                                    },
                                                    "id": {
                                                        "type": "string"
                                                    },
                                                    "count": {
                                                        "type": "number"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Could not fetch libraries (e.g., incorrect credentials)."
                    }
                }
            }
        },
        "/api/admin/test-tmdb": {
            "post": {
                "summary": "Test TMDB API connection",
                "description": "Tests the connection to TMDB API with provided credentials.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "apiKey": {
                                        "type": "string",
                                        "description": "TMDB API key"
                                    },
                                    "category": {
                                        "type": "string",
                                        "description": "Content category to test"
                                    }
                                },
                                "required": ["apiKey"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "TMDB connection test result.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "count": {
                                            "type": "number"
                                        },
                                        "error": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Niet geautoriseerd."
                    }
                }
            }
        },
        "/api/admin/tmdb-genres": {
            "get": {
                "summary": "Get available TMDB genres",
                "description": "Fetches the list of available genres from TMDB API for filtering.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of TMDB genres.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Niet geautoriseerd."
                    }
                }
            }
        },
        "/api/admin/tmdb-genres-test": {
            "post": {
                "summary": "Get TMDB genres for testing (with connection parameters)",
                "description": "Retrieves all available genres from TMDB using provided API key.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "apiKey": {
                                        "type": "string",
                                        "description": "TMDB API key"
                                    },
                                    "category": {
                                        "type": "string",
                                        "description": "TMDB category (popular, top_rated, etc.)"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "List of genres successfully retrieved",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid request parameters"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/admin/tmdb-total": {
            "get": {
                "summary": "Get uncapped TMDB totals for current configuration",
                "description": "Returns the approximate total number of movies and shows available from TMDB for the configured category/region (not limited to the 150 cached in the playlist).",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "TMDB totals",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "enabled": {
                                            "type": "boolean"
                                        },
                                        "movies": {
                                            "type": "number"
                                        },
                                        "shows": {
                                            "type": "number"
                                        },
                                        "total": {
                                            "type": "number"
                                        },
                                        "note": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/tmdb-cache-stats": {
            "get": {
                "summary": "Get TMDB cache statistics",
                "description": "Returns cache statistics for debugging TMDB performance.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "TMDB cache statistics.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "cacheStats": {
                                            "type": "object"
                                        },
                                        "enabled": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Niet geautoriseerd."
                    }
                }
            }
        },
        "/api/admin/change-password": {
            "post": {
                "summary": "Change the admin password",
                "description": "Allows the user to change their own admin password.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/ChangePasswordRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Password successfully changed.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminApiResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Required fields missing or new passwords do not match."
                    },
                    "401": {
                        "description": "Current password is incorrect."
                    }
                }
            }
        },
        "/api/admin/status": {
            "get": {
                "summary": "Get system status information",
                "description": "Returns comprehensive system status including application, database, cache, disk space, memory usage, and uptime information.\n",
                "tags": ["Admin"],
                "responses": {
                    "200": {
                        "description": "System status retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "app": {
                                            "type": "object",
                                            "properties": {
                                                "status": {
                                                    "type": "string",
                                                    "example": "running"
                                                }
                                            }
                                        },
                                        "database": {
                                            "type": "object",
                                            "properties": {
                                                "status": {
                                                    "type": "string",
                                                    "example": "connected"
                                                }
                                            }
                                        },
                                        "cache": {
                                            "type": "object",
                                            "properties": {
                                                "status": {
                                                    "type": "string",
                                                    "example": "active"
                                                }
                                            }
                                        },
                                        "uptime": {
                                            "type": "string",
                                            "example": "2d 5h"
                                        },
                                        "uptimeSeconds": {
                                            "type": "integer",
                                            "example": 183600
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/version": {
            "get": {
                "summary": "Get current application version",
                "description": "Returns the current version of the application from package.json",
                "tags": ["Admin"],
                "security": [
                    {
                        "ApiKeyAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Current version retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "version": {
                                            "type": "string",
                                            "example": "1.7.6"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/admin/update-check": {
            "get": {
                "summary": "Check for application updates",
                "description": "Checks the current version against the latest GitHub release and determines if an update is available. Returns detailed version information and release notes.\n",
                "tags": ["Auto-Update"],
                "responses": {
                    "200": {
                        "description": "Update check completed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "currentVersion": {
                                            "type": "string",
                                            "example": "1.5.0"
                                        },
                                        "latestVersion": {
                                            "type": "string",
                                            "example": "1.6.0"
                                        },
                                        "hasUpdate": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "updateType": {
                                            "type": "string",
                                            "example": "minor"
                                        },
                                        "releaseUrl": {
                                            "type": "string",
                                            "example": "https://github.com/Posterrama/posterrama/releases/tag/v1.6.0"
                                        },
                                        "downloadUrl": {
                                            "type": "string",
                                            "example": "https://github.com/Posterrama/posterrama/archive/v1.6.0.tar.gz"
                                        },
                                        "releaseNotes": {
                                            "type": "string",
                                            "example": "### New Features\n- Added GitHub integration"
                                        },
                                        "publishedAt": {
                                            "type": "string",
                                            "example": "2025-08-15T20:00:00Z"
                                        },
                                        "releaseName": {
                                            "type": "string",
                                            "example": "Version 1.6.0 - GitHub Integration"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/github/releases": {
            "get": {
                "summary": "Get recent GitHub releases",
                "description": "Fetches recent releases from the GitHub repository. Useful for displaying a changelog or release history.\n",
                "tags": ["GitHub Integration"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "limit",
                        "schema": {
                            "type": "integer",
                            "default": 5,
                            "minimum": 1,
                            "maximum": 20
                        },
                        "description": "Maximum number of releases to fetch"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of recent releases",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "tag_name": {
                                                "type": "string"
                                            },
                                            "name": {
                                                "type": "string"
                                            },
                                            "body": {
                                                "type": "string"
                                            },
                                            "published_at": {
                                                "type": "string"
                                            },
                                            "html_url": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/github/repository": {
            "get": {
                "summary": "Get repository information",
                "description": "Fetches general information about the GitHub repository, including stars, forks, and other metadata.\n",
                "tags": ["GitHub Integration"],
                "responses": {
                    "200": {
                        "description": "Repository information",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "type": "string"
                                        },
                                        "fullName": {
                                            "type": "string"
                                        },
                                        "description": {
                                            "type": "string"
                                        },
                                        "url": {
                                            "type": "string"
                                        },
                                        "stars": {
                                            "type": "integer"
                                        },
                                        "forks": {
                                            "type": "integer"
                                        },
                                        "issues": {
                                            "type": "integer"
                                        },
                                        "language": {
                                            "type": "string"
                                        },
                                        "license": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/github/clear-cache": {
            "post": {
                "summary": "Clear GitHub API cache",
                "description": "Clears the internal cache for GitHub API responses. This forces fresh data to be fetched on the next request.\n",
                "tags": ["GitHub Integration"],
                "responses": {
                    "200": {
                        "description": "Cache cleared successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "GitHub cache cleared successfully"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/update/start": {
            "post": {
                "summary": "Start automatic update process",
                "description": "Initiates the automatic update process. This will download the latest version, create a backup, and update the application. The process includes rollback capability in case of failure.\n",
                "tags": ["Auto-Update"],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "version": {
                                        "type": "string",
                                        "description": "Specific version to update to (optional)",
                                        "example": "1.6.0"
                                    },
                                    "force": {
                                        "type": "boolean",
                                        "description": "Force update even if already on latest version",
                                        "default": false
                                    },
                                    "dryRun": {
                                        "type": "boolean",
                                        "description": "Simulate update phases without changing files or services",
                                        "default": false
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Update process started successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "message": {
                                            "type": "string"
                                        },
                                        "updateId": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Update already in progress or invalid request"
                    },
                    "500": {
                        "description": "Failed to start update process"
                    }
                }
            }
        },
        "/api/admin/update/status": {
            "get": {
                "summary": "Get update process status",
                "description": "Returns the current status of any ongoing update process, including progress, current phase, and any errors.\n",
                "tags": ["Auto-Update"],
                "responses": {
                    "200": {
                        "description": "Update status information",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "phase": {
                                            "type": "string",
                                            "enum": [
                                                "idle",
                                                "checking",
                                                "backup",
                                                "download",
                                                "validation",
                                                "stopping",
                                                "applying",
                                                "dependencies",
                                                "starting",
                                                "verification",
                                                "completed",
                                                "error",
                                                "rollback"
                                            ]
                                        },
                                        "progress": {
                                            "type": "integer",
                                            "minimum": 0,
                                            "maximum": 100
                                        },
                                        "message": {
                                            "type": "string"
                                        },
                                        "error": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "startTime": {
                                            "type": "string",
                                            "format": "date-time",
                                            "nullable": true
                                        },
                                        "backupPath": {
                                            "type": "string",
                                            "nullable": true
                                        },
                                        "isUpdating": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/update/rollback": {
            "post": {
                "summary": "Rollback to previous version",
                "description": "Rollback to the most recent backup created during an update. This is useful if an update causes issues.\n",
                "tags": ["Auto-Update"],
                "responses": {
                    "200": {
                        "description": "Rollback completed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "message": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "No backup available for rollback"
                    },
                    "500": {
                        "description": "Rollback failed"
                    }
                }
            }
        },
        "/api/admin/update/backups": {
            "get": {
                "summary": "List available backups",
                "description": "Returns a list of all available backups that can be used for rollback or manual restoration.\n",
                "tags": ["Auto-Update"],
                "responses": {
                    "200": {
                        "description": "List of available backups",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "name": {
                                                "type": "string"
                                            },
                                            "version": {
                                                "type": "string"
                                            },
                                            "timestamp": {
                                                "type": "string",
                                                "format": "date-time"
                                            },
                                            "size": {
                                                "type": "integer"
                                            },
                                            "created": {
                                                "type": "string",
                                                "format": "date-time"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/update/cleanup": {
            "post": {
                "summary": "Cleanup old backups",
                "description": "Remove old backups to free up disk space, keeping only the most recent backups as specified.\n",
                "tags": ["Auto-Update"],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "keepCount": {
                                        "type": "integer",
                                        "minimum": 1,
                                        "maximum": 20,
                                        "default": 5,
                                        "description": "Number of recent backups to keep"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Cleanup completed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "deleted": {
                                            "type": "integer"
                                        },
                                        "kept": {
                                            "type": "integer"
                                        },
                                        "message": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/performance": {
            "get": {
                "summary": "Get system performance metrics",
                "description": "Returns real-time system performance data including CPU usage, memory usage, disk usage, and load average.\n",
                "tags": ["Admin"],
                "responses": {
                    "200": {
                        "description": "Performance metrics retrieved successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "cpu": {
                                            "type": "object",
                                            "properties": {
                                                "usage": {
                                                    "type": "number",
                                                    "example": 45.2
                                                },
                                                "loadAverage": {
                                                    "type": "string",
                                                    "example": "0.75, 0.82, 0.90"
                                                }
                                            }
                                        },
                                        "memory": {
                                            "type": "object",
                                            "properties": {
                                                "usage": {
                                                    "type": "number",
                                                    "example": 68.5
                                                },
                                                "used": {
                                                    "type": "string",
                                                    "example": "2.1 GB"
                                                },
                                                "total": {
                                                    "type": "string",
                                                    "example": "3.1 GB"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/refresh-media": {
            "post": {
                "summary": "Force an immediate refresh of the media playlist",
                "description": "Manually starts the process to fetch media from all configured servers. This is an asynchronous operation. The API responds when the refresh is complete. This endpoint is secured and requires an active admin session.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The playlist has been successfully refreshed.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/RefreshMediaResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/mqtt/generate-dashboard": {
            "post": {
                "summary": "Generate Home Assistant dashboard YAML",
                "description": "Generates a Lovelace dashboard configuration for selected devices",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "deviceIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of device IDs to include"
                                    },
                                    "includeSystemOverview": {
                                        "type": "boolean",
                                        "default": true
                                    },
                                    "includeQuickActions": {
                                        "type": "boolean",
                                        "default": true
                                    },
                                    "includeMobileView": {
                                        "type": "boolean",
                                        "default": false
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Dashboard YAML generated successfully"
                    }
                }
            }
        },
        "/api/admin/mqtt/republish": {
            "post": {
                "summary": "Republish MQTT discovery for all devices",
                "description": "Forces republishing of Home Assistant MQTT discovery for all registered devices",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "MQTT discovery republished successfully"
                    },
                    "503": {
                        "description": "MQTT bridge not available"
                    }
                }
            }
        },
        "/api/admin/mqtt/status": {
            "get": {
                "summary": "Get MQTT bridge status and statistics",
                "description": "Returns real-time status of MQTT connection, statistics, and recent command history",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "MQTT status retrieved successfully"
                    },
                    "503": {
                        "description": "MQTT bridge not available"
                    }
                }
            }
        },
        "/api/admin/reset-refresh": {
            "post": {
                "summary": "Reset stuck playlist refresh state",
                "description": "Force-reset the playlist refresh state if it gets stuck",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Refresh state has been reset successfully"
                    }
                }
            }
        },
        "/reset-refresh": {
            "get": {
                "summary": "Reset stuck playlist refresh state",
                "description": "User-friendly endpoint to reset stuck refresh state.\nReturns an HTML page with reset confirmation.\nCan be accessed directly in a browser.\n",
                "tags": ["Utilities"],
                "responses": {
                    "200": {
                        "description": "HTML page confirming refresh state reset",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string",
                                    "example": "<!DOCTYPE html>\n<html>\n<body>\n  <h1> Refresh Reset</h1>\n  <p> Playlist refresh state has been reset successfully!</p>\n</body>\n</html>\n"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/debug-cache": {
            "get": {
                "summary": "Debug cache status and configuration",
                "tags": ["Admin"],
                "security": [
                    {
                        "isAuthenticated": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Cache debug information"
                    },
                    "401": {
                        "description": "Niet geautoriseerd."
                    }
                }
            }
        },
        "/api/admin/clear-image-cache": {
            "post": {
                "summary": "Clear the server-side image cache",
                "description": "Deletes all cached images from the `image_cache` directory on the server. This forces the application to re-fetch all images from the origin media servers.\n",
                "tags": ["Cache"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The image cache was successfully cleared.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminApiResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/cache-stats": {
            "get": {
                "summary": "Get cache statistics",
                "description": "Returns cache size and disk usage information using session authentication",
                "tags": ["Admin"],
                "security": [
                    {
                        "isAuthenticated": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Cache statistics retrieved successfully"
                    }
                }
            }
        },
        "/api/admin/config": {
            "get": {
                "summary": "Get current server configuration",
                "tags": ["Admin"],
                "security": [
                    {
                        "isAuthenticated": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Current configuration"
                    }
                }
            },
            "post": {
                "summary": "Save configuration changes",
                "tags": ["Admin"],
                "security": [
                    {
                        "isAuthenticated": [],
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "config": {
                                        "type": "object",
                                        "description": "Partial configuration object to merge"
                                    },
                                    "env": {
                                        "type": "object",
                                        "description": "Environment variables to update"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Configuration saved successfully"
                    },
                    "400": {
                        "description": "Invalid request body"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                },
                "description": "Updates config.json and .env with provided changes. Detects mode changes and broadcasts navigation commands to connected devices."
            }
        },
        "/api/admin/source-status": {
            "get": {
                "summary": "Get per-source status for admin UI",
                "description": "Returns enabled/configured flags and lastFetch timestamps for Plex, Jellyfin, and TMDB.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Per-source status"
                    }
                }
            }
        },
        "/api/admin/cleanup-cache": {
            "post": {
                "summary": "Cleanup cache directories",
                "description": "Performs cleanup of cache directories by removing old or expired files based on configuration",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Cache cleanup completed successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "message": {
                                            "type": "string"
                                        },
                                        "filesRemoved": {
                                            "type": "number"
                                        },
                                        "spaceSaved": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "500": {
                        "description": "Cache cleanup failed"
                    }
                }
            }
        },
        "/api/admin/api-key": {
            "get": {
                "summary": "Get the current API key",
                "description": "Retrieves the currently configured API access key. This is only returned to an authenticated admin session.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The API key.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "apiKey": {
                                            "type": "string",
                                            "nullable": true
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/api-key/status": {
            "get": {
                "summary": "Check the API key status",
                "description": "Indicates whether an API access key is currently configured in the application.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The API key status.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "hasKey": {
                                            "type": "boolean",
                                            "description": "Whether an API key is currently configured.",
                                            "example": true
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/api-key/generate": {
            "post": {
                "summary": "Generate a new API key",
                "description": "Generates a new, cryptographically secure API access token and stores it in the .env file and overwrites any existing key. The new key is returned ONCE ONLY. Store it securely, as it cannot be retrieved again.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The newly generated API key.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiKeyResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/api-key/revoke": {
            "post": {
                "summary": "Revoke current API key",
                "description": "Removes the current API access token from the configuration, making it unusable.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Confirmation that the key has been revoked.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminApiResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/plex/sessions": {
            "get": {
                "summary": "Get current Plex playback sessions",
                "description": "Returns cached Plex session data showing what is currently being played. Updated every 10 seconds via background polling.\n",
                "tags": ["Admin", "Plex"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Current Plex sessions",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "sessions": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "sessionKey": {
                                                        "type": "string"
                                                    },
                                                    "ratingKey": {
                                                        "type": "string"
                                                    },
                                                    "type": {
                                                        "type": "string"
                                                    },
                                                    "title": {
                                                        "type": "string"
                                                    },
                                                    "year": {
                                                        "type": "number"
                                                    },
                                                    "thumb": {
                                                        "type": "string"
                                                    },
                                                    "art": {
                                                        "type": "string"
                                                    },
                                                    "viewOffset": {
                                                        "type": "number"
                                                    },
                                                    "duration": {
                                                        "type": "number"
                                                    },
                                                    "User": {
                                                        "type": "object",
                                                        "properties": {
                                                            "id": {
                                                                "type": "string"
                                                            },
                                                            "title": {
                                                                "type": "string"
                                                            },
                                                            "thumb": {
                                                                "type": "string"
                                                            }
                                                        }
                                                    },
                                                    "Player": {
                                                        "type": "object",
                                                        "properties": {
                                                            "state": {
                                                                "type": "string"
                                                            },
                                                            "device": {
                                                                "type": "string"
                                                            },
                                                            "platform": {
                                                                "type": "string"
                                                            },
                                                            "product": {
                                                                "type": "string"
                                                            },
                                                            "title": {
                                                                "type": "string"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        },
                                        "lastUpdate": {
                                            "type": "number",
                                            "description": "Timestamp of last poll (milliseconds)"
                                        },
                                        "isActive": {
                                            "type": "boolean",
                                            "description": "Whether poller is currently running"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "503": {
                        "description": "Sessions poller not initialized"
                    }
                }
            }
        },
        "/api/plex/users": {
            "get": {
                "summary": "Get Plex users with access to this server",
                "description": "Returns a list of all Plex users (including owner and shared users) who have access to the server. Useful for filtering Now Playing sessions by specific users.\n",
                "tags": ["Admin", "Plex"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of Plex users",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "users": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "id": {
                                                        "type": "string"
                                                    },
                                                    "username": {
                                                        "type": "string"
                                                    },
                                                    "title": {
                                                        "type": "string"
                                                    },
                                                    "email": {
                                                        "type": "string"
                                                    },
                                                    "thumb": {
                                                        "type": "string"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "No Plex server configured"
                    },
                    "500": {
                        "description": "Failed to fetch users from Plex"
                    }
                }
            }
        },
        "/admin/debug": {
            "get": {
                "summary": "Retrieve debug information",
                "description": "Returns the raw data of all items in the current *cached* playlist. This endpoint is only available when debug mode is enabled in the .env file.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The raw data from the playlist.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/DebugResponse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Not found (if debug mode is disabled)."
                    }
                }
            }
        },
        "/[site]": {
            "get": {
                "summary": "Site server homepage",
                "description": "Serves the promotional homepage for the public-facing site server",
                "tags": ["Site Server"],
                "responses": {
                    "200": {
                        "description": "Promotional homepage HTML",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/[site]/*": {
            "get": {
                "summary": "Site server fallback route",
                "description": "Redirects unmatched paths to homepage",
                "tags": ["Site Server"],
                "responses": {
                    "302": {
                        "description": "Redirect to homepage"
                    }
                }
            }
        },
        "/api/admin/events": {
            "get": {
                "summary": "Admin SSE stream for real-time updates",
                "description": "Server-Sent Events stream that pushes real-time updates to the admin UI including log events, config changes, device updates, and backup operations.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "SSE stream established",
                        "content": {
                            "text/event-stream": {
                                "schema": {
                                    "type": "string",
                                    "example": ": connected\\n\\n\nevent: hello\\n\ndata: {\"t\": 1700000000000}\\n\\n\nevent: ping\\n\ndata: {\"t\": 1700000002500}\\n\\n\nevent: log\\n\ndata: {\"level\":\"info\",\"message\":\"Started\"}\\n\\n\n"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized - admin session required"
                    }
                }
            }
        },
        "/api/admin/config-schema": {
            "get": {
                "summary": "Retrieve configuration JSON schema (alias)",
                "description": "Alias of /api/admin/config/schema returning config.schema.json for autocomplete tooling in the admin UI.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The JSON schema document",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized."
                    }
                }
            }
        },
        "/api/config/schema": {
            "get": {
                "summary": "Retrieve configuration JSON schema",
                "description": "Returns the config.schema.json used for validating configuration. Admin-only.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The JSON schema document",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized."
                    }
                }
            }
        },
        "/api/admin/config/schema": {
            "get": {
                "summary": "Retrieve configuration JSON schema (admin alias)",
                "description": "Alias of /api/config/schema for environments routing admin traffic under /api/admin.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The JSON schema document",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized."
                    }
                }
            }
        },
        "/api/admin/test-plex": {
            "post": {
                "summary": "Test connection to a Plex server",
                "description": "Checks if the application can connect to a Plex server with the provided hostname, port, and token. This is a lightweight check that queries the server root.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PlexConnectionRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Connection successful.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminApiResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Connection error (e.g., incorrect credentials, timeout)."
                    }
                }
            }
        },
        "/api/admin/plex-libraries": {
            "post": {
                "summary": "Retrieve Plex libraries",
                "description": "Retrieves a list of all available libraries (such as 'Movies', 'TV Shows') from the configured Plex server.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "description": "Optional connection details. If not provided, the configured values will be used.",
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/PlexConnectionRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "A list of found libraries.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/PlexLibrariesResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Could not fetch libraries (e.g., incorrect credentials)."
                    }
                }
            }
        },
        "/api/admin/test-jellyfin": {
            "post": {
                "summary": "Test connection to a Jellyfin server",
                "description": "Checks if the application can connect to a Jellyfin server with the provided hostname, port, and API key. This is a lightweight check that queries the system info.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "hostname": {
                                        "type": "string",
                                        "description": "Jellyfin server hostname or IP address"
                                    },
                                    "port": {
                                        "type": "number",
                                        "description": "Jellyfin server port (typically 8096)"
                                    },
                                    "apiKey": {
                                        "type": "string",
                                        "description": "Jellyfin API key"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Connection successful.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminApiResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Connection error (e.g., incorrect credentials, timeout)."
                    }
                }
            }
        },
        "/api/admin/test-romm": {
            "post": {
                "summary": "Test RomM connection",
                "description": "Validates RomM server credentials and connectivity",
                "tags": ["Admin"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["url", "username", "password"],
                                "properties": {
                                    "url": {
                                        "type": "string"
                                    },
                                    "username": {
                                        "type": "string"
                                    },
                                    "password": {
                                        "type": "string"
                                    },
                                    "insecureHttps": {
                                        "type": "boolean"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "RomM connection successful"
                    },
                    "400": {
                        "description": "Connection failed"
                    }
                }
            }
        },
        "/api/admin/romm-platforms": {
            "post": {
                "summary": "Fetch available platforms from RomM",
                "description": "Returns list of gaming platforms available in RomM server",
                "tags": ["Admin"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["url", "username", "password"],
                                "properties": {
                                    "url": {
                                        "type": "string"
                                    },
                                    "username": {
                                        "type": "string"
                                    },
                                    "password": {
                                        "type": "string"
                                    },
                                    "insecureHttps": {
                                        "type": "boolean"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Platform list fetched successfully"
                    },
                    "400": {
                        "description": "Failed to fetch platforms"
                    }
                }
            }
        },
        "/api/admin/plex-genres": {
            "get": {
                "summary": "Retourneert alle Plex genres",
                "tags": ["Admin"],
                "security": [
                    {
                        "BearerAuth": []
                    },
                    {
                        "SessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Succesvol",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Niet geautoriseerd."
                    }
                }
            }
        },
        "/api/admin/plex-genres-with-counts": {
            "get": {
                "summary": "Retourneert alle Plex genres met aantallen",
                "tags": ["Admin"],
                "security": [
                    {
                        "BearerAuth": []
                    },
                    {
                        "SessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Succesvol",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "genre": {
                                                        "type": "string"
                                                    },
                                                    "count": {
                                                        "type": "number"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Niet geautoriseerd."
                    }
                }
            }
        },
        "/api/admin/plex-genres-test": {
            "post": {
                "summary": "Get Plex genres for testing (with connection parameters)",
                "description": "Retrieves all available genres from a Plex server using provided connection parameters.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "hostname": {
                                        "type": "string",
                                        "description": "Plex server hostname or IP"
                                    },
                                    "port": {
                                        "type": "string",
                                        "description": "Plex server port"
                                    },
                                    "token": {
                                        "type": "string",
                                        "description": "Plex authentication token (optional if configured)"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "List of genres successfully retrieved",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - missing or invalid parameters"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/admin/plex-genres-with-counts-test": {
            "post": {
                "summary": "Get Plex genres with counts for testing",
                "description": "Retrieves all available genres with their counts from a Plex server using provided connection parameters.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "hostname": {
                                        "type": "string",
                                        "description": "Plex server hostname or IP"
                                    },
                                    "port": {
                                        "type": "string",
                                        "description": "Plex server port"
                                    },
                                    "token": {
                                        "type": "string",
                                        "description": "Plex authentication token (optional if configured)"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "List of genres with counts successfully retrieved",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "genre": {
                                                        "type": "string"
                                                    },
                                                    "count": {
                                                        "type": "number"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - missing or invalid parameters"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/admin/jellyfin-genres": {
            "post": {
                "summary": "Get genres from Jellyfin libraries",
                "description": "Retrieves all unique genres from the specified Jellyfin libraries.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "hostname": {
                                        "type": "string",
                                        "description": "Jellyfin server hostname or IP"
                                    },
                                    "port": {
                                        "type": "number",
                                        "description": "Jellyfin server port"
                                    },
                                    "apiKey": {
                                        "type": "string",
                                        "description": "Jellyfin API key"
                                    },
                                    "insecureHttps": {
                                        "type": "boolean",
                                        "description": "Allow insecure HTTPS connections"
                                    },
                                    "libraries": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of library IDs to fetch genres from"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "List of unique genres",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - missing or invalid parameters"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/admin/jellyfin-genres-with-counts": {
            "post": {
                "summary": "Get genres with counts from Jellyfin libraries",
                "description": "Retrieves all unique genres with their counts from the specified Jellyfin libraries.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "hostname": {
                                        "type": "string",
                                        "description": "Jellyfin server hostname or IP"
                                    },
                                    "port": {
                                        "type": "number",
                                        "description": "Jellyfin server port"
                                    },
                                    "apiKey": {
                                        "type": "string",
                                        "description": "Jellyfin API key"
                                    },
                                    "insecureHttps": {
                                        "type": "boolean",
                                        "description": "Allow insecure HTTPS connections"
                                    },
                                    "libraries": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of library IDs to fetch genres from"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "List of unique genres with their counts",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "properties": {
                                                    "genre": {
                                                        "type": "string"
                                                    },
                                                    "count": {
                                                        "type": "number"
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Bad request - missing or invalid parameters"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/admin/jellyfin-genres-all": {
            "get": {
                "summary": "Get all genres from enabled Jellyfin servers",
                "description": "Retrieves all unique genres from all enabled Jellyfin servers. This serves as a lightweight\nfallback when per-library counts aren't critical. Returns just the unique genre strings.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of all unique genres",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "genres": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/admin/logs": {
            "get": {
                "summary": "Get the most recent application logs",
                "description": "Retrieves a list of the most recent log entries stored in memory. This is useful for debugging from the admin panel without direct server access.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "An array of log objects.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/LogEntry"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/logs/level": {
            "get": {
                "summary": "Get current log level configuration",
                "description": "Retrieves the current Winston log level setting",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Current log level configuration",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "currentLevel": {
                                            "type": "string",
                                            "enum": [
                                                "error",
                                                "warn",
                                                "info",
                                                "http",
                                                "verbose",
                                                "debug",
                                                "silly"
                                            ]
                                        },
                                        "availableLevels": {
                                            "type": "array",
                                            "items": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Update the server log level",
                "description": "Changes the Winston logger level dynamically (error, warn, info, http, verbose, debug, silly)",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": [],
                        "sessionAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["level"],
                                "properties": {
                                    "level": {
                                        "type": "string",
                                        "enum": [
                                            "error",
                                            "warn",
                                            "info",
                                            "http",
                                            "verbose",
                                            "debug",
                                            "silly"
                                        ]
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Log level updated successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "oldLevel": {
                                            "type": "string"
                                        },
                                        "newLevel": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid log level"
                    },
                    "500": {
                        "description": "Failed to update log level"
                    }
                }
            }
        },
        "/api/admin/notify/test": {
            "post": {
                "summary": "Emit a test admin notification",
                "description": "Triggers a test log entry (info/warn/error) that flows through the admin notification center and SSE stream.",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/NotificationTestRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Notification emitted",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/NotificationTestResponse"
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Failed to emit notification"
                    }
                }
            }
        },
        "/admin/setup": {
            "get": {
                "summary": "Admin setup page",
                "description": "Serves the initial admin setup page if no admin user exists, otherwise redirects to admin panel",
                "tags": ["Admin"],
                "responses": {
                    "200": {
                        "description": "Setup page served successfully",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "302": {
                        "description": "Redirects to admin panel if setup is already complete"
                    }
                }
            },
            "post": {
                "summary": "Complete admin setup",
                "description": "Creates the initial admin user account with username and password",
                "tags": ["Admin"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/x-www-form-urlencoded": {
                            "schema": {
                                "type": "object",
                                "required": ["username", "password"],
                                "properties": {
                                    "username": {
                                        "type": "string",
                                        "description": "Admin username"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "description": "Admin password"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Admin setup completed successfully"
                    },
                    "400": {
                        "description": "Missing username or password"
                    },
                    "403": {
                        "description": "Admin user already configured"
                    }
                }
            }
        },
        "/admin/login": {
            "get": {
                "summary": "Admin login page",
                "description": "Serves the admin login page, redirects to setup if admin not configured, or to admin panel if already logged in",
                "tags": ["Authentication"],
                "responses": {
                    "200": {
                        "description": "Login page served successfully",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "302": {
                        "description": "Redirects to setup page or admin panel as appropriate"
                    }
                }
            },
            "post": {
                "summary": "Admin login authentication",
                "description": "Authenticate admin user with username and password. May require 2FA verification if enabled.",
                "tags": ["Authentication"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/x-www-form-urlencoded": {
                            "schema": {
                                "type": "object",
                                "required": ["username", "password"],
                                "properties": {
                                    "username": {
                                        "type": "string",
                                        "description": "Admin username"
                                    },
                                    "password": {
                                        "type": "string",
                                        "format": "password",
                                        "description": "Admin password"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Login successful (may redirect to 2FA verification)"
                    },
                    "401": {
                        "description": "Invalid username or password"
                    },
                    "429": {
                        "description": "Too many login attempts"
                    }
                }
            }
        },
        "/admin/2fa-verify": {
            "get": {
                "summary": "Two-factor authentication verification page",
                "description": "Serves the 2FA verification page for users who have completed initial login",
                "tags": ["Authentication"],
                "responses": {
                    "200": {
                        "description": "2FA verification page served successfully",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "302": {
                        "description": "Redirect to login if 2FA not required"
                    }
                }
            },
            "post": {
                "summary": "Verify two-factor authentication code",
                "description": "Verifies the TOTP code and completes the admin login process",
                "tags": ["Authentication"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/x-www-form-urlencoded": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "totp_code": {
                                        "type": "string",
                                        "description": "6-digit TOTP code from authenticator app",
                                        "pattern": "^\\d{6}$"
                                    }
                                },
                                "required": ["totp_code"]
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "2FA verification successful, user logged in",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "message": {
                                            "type": "string"
                                        },
                                        "redirectTo": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "302": {
                        "description": "Redirect to login if 2FA session expired"
                    },
                    "400": {
                        "description": "Invalid or missing TOTP code"
                    }
                }
            }
        },
        "/admin/logout": {
            "get": {
                "summary": "Admin logout",
                "description": "Logs out the admin user by destroying their session and redirects to login page",
                "tags": ["Authentication"],
                "responses": {
                    "302": {
                        "description": "Session destroyed, redirects to login page"
                    },
                    "500": {
                        "description": "Error destroying session"
                    }
                }
            }
        },
        "/api/admin/2fa/generate": {
            "post": {
                "summary": "Generate a new 2FA secret",
                "description": "Generates a new secret for Two-Factor Authentication (2FA) and returns a QR code that the user can scan with an authenticator app. The secret is temporarily stored in the session and only becomes permanent after successful verification.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "QR code and secret successfully generated.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Generate2FAResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "2FA is already enabled."
                    },
                    "401": {
                        "description": "Unauthorized."
                    }
                }
            }
        },
        "/api/admin/2fa/verify": {
            "post": {
                "summary": "Verify and enable 2FA",
                "description": "Verifies the TOTP code entered by the user against the temporary secret in the session. Upon success, the 2FA secret is permanently stored in the .env file and 2FA is activated.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/Verify2FARequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "2FA successfully enabled.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminApiResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid verification code or no 2FA process pending."
                    },
                    "401": {
                        "description": "Niet geautoriseerd."
                    }
                }
            }
        },
        "/api/admin/2fa/disable": {
            "post": {
                "summary": "Disable 2FA",
                "description": "Disables Two-Factor Authentication for the admin account. The user must provide their current password for confirmation.\n",
                "tags": ["Admin"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/Disable2FARequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "2FA successfully disabled.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/AdminApiResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Password is required."
                    },
                    "401": {
                        "description": "Invalid password or unauthorized."
                    }
                }
            }
        },
        "/api/admin/config-backups": {
            "get": {
                "summary": "List configuration backups",
                "description": "Returns a list of available configuration backups with their files and metadata.",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of backups",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/BackupListResponse"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Create a new configuration backup",
                "description": "Creates a new backup of whitelisted configuration files (config.json, .env, devices/groups, presets).",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Backup metadata",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/BackupCreateResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/config-backups/cleanup": {
            "post": {
                "summary": "Cleanup old backups",
                "description": "Deletes older backups while keeping the most recent N backups (default 5).",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "keep": {
                                        "type": "integer",
                                        "minimum": 1,
                                        "maximum": 60,
                                        "default": 5
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Cleanup result",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/BackupCleanupResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/admin/config-backups/restore": {
            "post": {
                "summary": "Restore a file from a backup",
                "description": "Restores a whitelisted file (e.g., config.json or .env) from a specified backup.",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["backupId", "file"],
                                "properties": {
                                    "backupId": {
                                        "type": "string"
                                    },
                                    "file": {
                                        "type": "string",
                                        "enum": [
                                            "config.json",
                                            "device-presets.json",
                                            "devices.json",
                                            "groups.json",
                                            ".env"
                                        ]
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Restore successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/BackupRestoreResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid request or restore failed"
                    }
                }
            }
        },
        "/api/admin/config-backups/{id}": {
            "delete": {
                "summary": "Delete a specific backup",
                "description": "Permanently deletes a backup directory by ID.",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Deletion result",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/BackupDeleteResponse"
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid ID or deletion failed"
                    }
                }
            }
        },
        "/api/admin/config-backups/schedule": {
            "get": {
                "summary": "Read backup schedule configuration",
                "description": "Returns current daily schedule for automatic backups (enabled flag, time, and retention).",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Schedule configuration",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/BackupScheduleResponse"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "summary": "Update backup schedule configuration",
                "description": "Saves daily backup scheduler configuration and realigns the in-memory scheduler.",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "enabled": {
                                        "type": "boolean",
                                        "description": "Enable or disable automated backups",
                                        "example": true
                                    },
                                    "time": {
                                        "type": "string",
                                        "pattern": "^\\d{1,2}:\\d{2}$",
                                        "description": "Daily backup time in HH:MM format (24-hour)",
                                        "example": "03:30"
                                    },
                                    "retention": {
                                        "type": "integer",
                                        "minimum": 1,
                                        "maximum": 60,
                                        "description": "Number of backups to retain",
                                        "example": 5
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/get-config": {
            "get": {
                "summary": "Retrieve the public application configuration",
                "description": "Fetches the non-sensitive configuration needed by the frontend for display logic. This endpoint is also accessible via the versioned API at /api/v1/config. The response is cached for 30 seconds to improve performance.\n",
                "tags": ["Public API"],
                "responses": {
                    "200": {
                        "description": "The public configuration object.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Config"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/devices/register": {
            "post": {
                "summary": "Register a new device",
                "description": "Register a new display device to receive media and commands. Returns device ID and secret for authentication.",
                "tags": ["Devices"],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "description": "Device name (optional, defaults to timestamp)"
                                    },
                                    "location": {
                                        "type": "string",
                                        "description": "Device location (optional)"
                                    },
                                    "installId": {
                                        "type": "string",
                                        "description": "Install identifier for tracking across sessions"
                                    },
                                    "hardwareId": {
                                        "type": "string",
                                        "description": "Hardware identifier (optional)"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Device registered successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/DeviceRegisterResponse"
                                }
                            }
                        }
                    },
                    "429": {
                        "description": "Too many registration requests"
                    },
                    "500": {
                        "description": "Register failed"
                    }
                }
            }
        },
        "/api/devices/check": {
            "post": {
                "summary": "Check device authentication and registration status",
                "description": "Verify device credentials and registration status. Used by clients to confirm their stored ID/secret are valid.\n\n**Flexible Authentication**: This endpoint accepts checks with only deviceId, hardwareId, or installId (without secret)\nto determine if a device is registered. When a secret is provided, it validates the credentials.\n\n**Response behavior**:\n- Device not found: Returns `{valid: false, isRegistered: false, reason: 'device_not_found'}`\n- Device exists, no secret: Returns `{valid: false, isRegistered: true, deviceId, reason: 'secret_required'}`\n- Invalid secret: Returns 401 `{valid: false, error: 'invalid_secret'}`\n- Valid credentials: Returns `{valid: true, isRegistered: true, deviceId}`\n",
                "tags": ["Devices"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "deviceId": {
                                        "type": "string",
                                        "description": "Device ID (optional if hardwareId or installId provided)"
                                    },
                                    "secret": {
                                        "type": "string",
                                        "description": "Device secret (optional for registration check)"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Device check completed (see response body for valid/isRegistered status)",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "valid": {
                                            "type": "boolean",
                                            "description": "Whether the provided credentials are valid"
                                        },
                                        "isRegistered": {
                                            "type": "boolean",
                                            "description": "Whether the device is registered in the system"
                                        },
                                        "deviceId": {
                                            "type": "string",
                                            "description": "Device ID (when device is found)"
                                        },
                                        "reason": {
                                            "type": "string",
                                            "description": "Reason code (device_not_found, secret_required, etc.)"
                                        }
                                    },
                                    "examples": {
                                        "not_found": {
                                            "value": {
                                                "valid": false,
                                                "isRegistered": false,
                                                "reason": "device_not_found"
                                            }
                                        },
                                        "registered_no_secret": {
                                            "value": {
                                                "valid": false,
                                                "isRegistered": true,
                                                "deviceId": "dev_abc123",
                                                "reason": "secret_required"
                                            }
                                        },
                                        "valid_credentials": {
                                            "value": {
                                                "valid": true,
                                                "isRegistered": true,
                                                "deviceId": "dev_abc123"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Missing device identifier (no deviceId, hardwareId, or installId)"
                    },
                    "401": {
                        "description": "Invalid secret provided"
                    }
                }
            }
        },
        "/api/devices/heartbeat": {
            "post": {
                "summary": "Device heartbeat",
                "description": "Report device status and update last seen timestamp. Automatically clears reload flags and handles queued commands.",
                "tags": ["Devices"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["deviceId", "secret"],
                                "properties": {
                                    "deviceId": {
                                        "type": "string"
                                    },
                                    "secret": {
                                        "type": "string"
                                    },
                                    "status": {
                                        "type": "object",
                                        "description": "Device status information"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Heartbeat received",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "ok": {
                                            "type": "boolean"
                                        },
                                        "reload": {
                                            "type": "boolean",
                                            "description": "Whether device should reload"
                                        },
                                        "queuedCommands": {
                                            "type": "array",
                                            "items": {
                                                "type": "object"
                                            },
                                            "description": "Commands waiting to be executed"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Invalid credentials"
                    }
                }
            }
        },
        "/api/devices/bypass-check": {
            "get": {
                "summary": "Check if client IP is on device bypass list",
                "description": "Returns whether the requesting IP address is whitelisted for device management bypass.",
                "tags": ["Devices"],
                "responses": {
                    "200": {
                        "description": "Bypass status",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "bypass": {
                                            "type": "boolean",
                                            "description": "Whether this IP is on the bypass list"
                                        },
                                        "ip": {
                                            "type": "string",
                                            "description": "The detected IP address"
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/devices/pair": {
            "post": {
                "summary": "Pair device with pairing code",
                "description": "Exchange a pairing code for device credentials. Used for simplified onboarding flow.",
                "tags": ["Devices"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["code"],
                                "properties": {
                                    "code": {
                                        "type": "string",
                                        "description": "6-digit pairing code"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Pairing successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "deviceId": {
                                            "type": "string"
                                        },
                                        "secret": {
                                            "type": "string"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid or expired code"
                    },
                    "429": {
                        "description": "Too many pairing attempts"
                    }
                }
            }
        },
        "/api/devices/{id}/pairing-code": {
            "post": {
                "summary": "Generate pairing code for device",
                "description": "Generates a new pairing code for a specific device. Admin only.",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Device ID"
                    }
                ],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "ttlMs": {
                                        "type": "number",
                                        "description": "Time-to-live in milliseconds",
                                        "default": 600000
                                    },
                                    "requireToken": {
                                        "type": "boolean",
                                        "description": "Whether token is required for pairing",
                                        "default": false
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Pairing code generated",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "code": {
                                            "type": "string"
                                        },
                                        "deviceId": {
                                            "type": "string"
                                        },
                                        "expiresAt": {
                                            "type": "string"
                                        },
                                        "expiresInMs": {
                                            "type": "number"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Device not found"
                    }
                }
            }
        },
        "/api/devices/pairing-codes/active": {
            "get": {
                "summary": "List active pairing codes",
                "description": "Returns all active (non-expired, unclaimed) pairing codes. Admin only.",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of active pairing codes",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "type": "object",
                                        "properties": {
                                            "code": {
                                                "type": "string"
                                            },
                                            "deviceId": {
                                                "type": "string"
                                            },
                                            "expiresAt": {
                                                "type": "string"
                                            },
                                            "claimed": {
                                                "type": "boolean"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/devices": {
            "get": {
                "summary": "List all devices",
                "description": "Returns a list of all registered devices with their current status. Admin only.",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of devices",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Device"
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/devices/{id}": {
            "get": {
                "summary": "Get device details",
                "description": "Returns detailed information about a specific device. Admin only.",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Device ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Device details",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Device"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Device not found"
                    }
                }
            },
            "delete": {
                "summary": "Delete a device",
                "description": "Permanently removes a device from the system. Admin only.",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Device ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Device deleted successfully"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Device not found"
                    }
                }
            },
            "patch": {
                "summary": "Update device settings",
                "description": "Update device properties like name, preset, or settings overrides",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Device ID"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "description": "Device name"
                                    },
                                    "location": {
                                        "type": "string",
                                        "description": "Device location"
                                    },
                                    "groups": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of group IDs this device belongs to"
                                    },
                                    "preset": {
                                        "type": "string",
                                        "description": "Preset name to apply to device"
                                    },
                                    "settingsOverride": {
                                        "type": "object",
                                        "description": "Device-specific settings overrides"
                                    },
                                    "plexUsername": {
                                        "type": "string",
                                        "nullable": true,
                                        "description": "Plex username for Cinema Now Playing integration (null to clear)"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Device updated successfully"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Device not found"
                    }
                }
            }
        },
        "/api/devices/{id}/preview": {
            "get": {
                "summary": "Get device preview (read-only public view)",
                "description": "Returns public device information without authentication. Used for display purposes.",
                "tags": ["Devices"],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Device ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Device preview data",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "id": {
                                            "type": "string"
                                        },
                                        "name": {
                                            "type": "string"
                                        },
                                        "location": {
                                            "type": "string"
                                        },
                                        "connected": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Device not found"
                    }
                }
            }
        },
        "/api/devices/{id}/merge": {
            "post": {
                "summary": "Merge source devices into target device",
                "description": "Merge one or more source devices into a target device, combining their properties, groups, settings, and state",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Target device ID (device to merge into)"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["sourceIds"],
                                "properties": {
                                    "sourceIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of source device IDs to merge into target"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Devices merged successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "ok": {
                                            "type": "boolean"
                                        },
                                        "merged": {
                                            "type": "integer",
                                            "description": "Number of devices merged"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid request"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Target device not found"
                    }
                }
            }
        },
        "/api/devices/command": {
            "post": {
                "summary": "Send command to device(s)",
                "description": "Send a control command to one or more devices via WebSocket. If device is offline, command is queued for next heartbeat.",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["deviceIds", "command"],
                                "properties": {
                                    "deviceIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of device IDs to send command to"
                                    },
                                    "command": {
                                        "type": "object",
                                        "description": "Command object (type and payload)"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Commands sent/queued successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        },
                                        "sent": {
                                            "type": "integer",
                                            "description": "Number of commands sent immediately via WebSocket"
                                        },
                                        "queued": {
                                            "type": "integer",
                                            "description": "Number of commands queued for offline devices"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid request"
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/api/devices/{id}/command": {
            "post": {
                "summary": "Send command to a specific device",
                "description": "Send a management command to a device. Supports both WebSocket (live) and queued delivery.",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Device ID"
                    },
                    {
                        "in": "query",
                        "name": "wait",
                        "schema": {
                            "type": "boolean"
                        },
                        "description": "Wait for ACK from device (timeout after 3s)"
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "type": {
                                        "type": "string",
                                        "description": "Command type (e.g., core.mgmt.reload)"
                                    },
                                    "payload": {
                                        "type": "object",
                                        "description": "Command payload"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Command sent/queued"
                    },
                    "404": {
                        "description": "Device not found"
                    },
                    "500": {
                        "description": "Send failed"
                    }
                }
            }
        },
        "/api/devices/clear-reload": {
            "post": {
                "summary": "Clear cache and reload all devices",
                "description": "Sends clearCache and reload commands to all registered devices. Admin only.",
                "tags": ["Devices"],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Commands sent/queued",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "ok": {
                                            "type": "boolean"
                                        },
                                        "live": {
                                            "type": "integer",
                                            "description": "Number of connected devices that received commands"
                                        },
                                        "queued": {
                                            "type": "integer",
                                            "description": "Number of offline devices with queued commands"
                                        },
                                        "total": {
                                            "type": "integer"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    }
                }
            }
        },
        "/setup.html": {
            "get": {
                "summary": "Redirect to admin setup",
                "description": "Redirects legacy setup.html requests to the unified admin setup route",
                "tags": ["Frontend"],
                "responses": {
                    "302": {
                        "description": "Redirect to /admin/setup"
                    }
                }
            }
        },
        "/login.html": {
            "get": {
                "summary": "Redirect to admin login",
                "description": "Redirects legacy login.html requests to the unified admin login route",
                "tags": ["Frontend"],
                "responses": {
                    "302": {
                        "description": "Redirect to /admin/login"
                    }
                }
            }
        },
        "/2fa-verify.html": {
            "get": {
                "summary": "Serve 2FA verification page or redirect",
                "description": "Serves the 2FA verification page if user is in an active 2FA flow, otherwise redirects to login page for security.\n",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "2FA verification page HTML",
                        "content": {
                            "text/html": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    },
                    "302": {
                        "description": "Redirect to /admin/login if not in 2FA flow"
                    }
                }
            }
        },
        "/admin.css": {
            "get": {
                "summary": "Serve admin CSS with cache busting",
                "description": "Serves the admin panel CSS file with no-cache headers to ensure latest version is always loaded",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "Admin CSS file",
                        "content": {
                            "text/css": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/admin.js": {
            "get": {
                "summary": "Serve admin JavaScript with cache busting",
                "description": "Serves the admin panel JavaScript file with no-cache headers to ensure latest version is always loaded",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "Admin JavaScript file",
                        "content": {
                            "application/javascript": {
                                "schema": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/logs.html": {
            "get": {
                "summary": "Redirect to admin logs",
                "description": "Redirects logs.html requests to unified admin logs route (requires authentication)",
                "tags": ["Frontend"],
                "responses": {
                    "302": {
                        "description": "Redirect to /admin/logs"
                    }
                }
            }
        },
        "/preview": {
            "get": {
                "summary": "Preview page",
                "description": "Redirects to display mode with preview flag",
                "tags": ["Frontend"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "mode",
                        "schema": {
                            "type": "string",
                            "enum": ["screensaver", "cinema", "wallart"]
                        },
                        "description": "Display mode to preview"
                    }
                ],
                "responses": {
                    "302": {
                        "description": "Redirect to display page with preview flag"
                    }
                }
            }
        },
        "/cinema": {
            "get": {
                "summary": "Cinema display page",
                "description": "Serves cinema mode HTML with asset versioning",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "Cinema display HTML"
                    }
                }
            }
        },
        "/promo.html": {
            "get": {
                "summary": "Promotional page",
                "description": "Serves the promotional/marketing page",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "Promo HTML"
                    }
                }
            }
        },
        "/wallart": {
            "get": {
                "summary": "Wallart display page",
                "description": "Serves wallart mode HTML with asset versioning",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "Wallart display HTML"
                    }
                }
            }
        },
        "/screensaver": {
            "get": {
                "summary": "Screensaver display page",
                "description": "Serves screensaver mode HTML with asset versioning",
                "tags": ["Frontend"],
                "responses": {
                    "200": {
                        "description": "Screensaver display HTML"
                    }
                }
            }
        },
        "/api/groups": {
            "get": {
                "summary": "List all groups",
                "tags": ["Groups", "Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Groups array",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/Group"
                                    }
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "500": {
                        "description": "Groups list failed"
                    }
                }
            },
            "post": {
                "summary": "Create a group",
                "tags": ["Groups", "Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/GroupCreateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Created group",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Group"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "409": {
                        "description": "Group exists"
                    },
                    "500": {
                        "description": "Group create failed"
                    }
                }
            }
        },
        "/api/groups/{id}": {
            "patch": {
                "summary": "Patch a group",
                "tags": ["Groups", "Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/GroupPatchRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Updated group",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Group"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Not found"
                    },
                    "500": {
                        "description": "Group patch failed"
                    }
                }
            },
            "delete": {
                "summary": "Delete a group",
                "tags": ["Groups", "Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Deleted"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Not found"
                    },
                    "500": {
                        "description": "Group delete failed"
                    }
                }
            }
        },
        "/api/groups/{id}/command": {
            "post": {
                "summary": "Broadcast a command to group members",
                "description": "Sends a command to all devices in the group. Use wait=true to collect per-device ACKs.",
                "tags": ["Groups", "Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    },
                    {
                        "in": "query",
                        "name": "wait",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "default": false
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/DeviceCommandRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Broadcast result",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/GroupCommandResponse"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "404": {
                        "description": "Group not found"
                    },
                    "500": {
                        "description": "Group command failed"
                    }
                }
            }
        },
        "/health": {
            "get": {
                "summary": "Health Check Endpoint",
                "description": "Health check endpoint that returns basic service status by default. Use ?detailed=true query parameter for comprehensive health checks including configuration validation, filesystem access, and media server connectivity.\n",
                "tags": ["Public API"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "detailed",
                        "schema": {
                            "type": "boolean",
                            "default": false
                        },
                        "description": "Whether to perform detailed health checks"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Health check completed",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "oneOf": [
                                        {
                                            "$ref": "#/components/schemas/BasicHealthResponse"
                                        },
                                        {
                                            "$ref": "#/components/schemas/HealthCheckResponse"
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/local/scan": {
            "post": {
                "summary": "Scan local media directories",
                "description": "Rescan posters/backgrounds/motion folders and generate missing metadata files",
                "tags": ["Local Directory"],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "createMetadata": {
                                        "type": "boolean",
                                        "description": "Create missing *.poster.json metadata files",
                                        "default": true
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Scan completed"
                    },
                    "404": {
                        "description": "Local directory not enabled"
                    }
                }
            }
        },
        "/api/local/browse": {
            "get": {
                "summary": "Browse local directory structure",
                "description": "Get directory contents and file information for local media management",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "path",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Relative path to browse (defaults to root)"
                    },
                    {
                        "in": "query",
                        "name": "type",
                        "schema": {
                            "type": "string",
                            "enum": ["all", "directories", "files", "media"]
                        },
                        "description": "Filter results by type"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Directory contents"
                    },
                    "404": {
                        "description": "Directory not found"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/local/search": {
            "get": {
                "summary": "Recursively search for files and folders in local directory",
                "description": "Searches recursively through all subdirectories for matching files and folders",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "query",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Search query string"
                    },
                    {
                        "in": "query",
                        "name": "path",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Starting path for search (defaults to root)"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Array of matching items"
                    },
                    "500": {
                        "description": "Server error"
                    }
                }
            }
        },
        "/api/local/download": {
            "get": {
                "summary": "Download a single file from the local directory",
                "description": "Streams a single file to the client after validating the path is within the configured root",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Absolute or relative path to the file under the local root"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "File stream"
                    },
                    "400": {
                        "description": "Invalid request or path"
                    },
                    "404": {
                        "description": "File not found"
                    }
                }
            }
        },
        "/api/local/download-all": {
            "get": {
                "summary": "Download a directory as a ZIP (recursive)",
                "description": "Zips a directory under the local root and streams it to the client",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "path",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Absolute or relative path to the directory under the local root"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "ZIP stream"
                    },
                    "400": {
                        "description": "Invalid request or path"
                    },
                    "404": {
                        "description": "Directory not found"
                    }
                }
            }
        },
        "/api/local/bulk-download": {
            "post": {
                "summary": "Download multiple files as a single ZIP",
                "description": "Creates a ZIP archive containing selected files and streams it to the client",
                "tags": ["Local Directory"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["paths"],
                                "properties": {
                                    "paths": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of file paths to include in the ZIP"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "ZIP stream"
                    },
                    "400": {
                        "description": "Invalid request"
                    },
                    "404": {
                        "description": "File(s) not found"
                    }
                }
            }
        },
        "/api/local/bulk-delete": {
            "post": {
                "summary": "Delete multiple files",
                "description": "Deletes multiple files using the cleanup endpoint",
                "tags": ["Local Directory"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["paths"],
                                "properties": {
                                    "paths": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of file paths to delete"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Files deleted"
                    },
                    "400": {
                        "description": "Invalid request"
                    }
                }
            }
        },
        "/api/local/import-posterpacks": {
            "post": {
                "summary": "Manage posterpack ZIPs (ZIP-only)",
                "description": "ZIPs are never extracted. By default this operation does nothing (manual ZIPs already live under complete/manual). When includeGenerated=true, it copies any ZIPs from complete/plex-export and complete/jellyfin-export into complete/manual for safekeeping.",
                "tags": ["Local Directory"],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "includeGenerated": {
                                        "type": "boolean",
                                        "description": "Also import from generated export folders (plex-export, jellyfin-export)",
                                        "default": true
                                    },
                                    "refresh": {
                                        "type": "boolean",
                                        "description": "Trigger a playlist refresh after import",
                                        "default": true
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Import completed"
                    },
                    "404": {
                        "description": "Local directory not enabled"
                    }
                }
            }
        },
        "/api/local/upload": {
            "post": {
                "summary": "Upload media files to local directory",
                "description": "Upload one or more media files with automatic organization. For posterpack ZIPs, use targetDirectory=complete (stored under complete/manual).",
                "tags": ["Local Directory"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "files": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "format": "binary"
                                        }
                                    },
                                    "targetPath": {
                                        "type": "string",
                                        "description": "Target directory path"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Upload successful"
                    },
                    "400": {
                        "description": "Invalid request or files"
                    },
                    "500": {
                        "description": "Upload failed"
                    }
                }
            }
        },
        "/api/local/cleanup": {
            "post": {
                "summary": "Clean up local directory",
                "description": "Remove empty directories, duplicate files, and orphaned metadata",
                "tags": ["Local Directory"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "operations": {
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "empty-directories",
                                                "duplicates",
                                                "orphaned-metadata",
                                                "unused-images"
                                            ]
                                        },
                                        "description": "Cleanup operations to perform"
                                    },
                                    "dryRun": {
                                        "type": "boolean",
                                        "description": "Perform dry run without making changes"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Cleanup completed"
                    },
                    "400": {
                        "description": "Invalid request"
                    },
                    "500": {
                        "description": "Cleanup failed"
                    }
                }
            }
        },
        "/api/local/generate-posterpack": {
            "post": {
                "summary": "Generate posterpack from media servers",
                "description": "Create ZIP archives of posters and metadata from Plex/Jellyfin libraries",
                "tags": ["Local Directory"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["sourceType", "libraryIds"],
                                "properties": {
                                    "sourceType": {
                                        "type": "string",
                                        "enum": ["plex", "jellyfin"],
                                        "description": "Source media server type"
                                    },
                                    "libraryIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        },
                                        "description": "Array of library IDs to process"
                                    },
                                    "options": {
                                        "type": "object",
                                        "description": "Generation options",
                                        "properties": {
                                            "includeAssets": {
                                                "type": "object",
                                                "description": "Asset types to include"
                                            },
                                            "outputNaming": {
                                                "type": "string",
                                                "description": "Output filename template"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Generation job started"
                    },
                    "400": {
                        "description": "Invalid request"
                    },
                    "404": {
                        "description": "Local directory or job queue not available"
                    },
                    "500": {
                        "description": "Generation failed to start"
                    }
                }
            }
        },
        "/api/local/preview-posterpack": {
            "post": {
                "summary": "Preview posterpack generation",
                "description": "Estimate how many items would be included based on selected source and libraries",
                "tags": ["Local Directory"],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "required": ["sourceType"],
                                "properties": {
                                    "sourceType": {
                                        "type": "string",
                                        "enum": ["plex", "jellyfin", "local"]
                                    },
                                    "libraryIds": {
                                        "type": "array",
                                        "items": {
                                            "type": "string"
                                        }
                                    },
                                    "mediaType": {
                                        "type": "string"
                                    },
                                    "yearRange": {
                                        "type": "object"
                                    },
                                    "limit": {
                                        "type": "number"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Preview data"
                    },
                    "400": {
                        "description": "Invalid request"
                    }
                }
            }
        },
        "/api/local/posterpacks": {
            "get": {
                "summary": "List generated posterpacks",
                "description": "Return generated posterpack ZIP files for the given source (plex/jellyfin/local)",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "source",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": ["plex", "jellyfin", "local"]
                        },
                        "description": "Source type to list"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of ZIP files"
                    }
                }
            }
        },
        "/api/local/posterpacks/download": {
            "get": {
                "summary": "Download a single posterpack ZIP",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "source",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": ["plex", "jellyfin", "local"]
                        }
                    },
                    {
                        "in": "query",
                        "name": "file",
                        "required": true,
                        "schema": {
                            "type": "string"
                        }
                    }
                ]
            }
        },
        "/api/local/posterpacks/download-all": {
            "get": {
                "summary": "Download all posterpacks for a source as a ZIP",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "source",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "enum": ["plex", "jellyfin", "local"]
                        }
                    }
                ]
            }
        },
        "/api/local/jobs/{jobId}": {
            "get": {
                "summary": "Get job status and progress",
                "description": "Retrieve detailed information about a specific background job",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "path",
                        "name": "jobId",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Job ID"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Job information"
                    },
                    "404": {
                        "description": "Job not found"
                    }
                }
            }
        },
        "/api/local/jobs": {
            "get": {
                "summary": "List all jobs",
                "description": "Get list of all background jobs with optional status filtering",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "status",
                        "schema": {
                            "type": "string",
                            "enum": ["queued", "running", "completed", "failed", "cancelled"]
                        },
                        "description": "Filter jobs by status"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "List of jobs"
                    }
                }
            }
        },
        "/api/local/jobs/{jobId}/cancel": {
            "post": {
                "summary": "Cancel a queued job",
                "description": "Cancel a job that is currently in the queue (not yet running)",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "path",
                        "name": "jobId",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Job ID to cancel"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Job cancelled successfully"
                    },
                    "400": {
                        "description": "Job cannot be cancelled (not queued)"
                    },
                    "404": {
                        "description": "Job not found"
                    }
                }
            }
        },
        "/api/local/metadata": {
            "get": {
                "summary": "Get metadata for local media files",
                "description": "Retrieve or generate metadata for files in the local directory",
                "tags": ["Local Directory"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "path",
                        "schema": {
                            "type": "string"
                        },
                        "description": "File or directory path"
                    },
                    {
                        "in": "query",
                        "name": "refresh",
                        "schema": {
                            "type": "boolean"
                        },
                        "description": "Force refresh metadata from external sources"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Metadata information"
                    },
                    "404": {
                        "description": "File not found or no metadata available"
                    },
                    "500": {
                        "description": "Metadata retrieval failed"
                    }
                }
            }
        },
        "/api/local/stats": {
            "get": {
                "summary": "Get local directory statistics",
                "description": "Retrieve usage statistics and summary information",
                "tags": ["Local Directory"],
                "responses": {
                    "200": {
                        "description": "Directory statistics"
                    },
                    "404": {
                        "description": "Local directory support not enabled"
                    }
                }
            }
        },
        "/get-media": {
            "get": {
                "summary": "Retrieve media playlist",
                "description": "Returns the aggregated playlist from all configured media sources (Plex, Jellyfin, TMDB). RomM games are only included when gamesOnly mode is enabled. Cached for performance. Optionally includes extras (trailers, theme music) when includeExtras=true. Supports Music Mode for album covers and Games Mode for game covers.",
                "tags": ["Public API"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "source",
                        "schema": {
                            "type": "string",
                            "enum": ["plex", "jellyfin", "tmdb", "local"]
                        },
                        "description": "Optional source filter to return only items from a specific provider (romm not included in regular playlist)"
                    },
                    {
                        "in": "query",
                        "name": "nocache",
                        "schema": {
                            "type": "string",
                            "enum": ["1"]
                        },
                        "description": "Set to '1' to bypass cache (admin use)"
                    },
                    {
                        "in": "query",
                        "name": "musicMode",
                        "schema": {
                            "type": "string",
                            "enum": ["1", "true"]
                        },
                        "description": "Set to \"1\" or \"true\" to return music albums instead of movies/TV shows. Requires wallartMode.musicMode.enabled=true in config. Returns items with type=\"music\" containing album metadata (artist, album, genres, etc.)"
                    },
                    {
                        "in": "query",
                        "name": "gamesOnly",
                        "schema": {
                            "type": "string",
                            "enum": ["1", "true"]
                        },
                        "description": "Set to \"1\" or \"true\" to return game covers from RomM. Requires wallartMode.gamesOnly=true in config. Returns items with type=\"game\" containing game metadata (platform, etc.)"
                    },
                    {
                        "in": "query",
                        "name": "count",
                        "schema": {
                            "type": "integer",
                            "minimum": 1,
                            "maximum": 1000
                        },
                        "description": "Number of items to return (used with musicMode and gamesOnly)"
                    },
                    {
                        "in": "query",
                        "name": "includeExtras",
                        "schema": {
                            "type": "boolean"
                        },
                        "description": "When true, enriches items with trailers and theme music URLs (Plex/Jellyfin only). Note that this adds latency to the request as it fetches additional metadata per item."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Playlist of media items. When includeExtras=true, items include extras array with trailers, trailer object (first trailer for convenience), theme path, and themeUrl for streaming.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "array",
                                    "items": {
                                        "$ref": "#/components/schemas/MediaItem"
                                    }
                                }
                            }
                        }
                    },
                    "202": {
                        "description": "Playlist is being built. Client should retry in a few seconds.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "status": {
                                            "type": "string",
                                            "example": "building"
                                        },
                                        "message": {
                                            "type": "string"
                                        },
                                        "retryIn": {
                                            "type": "number",
                                            "description": "Suggested retry delay in milliseconds"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "503": {
                        "description": "Service unavailable. Playlist fetch failed.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/ApiMessage"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/get-music-artists": {
            "get": {
                "summary": "Get random artists with complete discographies",
                "description": "Fetches N random artists and all their albums for artist-cards display mode",
                "tags": ["Public API"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "count",
                        "schema": {
                            "type": "integer",
                            "default": 50
                        },
                        "description": "Number of random artists to fetch"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Array of albums from random artists"
                    }
                }
            }
        },
        "/get-media-by-key/{key}": {
            "get": {
                "summary": "Retrieve a single media item by its unique key",
                "description": "Fetches the full details for a specific media item, typically used when a user clicks on a 'recently added' item that isn't in the main playlist.",
                "tags": ["Public API"],
                "parameters": [
                    {
                        "in": "path",
                        "name": "key",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "The unique key of the media item (e.g., plex-MyPlex-12345)."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The requested media item.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/MediaItem"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Media item not found."
                    }
                }
            }
        },
        "/image": {
            "get": {
                "summary": "Image proxy",
                "description": "Proxies image requests to the media server (Plex/Jellyfin) or external URLs to avoid exposing server details and tokens to the client.",
                "tags": ["Public API"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "server",
                        "schema": {
                            "type": "string"
                        },
                        "description": "The name of the server config from config.json (for Plex-style paths)."
                    },
                    {
                        "in": "query",
                        "name": "path",
                        "schema": {
                            "type": "string"
                        },
                        "description": "The image path from the media item object (e.g., /library/metadata/12345/art/...)."
                    },
                    {
                        "in": "query",
                        "name": "url",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Direct URL to proxy (for Jellyfin and external images)."
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The requested image.",
                        "content": {
                            "image/*": {}
                        }
                    },
                    "302": {
                        "description": "Redirects to a fallback image on error."
                    },
                    "400": {
                        "description": "Bad request, missing parameters."
                    }
                }
            }
        },
        "/api/v1/metrics/performance": {
            "get": {
                "summary": "Get performance metrics",
                "description": "Returns server performance metrics including CPU and memory usage",
                "tags": ["Metrics"],
                "responses": {
                    "200": {
                        "description": "Performance metrics retrieved successfully"
                    }
                }
            }
        },
        "/api/v1/metrics/endpoints": {
            "get": {
                "summary": "Get endpoint metrics",
                "description": "Returns metrics for individual API endpoints including request counts and response times",
                "tags": ["Metrics"],
                "responses": {
                    "200": {
                        "description": "Endpoint metrics retrieved successfully"
                    }
                }
            }
        },
        "/api/v1/metrics/errors": {
            "get": {
                "summary": "Get error metrics",
                "description": "Returns error statistics including error rates, error types, and recent errors",
                "tags": ["Metrics"],
                "responses": {
                    "200": {
                        "description": "Error metrics retrieved successfully"
                    }
                }
            }
        },
        "/api/v1/metrics/cache": {
            "get": {
                "summary": "Get cache metrics",
                "description": "Returns cache performance metrics including hit rates, miss rates, and cache sizes",
                "tags": ["Metrics"],
                "responses": {
                    "200": {
                        "description": "Cache metrics retrieved successfully"
                    }
                }
            }
        },
        "/api/v1/metrics/system": {
            "get": {
                "summary": "Get system metrics",
                "description": "Returns system-level metrics including uptime, memory, CPU, and disk usage",
                "tags": ["Metrics"],
                "responses": {
                    "200": {
                        "description": "System metrics retrieved successfully"
                    }
                }
            }
        },
        "/api/v1/metrics/realtime": {
            "get": {
                "summary": "Get real-time metrics",
                "description": "Returns current real-time metrics snapshot",
                "tags": ["Metrics"],
                "responses": {
                    "200": {
                        "description": "Real-time metrics retrieved successfully"
                    }
                }
            }
        },
        "/api/v1/metrics/history": {
            "get": {
                "summary": "Get metrics history",
                "description": "Returns historical metrics data over a time period",
                "tags": ["Metrics"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "period",
                        "schema": {
                            "type": "string",
                            "enum": ["hour", "day", "week"]
                        },
                        "description": "Time period for historical data"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Historical metrics retrieved successfully"
                    }
                }
            }
        },
        "/api/v1/metrics/dashboard": {
            "get": {
                "summary": "Get dashboard metrics",
                "description": "Returns comprehensive metrics for dashboard display",
                "tags": ["Metrics"],
                "responses": {
                    "200": {
                        "description": "Dashboard metrics retrieved successfully"
                    }
                }
            }
        },
        "/api/v1/metrics/export": {
            "get": {
                "summary": "Export metrics",
                "description": "Exports metrics in various formats (JSON, Prometheus)",
                "tags": ["Metrics"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "format",
                        "schema": {
                            "type": "string",
                            "enum": ["json", "prometheus"]
                        },
                        "description": "Export format"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Metrics exported successfully"
                    }
                }
            }
        },
        "/api/admin/profile/photo": {
            "get": {
                "summary": "Get current user's profile photo",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Image file",
                        "content": {
                            "image/png": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            },
                            "image/jpeg": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            },
                            "image/webp": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            }
                        }
                    },
                    "204": {
                        "description": "No avatar set"
                    }
                }
            },
            "post": {
                "summary": "Upload/update current user's profile photo",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "avatar": {
                                        "type": "string",
                                        "format": "binary",
                                        "description": "Image file (PNG/JPEG/WebP, max 2MB)"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Upload successful",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "400": {
                        "description": "Invalid input or unsupported file type"
                    }
                }
            },
            "delete": {
                "summary": "Remove current user's profile photo",
                "tags": ["Admin"],
                "security": [
                    {
                        "sessionAuth": []
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Deleted successfully",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean"
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "500": {
                        "description": "Failed to delete avatar"
                    }
                }
            }
        },
        "/api/sources/{sourceType}/ratings": {
            "get": {
                "summary": "Get available ratings for a source",
                "description": "Returns the list of distinct ratings for the given source type. Disabled sources return an empty list.",
                "tags": ["Filters"],
                "parameters": [
                    {
                        "in": "path",
                        "name": "sourceType",
                        "required": true,
                        "schema": {
                            "type": "string"
                        },
                        "description": "Source type (e.g. jellyfin, plex, tmdb)"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Ratings list"
                    }
                }
            }
        },
        "/api/sources/{sourceType}/ratings-with-counts": {
            "get": {
                "summary": "Get available ratings with counts for a source",
                "description": "Returns ratings along with occurrence counts for the given enabled source type.",
                "tags": ["Filters"]
            }
        },
        "/api/admin/rating-cache/stats": {
            "get": {
                "summary": "Get rating cache statistics",
                "description": "Admin-only. Returns cache hit/miss and size metrics for rating caches.",
                "tags": ["Admin"]
            }
        },
        "/api/admin/rating-cache/{sourceType}/refresh": {
            "post": {
                "summary": "Refresh rating cache for a source",
                "description": "Admin-only. Invalidates and rebuilds the rating cache for the given source type.",
                "tags": ["Admin"]
            }
        },
        "/api/version": {
            "get": {
                "summary": "Get application version",
                "description": "Returns the current version of the Posterrama application",
                "tags": ["Public API"]
            }
        },
        "/api/github/latest": {
            "get": {
                "summary": "Get latest release information (public)",
                "description": "Public endpoint to check for the latest GitHub release.",
                "tags": ["Public API"]
            }
        },
        "/api/config": {
            "get": {
                "summary": "Get public configuration",
                "description": "Public endpoint that returns non-sensitive configuration data.",
                "tags": ["Public API"]
            }
        },
        "/api/qr": {
            "get": {
                "summary": "Generate a QR code",
                "description": "Generates a QR code from a provided text. Returns SVG by default, or PNG if format=png.\n\n**Authentication**: This endpoint allows unauthenticated access for device setup flows (e.g., pairing modal QR codes).\nAdmin users can also access it when authenticated.\n",
                "tags": ["Admin"],
                "parameters": [
                    {
                        "in": "query",
                        "name": "text",
                        "schema": {
                            "type": "string"
                        },
                        "required": true,
                        "description": "Text to encode in the QR code"
                    },
                    {
                        "in": "query",
                        "name": "format",
                        "schema": {
                            "type": "string",
                            "enum": ["svg", "png"],
                            "default": "svg"
                        },
                        "required": false,
                        "description": "Output image format"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "QR code image",
                        "content": {
                            "image/svg+xml": {},
                            "image/png": {}
                        }
                    },
                    "400": {
                        "description": "Missing or invalid text parameter"
                    },
                    "401": {
                        "description": "Unauthorized"
                    },
                    "501": {
                        "description": "QR code generation not available (module missing)"
                    }
                }
            }
        },
        "/api/admin/plex-qualities-with-counts": {
            "get": {
                "summary": "Get Plex qualities with content counts",
                "description": "Retrieves available video qualities from Plex servers with item counts",
                "tags": ["Admin"]
            }
        },
        "/api/admin/jellyfin-qualities-with-counts": {
            "get": {
                "summary": "Get Jellyfin qualities with content counts",
                "description": "Retrieves available video qualities from Jellyfin servers with item counts",
                "tags": ["Admin"]
            }
        }
    }
}
